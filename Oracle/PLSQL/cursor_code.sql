SQL> /

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
02_C_0241                      THERADEX                       T310     BC                                               
C_BC                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(BUN_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(CREATININE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(SODIUM_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(POTASSIUM_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(CHLORIDE_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(MAGNESIUM_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(BICARB_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(URIC_ACID_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(BILIRUBIN_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(ALK_PHOS_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(SGOT_AST_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(SGPT_ALT_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(SGGT_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(LDH_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(TOTAL_PROT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(ALBUMIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(GLOBULIN_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(INORG_PHOS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(GLUC_FAST_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(GLUC_NFAST_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(CHOLEST_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(AMYLASE_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(FIVE_NUCLEO_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR(CREAT_PHOS_FUL, 9, 3)||' '             LINE_TEXT                                             
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.BUN_FUL                                                                                                             
 ,A.CREATININE_FUL                                                                                                      
 ,A.SODIUM_FUL                                                                                                          
 ,A.POTASSIUM_FUL                                                                                                       
 ,A.CHLORIDE_FUL                                                                                                        
 ,A.MAGNESIUM_FUL                                                                                                       
 ,A.BICARB_FUL                                                                                                          
 ,A.URIC_ACID_FUL                                                                                                       
 ,A.BILIRUBIN_FUL                                                                                                       
 ,A.ALK_PHOS_FUL                                                                                                        
 ,A.SGOT_AST_FUL                                                                                                        
 ,A.SGPT_ALT_FUL                                                                                                        
 ,A.SGGT_FUL                                                                                                            
 ,A.LDH_FUL                                                                                                             
 ,A.TOTAL_PROT_FUL                                                                                                      
 ,A.ALBUMIN_FUL                                                                                                         
 ,A.GLOBULIN_FUL                                                                                                        
 ,A.CALCIUM_FUL                                                                                                         
 ,A.INORG_PHOS_FUL                                                                                                      
 ,A.GLUC_FAST_FUL                                                                                                       
 ,A.GLUC_NFAST_FUL                                                                                                      
 ,A.CHOLEST_FUL                                                                                                         
 ,A.AMYLASE_FUL                                                                                                         
 ,A.FIVE_NUCLEO_FUL                                                                                                     
 ,A.CREAT_PHOS_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_BC A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     BC                                               
C_BC_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_BC                                                                                         
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     BC                                               
C_LAB_OTH_BC                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
           EXT_UTIL_PKG.F_TO_CHAR(BUN_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(CREATININE_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(SODIUM_FUL, 9, 3)||' '||                                                              
           EXT_UTIL_PKG.F_TO_CHAR(POTASSIUM_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(CHLORIDE_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(MAGNESIUM_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(BICARB_FUL, 9, 3)||' '||                                                              
           EXT_UTIL_PKG.F_TO_CHAR(URIC_ACID_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(BILIRUBIN_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(ALK_PHOS_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(SGOT_AST_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(SGPT_ALT_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(SGGT_FUL, 9, 3)||' '||                                                                
           EXT_UTIL_PKG.F_TO_CHAR(LDH_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(TOTAL_PROT_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(ALBUMIN_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(GLOBULIN_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(INORG_PHOS_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(GLUC_FAST_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(GLUC_NFAST_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(CHOLEST_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(AMYLASE_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(FIVE_NUCLEO_FUL, 9, 3)||' '||                                                         
           EXT_UTIL_PKG.F_TO_CHAR(CREAT_PHOS_FUL, 9, 3)||' '       LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_BC A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
02_C_0241                      THERADEX                       T310     BC                                               
C_LAB_OTH_BC_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     BM                                               
C_BM                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(MYELOBLAST_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROMYELO_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(MYEL_NEUT_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(MYEL_EOS_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(MYEL_BASOS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(METAMYELO_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(POLY_NEUT_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(POLY_EOS_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(POLY_BASOS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PLASMA_CEL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MONOCYTES_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(RETIC_CELL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MEGAKARYO_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PRONORMO_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(NORMOBLAST_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(M_RATING_FUL, 9, 3)||' '          LINE_TEXT                                                  
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,A.MYELOBLAST_FUL                                                                                                      
 ,A.PROMYELO_FUL                                                                                                        
 ,A.MYEL_NEUT_FUL                                                                                                       
 ,A.MYEL_EOS_FUL                                                                                                        
 ,A.MYEL_BASOS_FUL                                                                                                      
 ,A.METAMYELO_FUL                                                                                                       
 ,A.POLY_NEUT_FUL                                                                                                       
 ,A.POLY_EOS_FUL                                                                                                        
 ,A.POLY_BASOS_FUL                                                                                                      
 ,A.LYMPHOCYTE_FUL                                                                                                      
 ,A.PLASMA_CEL_FUL                                                                                                      
 ,A.MONOCYTES_FUL                                                                                                       
 ,A.RETIC_CELL_FUL                                                                                                      
 ,A.MEGAKARYO_FUL                                                                                                       
 ,A.PRONORMO_FUL                                                                                                        
 ,A.NORMOBLAST_FUL                                                                                                      
 ,A.M_RATING_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_BONEMRW A,                                                                                  
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     BM                                               
C_BM_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_BONEMRW                                                                                    
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     BM                                               
C_LAB_OTH_BM                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
           EXT_UTIL_PKG.F_TO_CHAR(MYELOBLAST_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(PROMYELO_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(MYEL_NEUT_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(MYEL_EOS_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(MYEL_BASOS_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(METAMYELO_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(POLY_NEUT_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(POLY_EOS_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(POLY_BASOS_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(PLASMA_CEL_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(MONOCYTES_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(RETIC_CELL_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(MEGAKARYO_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(PRONORMO_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(NORMOBLAST_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(M_RATING_FUL, 9, 3)||' '      LINE_TEXT                                               
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_BM A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
02_C_0241                      THERADEX                       T310     BM                                               
C_LAB_OTH_BM_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     BS                                               
C_BS                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)      KEY1                                                                    
 ,EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)          KEY2                                                                    
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)||                                                                              
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_CTC_CD_FUL, 10, 0)||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CTC_GRADE_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_VAR(DISEASE_RELAT_IND_FUL, 1)         LINE_TEXT                                                      
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'     COURSE_NUM   ----                                                                                           
 ,A.PATIENT_FUL                                                                                                         
 ,A.ONSET_DT_FUL                                                                                                        
 ,NVL(A.AE_DESCR_FUL, SUBSTR(A.CTC_TERM_FUL, 1, 33))       AE_DESCR_FUL                                                 
 ,A.CDUS_CTC_CD_FUL                                                                                                     
 ,SUBSTR(A.CTC_GRADE_FUL, 1, 1)    CTC_GRADE_FUL                                                                        
 ,A.DISEASE_RELAT_IND_FUL                                                                                               
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_BASE_SYMP A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     BS                                               
C_BS_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,ONSET_DT        KEY1                                                                                                  
 ,AE_DESCR            KEY2                                                                                              
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||ONSET_DT||AE_DESCR     LINE_TEXT                                                                           
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 ONSET_DT, KEY2 AE_DESCR                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                      PATIENT                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)         KEY1                                                            
      ,EXT_UTIL_PKG.F_VAR(NVL(AE_DESCR_FUL, SUBSTR(CTC_TERM_FUL, 1, 33)), 33) KEY2                                      
  FROM PP_EXT_OWNER.CTSC_BASE_SYMP                                                                                      
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     CA                                               
C_CA                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)  KEY1                                                                 
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)||                                                                   
    EXT_UTIL_PKG.F_VAR(RESPS_ASSMNT_FUL, 2)||                                                                           
    EXT_UTIL_PKG.F_FORMAT_DATE(RESPS_ONSET_DT_FUL)||                                                                    
    EXT_UTIL_PKG.F_FORMAT_DATE(PROGRES_ONSET_DT_FUL)||                                                                  
    EXT_UTIL_PKG.F_VAR(COURS_DISP_FUL, 4)||                                                                             
    EXT_UTIL_PKG.F_VAR(TOXICITY_IND_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(RESP_NOTE_FUL, 32)||                                                                             
    EXT_UTIL_PKG.F_TO_CHAR(PREV_DOSE_CHANGE_FUL, 2, 0)             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.COURSE_START_DT_FUL)     COURSE_NUM   ----                   
 ,A.PATIENT_FUL                                                                                                         
 ,A.COURSE_START_DT_FUL                                                                                                 
 ,A.COURS_DISP_FUL                                                                                                      
 ,SUBSTR(A.PREV_DOSE_CHANGE_FUL, 1, 1)   PREV_DOSE_CHANGE_FUL                                                           
 ,A.PROGRES_ONSET_DT_FUL                                                                                                
 ,A.RESPS_ASSMNT_FUL                                                                                                    
 ,A.RESPS_ONSET_DT_FUL                                                                                                  
 ,A.RESP_NOTE_FUL                                                                                                       
 ,A.TOXICITY_IND_FUL                             ---------------                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_COURSE_ASSESS A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     CA                                               
C_CA_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                     PATIENT                                                                                   
 ,COURSE_START_DT      KEY1                                                                                             
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||COURSE_START_DT        LINE_TEXT                                                                           
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 COURSE_START_DT                                                                 
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                     
      ,EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)      KEY1                                                        
  FROM PP_EXT_OWNER.CTSC_COURSE_ASSESS                                                                                  
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     CI                                               
C_CI                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL), 8)   KEY1                                                
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    EXT_UTIL_PKG.F_VAR(COURSE_NUM, 3)||               ------------                                                      
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL), 8)||                                                   
    EXT_UTIL_PKG.F_VAR(ARM_FUL, 4)||                                                                                    
    EXT_UTIL_PKG.F_VAR(CDUS_TX_ASSIG_CD_FUL, 10)||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(WEIGHT_KG_FUL, 6, 2)||                                                                       
    EXT_UTIL_PKG.F_VAR(WEIGHT_UNITS_FUL, 4)||                                                                           
    EXT_UTIL_PKG.F_TO_CHAR(HEIGHT_CM_FUL, 6, 2)||                                                                       
    EXT_UTIL_PKG.F_VAR(HEIGHT_UNITS_FUL, 4)||                                                                           
    EXT_UTIL_PKG.F_TO_CHAR(BSA_FUL, 5, 2)||                                                                             
    EXT_UTIL_PKG.F_VAR(CDUS_TX_INST_FUL, 6)             LINE_TEXT                                                       
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,LPAD(A.COURS_NUM, 3, ' ')         COURSE_NUM    ----                                                                  
 ,A.PATIENT_FUL                                                                                                         
 ,A.START_DT_FUL                                                                                                        
 ,A.ARM_FUL                                                                                                             
 ,A.CDUS_TX_ASSIG_CD_FUL                                                                                                
 ,A.WEIGHT_KG_FUL                                                                                                       
 ,'kg'                     WEIGHT_UNITS_FUL                                                                             
 ,A.HEIGHT_CM_FUL                                                                                                       
 ,'cm'                     HEIGHT_UNITS_FUL                                                                             
 ,A.BSA_FUL                                                                                                             
 ,A.CDUS_TX_INST_FUL                                                                                                    
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM (SELECT E.*, V.HEIGHT_CM_FUL, V.WEIGHT_KG_FUL, V.BSA_FUL                                                          
         FROM PP_EXT_OWNER.CTSC_COURSE_INIT E,                                                                          
              PP_EXT_OWNER.CTSC_VITAL_SIGNS V                                                                           
        WHERE E.STUDY = V.STUDY (+)                                                                                     
          AND E.DOCNUM = V.DOCNUM (+) ) A,                                                                              
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     CI                                               
C_CI_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                     PATIENT                                                                                   
 ,START_DT   KEY1                                                                                                       
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||START_DT         LINE_TEXT                                                                                 
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 START_DT                                                                        
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                              PATIENT                                         
      ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL), 8)   KEY1                                           
  FROM PP_EXT_OWNER.CTSC_COURSE_INIT                                                                                    
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     CM                                               
C_CM                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)         KEY1                                                                 
 ,EXT_UTIL_PKG.F_VAR(PROC_FUL, 24)                 KEY2                                                                 
 ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)           KEY3                                                                 
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(PROC_FUL, 24)||                                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)||                                                                            
    EXT_UTIL_PKG.F_VAR(TOTL_DLY_DS_FUL, 8)||                                                                            
    EXT_UTIL_PKG.F_VAR(DOSE_UOM_FUL, 12)||                                                                              
    EXT_UTIL_PKG.F_VAR(MED_SCHED_FUL, 24)||                                                                             
    EXT_UTIL_PKG.F_VAR(REAS_FUL, 24)||                                                                                  
    EXT_UTIL_PKG.F_FORMAT_DATE(STOP_DT_FUL)        LINE_TEXT                                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.START_DT_FUL)     COURSE_NUM   ----                          
 ,A.PATIENT_FUL                                                                                                         
 ,A.START_DT_FUL                                                                                                        
 ,NVL(TRIM(A.AGT_NM_FUL), A.PROC_FUL) PROC_FUL                                                                          
 ,A.REPEATSN                                                                                                            
 ,A.TOTL_DLY_DS_FUL                                                                                                     

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
 ,A.DOSE_UOM_FUL                                                                                                        
 ,A.MED_SCHED_FUL                                                                                                       
 ,A.REAS_FUL                                                                                                            
 ,A.STOP_DT_FUL                                                                                                         
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_CONCOM_MEDS_MEAS A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     CM                                               
C_CM_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,START_DT             KEY1                                                                                             
 ,PROC                 KEY2                                                                                             
 ,REPEATSN             KEY3                                                                                             
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||START_DT||PROC||REPEATSN       LINE_TEXT                                                                   
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 START_DT, KEY2 PROC, KEY3 REPEATSN                                              
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                     
      ,EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)             KEY1                                                        
      ,EXT_UTIL_PKG.F_VAR(NVL(TRIM(AGT_NM_FUL), PROC_FUL), 24)  KEY2                                                    
      ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)               KEY3                                                        
  FROM PP_EXT_OWNER.CTSC_CONCOM_MEDS_MEAS                                                                               
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     DA                                               
C_DA                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)          KEY1                                                                
 ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)              KEY2                                                                
 ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)             KEY3                                                                
 ,''                                               KEY4                                                                 
 ,''                                               KEY5                                                                 
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)||                                                                          
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)||                                                                              
    EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)||                                                                             
    EXT_UTIL_PKG.F_VAR(LOT_NUM_FUL, 24)||                                                                               
    EXT_UTIL_PKG.F_DA_TO_CHAR(DECODE(E_DOSE_LEVEL_FUL, 0, DOSE_LEVEL_FUL,                                               
      DECODE(X_DOSE_LEVEL_FUL, 0, DOSE_LEVEL_FUL, SUBSTR(DOSE_LEVEL_FUL, 1, X_DOSE_LEVEL_FUL - 1))), 9, 3)||            
    EXT_UTIL_PKG.F_VAR(DECODE(E_DOSE_LEVEL_FUL, 0, NULL,                                                                
      DECODE(X_DOSE_LEVEL_FUL, 0, NULL, SUBSTR(DOSE_LEVEL_FUL, X_DOSE_LEVEL_FUL + 1)))||DOSE_UOM_FUL, 12)||             
    EXT_UTIL_PKG.F_VAR(MED_SCHED_FUL, 24)||                                                                             
    EXT_UTIL_PKG.F_DA_TO_CHAR(DECODE(E_ACTL_DOSE_FUL, 0, ACTL_DOSE_FUL,                                                 
      DECODE(X_ACTL_DOSE_FUL, 0, ACTL_DOSE_FUL, SUBSTR(ACTL_DOSE_FUL, 1, X_ACTL_DOSE_FUL - 1))), 9, 3)||                
    EXT_UTIL_PKG.F_VAR(DECODE(E_ACTL_DOSE_FUL, 0, NULL,                                                                 
      DECODE(X_ACTL_DOSE_FUL, 0, NULL, SUBSTR(ACTL_DOSE_FUL, X_ACTL_DOSE_FUL + 1)))||ACTL_DOSE_UOM_FUL, 12)||           
    EXT_UTIL_PKG.F_VAR(ROUTE_FUL, 8)||                                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(DURATN_FUL, 7, 2)||                                                                          
    EXT_UTIL_PKG.F_VAR(DURATN_UOM_FUL, 2)                LINE_TEXT                                                      
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.START_DT_FUL)     COURSE_NUM   ----                          
 ,A.PATIENT_FUL                                                                                                         
 ,A.START_DT_FUL                                                                                                        
 ,A.TIME_FUL                                                                                                            
 ,A.CTMS_AGENT_FUL                                                                                                      
 ,A.LOT_NUM_FUL                                                                                                         
 ,A.DOSE_LEVEL_FUL                                                                                                      
 ,NVL(INSTR(A.DOSE_LEVEL_FUL, 'E'), 0) E_DOSE_LEVEL_FUL                                                                 
 ,NVL(INSTR(A.DOSE_LEVEL_FUL, 'X'), 0) X_DOSE_LEVEL_FUL                                                                 
 ,A.DOSE_UOM_FUL                                                                                                        
 ,SUBSTR(A.DOSE_UOM_FUL, 1, INSTR(A.DOSE_UOM_FUL, 'X'))   X_DOSE_UOM_FUL                                                
 ,A.MED_SCHED_FUL                                                                                                       
 ,A.ACTL_DOSE_FUL                                                                                                       
 ,NVL(INSTR(A.ACTL_DOSE_FUL, 'E'), 0) E_ACTL_DOSE_FUL                                                                   
 ,NVL(INSTR(A.ACTL_DOSE_FUL, 'X'), 0) X_ACTL_DOSE_FUL                                                                   
 ,A.ACTL_DOSE_UOM_FUL                                                                                                   
 ,SUBSTR(A.ACTL_DOSE_UOM_FUL, 1, INSTR(A.ACTL_DOSE_UOM_FUL, 'X'))   X_ACTL_DOSE_UOM_FUL                                 
 ,A.ROUTE_FUL                                                                                                           
 ,A.DURATN_FUL                                                                                                          
 ,A.DURATN_UOM_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_STUDY_DRUG_ADMIN A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     DA                                               
C_DA_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,START_DT                                 KEY1                                                                         
 ,TIME                                     KEY2                                                                         
 ,CTMS_AGENT                               KEY3                                                                         
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||START_DT||TIME||CTMS_AGENT              LINE_TEXT                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 START_DT, KEY2 TIME, KEY3 CTMS_AGENT                                            
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)       PATIENT                                                                
      ,EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)  KEY1                                                                   
      ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)      KEY2                                                                   
      ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)     KEY3                                                                   
  FROM PP_EXT_OWNER.CTSC_STUDY_DRUG_ADMIN                                                                               
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     DS                                               
C_DS                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,''                                 KEY1                                                                               
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(DEATH_DT_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(DEATH_CAUSE_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(DEATH_OTH_CAUSE_FUL, 24)||                                                                       
    EXT_UTIL_PKG.F_VAR(CTMS_AUTOPSY_IND_FUL, 1)||                                                                       
    EXT_UTIL_PKG.F_VAR(AUTOPSY_DEATH_CAUSE_FUL, 1)||                                                                    
    EXT_UTIL_PKG.F_VAR(ATPSY_OTH_DEATH_CAUS_FUL, 24)||                                                                  
    EXT_UTIL_PKG.F_VAR(SITE1_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE2_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE3_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE4_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE5_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE6_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE7_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE8_FUL, 18)          LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'                                               COURSE_NUM   ----                                                 
 ,A.PATIENT_FUL                                                                                                         
 ,A.DEATH_DT_FUL                                                                                                        
 ,A.DEATH_CAUSE_FUL                                                                                                     
 ,A.DEATH_OTH_CAUSE_FUL                                                                                                 
 ,A.CTMS_AUTOPSY_IND_FUL                                                                                                
 ,A.AUTOPSY_DEATH_CAUSE_FUL                                                                                             
 ,A.ATPSY_OTH_DEATH_CAUS_FUL                                                                                            
 ,A.SITE1_FUL                                                                                                           
 ,A.SITE2_FUL                                                                                                           
 ,A.SITE3_FUL                                                                                                           
 ,A.SITE4_FUL                                                                                                           
 ,A.SITE5_FUL                                                                                                           
 ,A.SITE6_FUL                                                                                                           
 ,A.SITE7_FUL                                                                                                           
 ,A.SITE8_FUL                                                                                                           
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_DEATH_SUMMARY A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     DS                                               
C_DS_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,''                                 KEY1                                                                               
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT       LINE_TEXT                                                                                             
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT                                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12) PATIENT                                                                      
  FROM PP_EXT_OWNER.CTSC_DEATH_SUMMARY                                                                                  
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     DT                                               
C_DT                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT_FUL                                             PATIENT                                                       
 ,EXT_UTIL_PKG.F_VAR(PT_SUBGRP_FUL, 10)       KEY1                                                                      
 ,EXT_UTIL_PKG.F_VAR(TOXICITY_FUL, 33)        KEY2                                                                      
 ,''                                         KEY3                                                                       
 ,''                                         KEY4                                                                       
 ,''                                         KEY5                                                                       
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PT_SUBGRP_FUL, 10)||                                                                             
    EXT_UTIL_PKG.F_VAR(TOXICITY_FUL, 33)||                                                                              
    EXT_UTIL_PKG.F_VAR(CDUS_CTC_CD_FUL, 10)           LINE_TEXT                                                         
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'                   COURSE_NUM   ----                                                                             
 ,' '                                                  PATIENT_FUL                                                      
 ,A.PT_SUBGRP_FUL                                                                                                       
 ,NVL(A.AE_DESCR_FUL, SUBSTR(A.CTC_TERM_FUL, 1, 33)) TOXICITY_FUL                                                       
 ,A.CDUS_CTC_CD_FUL                                                                                                     
 ,A.DOCNUM                                                                                                              
 ,' '                          PT                                                                                       
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_DOS_LIMIT_TOX A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     DT                                               
C_DT_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,PT_SUBGRP                                 KEY1                                                                        
 ,TOXICITY                                  KEY2                                                                        
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PT_SUBGRP||TOXICITY         LINE_TEXT                                                                               
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 PT_SUBGRP, KEY2 TOXICITY                                                        
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, ' ' PT                                                                                            
      ,' '                                     PATIENT                                                                  
      ,EXT_UTIL_PKG.F_VAR(PT_SUBGRP_FUL, 10)    KEY1                                                                    
      ,EXT_UTIL_PKG.F_VAR(NVL(AE_DESCR_FUL, SUBSTR(CTC_TERM_FUL, 1, 33)), 33)  KEY2                                     
  FROM PP_EXT_OWNER.CTSC_DOS_LIMIT_TOX                                                                                  
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     EC                                               
C_EC                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,''                                 KEY1                                                                               
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_VAR(CHECKLIST_NUM_FUL, 2)||                                                                          
    EXT_UTIL_PKG.F_VAR_EC(Q1_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q2_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q3_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q4_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q5_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q6_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q7_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q8_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q9_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q10_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q11_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q12_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q13_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q14_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q15_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q16_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q17_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q18_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q19_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q20_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q21_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q22_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q23_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q24_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q25_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q26_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q27_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q28_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q29_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q30_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q31_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q32_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q33_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q34_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q35_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q36_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q37_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q38_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q39_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q40_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR(PT_ELIG_IND_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(ELIG_WAIVER_REAS_FUL, 64)||                                                                      
    EXT_UTIL_PKG.F_VAR(WAIVER_NUM_FUL, 12)           LINE_TEXT                                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'     COURSE_NUM   ----                                                                                           
 ,A.PATIENT_FUL                                                                                                         
 ,A.CHECKLIST_NUM_FUL                                                                                                   
 ,A.EFFCT_DT_FUL                                                                                                        
 ,A.Q1_FUL                                                                                                              
 ,A.Q2_FUL                                                                                                              
 ,A.Q3_FUL                                                                                                              
 ,A.Q4_FUL                                                                                                              
 ,A.Q5_FUL                                                                                                              
 ,A.Q6_FUL                                                                                                              
 ,A.Q7_FUL                                                                                                              
 ,A.Q8_FUL                                                                                                              
 ,A.Q9_FUL                                                                                                              
 ,A.Q10_FUL                                                                                                             
 ,A.Q11_FUL                                                                                                             
 ,A.Q12_FUL                                                                                                             
 ,A.Q13_FUL                                                                                                             
 ,A.Q14_FUL                                                                                                             
 ,A.Q15_FUL                                                                                                             
 ,A.Q16_FUL                                                                                                             
 ,A.Q17_FUL                                                                                                             
 ,A.Q18_FUL                                                                                                             
 ,A.Q19_FUL                                                                                                             
 ,A.Q20_FUL                                                                                                             
 ,A.Q21_FUL                                                                                                             
 ,A.Q22_FUL                                                                                                             
 ,A.Q23_FUL                                                                                                             
 ,A.Q24_FUL                                                                                                             
 ,A.Q25_FUL                                                                                                             
 ,A.Q26_FUL                                                                                                             
 ,A.Q27_FUL                                                                                                             
 ,A.Q28_FUL                                                                                                             
 ,A.Q29_FUL                                                                                                             
 ,A.Q30_FUL                                                                                                             
 ,A.Q31_FUL                                                                                                             
 ,A.Q32_FUL                                                                                                             
 ,A.Q33_FUL                                                                                                             
 ,A.Q34_FUL                                                                                                             
 ,A.Q35_FUL                                                                                                             
 ,A.Q36_FUL                                                                                                             
 ,A.Q37_FUL                                                                                                             
 ,A.Q38_FUL                                                                                                             
 ,A.Q39_FUL                                                                                                             
 ,A.Q40_FUL                                                                                                             
 ,A.PT_ELIG_IND_FUL                                                                                                     
 ,A.ELIG_WAIVER_REAS_FUL                                                                                                
 ,NVL(A.WAIVER_NUM_FUL, '*') WAIVER_NUM_FUL                                                                             
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_ELIG_CHECK A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     EC                                               
C_EC_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,''                                KEY1                                                                                
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT          LINE_TEXT                                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT                                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                                                                              
  FROM PP_EXT_OWNER.CTSC_ELIG_CHECK                                                                                     
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     EN                                               
C_EN                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,''                             KEY1                                                                                   
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_VAR(PT_GENDER_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_VAR(RACE_CODE_FUL, 20)||                                                                             
    EXT_UTIL_PKG.F_VAR(ETHNIC_CODE_FUL, 2)||                                                                            
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(PT_DOB_FUL), 8)||                                                     
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(REG_DT_FUL), 8)||                                                     
    EXT_UTIL_PKG.F_AGE_TO_CHAR(CTMS_AGE_FUL, 6, 2)||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(VITAL_WEIGHT_KG_FUL, 6, 2)||                                                                 
    EXT_UTIL_PKG.F_VAR(WGT_UNIT_FUL, 4)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(VITAL_HEIGHT_CM_FUL, 6, 2)||                                                                 
    EXT_UTIL_PKG.F_VAR(HT_UNIT_FUL, 4)||                                                                                
    EXT_UTIL_PKG.F_VAR(FILTER_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(VITAL_BSA_FUL, 5, 2)||                                                                       
    EXT_UTIL_PKG.F_VAR(PT_SUBGRP_FUL, 10)||                                                                             
    EXT_UTIL_PKG.F_VAR(REG_GRP_FUL, 6)||                                                                                
    EXT_UTIL_PKG.F_VAR(REG_INST_FUL, 6)||                                                                               
    EXT_UTIL_PKG.F_VAR(PT_ID_FUL, 6)||                                                                                  
    EXT_UTIL_PKG.F_VAR(CNTRY_CD_FUL, 2)||                                                                               
    EXT_UTIL_PKG.F_VAR(PST_CD_FUL, 10)||                                                                                
    EXT_UTIL_PKG.F_VAR(PYMT_MTHD_FUL, 2)||                                                                              
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_DISEAS_CD_FUL, 10, 0)||                                                                 
    EXT_UTIL_PKG.F_VAR(PRIM_SITE_FUL, 20)||                                                                             
    EXT_UTIL_PKG.F_VAR(DISEAS_STG_FUL, 8)||                                                                             
    GRADE_FUL||                                                                                                         
    EXT_UTIL_PKG.F_TO_CHAR(PERF_ZUBROD_FUL, 3, 0)||                                                                     
    EXT_UTIL_PKG.F_VAR(HIST_CYTPATH_FUL, 40)||                                                                          
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(HIST_CONF_DT_FUL), 8)||                                               
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(DIAG_DT_FUL), 8)||                                                    
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(CONS_DT_FUL), 8)||                                                    
    EXT_UTIL_PKG.F_VAR(CONS_VERS_FUL, 12)||                                                                             
    EXT_UTIL_PKG.F_VAR(CDUS_TX_ASSIG_CD_FUL, 10)                                  LINE_TEXT                             
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'                                                COURSE_NUM   ----                                                
 ,A.PATIENT_FUL                                                                                                         
 ,DECODE(A.PT_GENDER_FUL, 'F', 'F', 'M', 'M', NULL)   PT_GENDER_FUL                                                     
 ,A.RACE_CODE_FUL                                                                                                       
 ,A.PT_DOB_FUL       PT_DOB_FUL                                                                                         
 ,A.REG_DT_FUL       REG_DT_FUL                                                                                         
 ,A.CTMS_AGE_FUL                                                                                                        
 ,A.VITAL_WEIGHT_KG_FUL                                                                                                 
 ,'kg'    WGT_UNIT_FUL                                                                                                  
 ,A.VITAL_HEIGHT_CM_FUL                                                                                                 
 ,'cm'    HT_UNIT_FUL                                                                                                   
 ,'0' FILTER_FUL                                                                                                        
 ,A.VITAL_BSA_FUL                                                                                                       
 ,NVL(A.PT_SUBGRP_FUL, 'SUBGROUPA')   PT_SUBGRP_FUL                                                                     
 ,NVL(A.REG_GRP_FUL, '*')    REG_GRP_FUL                                                                                
 ,A.REG_INST_FUL                                                                                                        
 ,A.PT_ID_FUL                                                                                                           
 ,A.ETHNIC_CODE_FUL                                                                                                     
 ,A.CNTRY_CD_FUL                                                                                                        
 ,A.PST_CD_FUL                                                                                                          
 ,NVL(A.PYMT_MTHD_FUL, '98')  PYMT_MTHD_FUL                                                                             
 ,A.CDUS_DISEAS_CD_FUL                                                                                                  
 ,A.CDUS_TX_ASSIG_CD_FUL                                                                                                
 ,A.PRIM_SITE_FUL                                                                                                       
 ,A.DISEAS_STG_FUL                                                                                                      
 ,'    '              GRADE_FUL                                                                                         
 ,DECODE(NVL(INSTR(A.PERF_ZUBROD_FUL, '='), 0), 0, SUBSTR(A.PERF_ZUBROD_FUL, 1, 3),                                     
                         SUBSTR(A.PERF_ZUBROD_FUL, 1, INSTR(A.PERF_ZUBROD_FUL, '=') - 1)) PERF_ZUBROD_FUL               
 ,A.HIST_CYTPATH_FUL                                                                                                    
 ,A.HIST_CONF_DT_FUL                                                                                                    
 ,A.DIAG_DT_FUL                                                                                                         
 ,A.CONS_DT_FUL                                                                                                         
 ,A.CONS_VERS_FUL                                                                                                       
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM (SELECT E.*, V.HEIGHT_CM_FUL VITAL_HEIGHT_CM_FUL, V.WEIGHT_KG_FUL VITAL_WEIGHT_KG_FUL, V.BSA_FUL VITAL_BSA_FUL    
         FROM PP_EXT_OWNER.CTSC_ENROLLMENT E,                                                                           
              PP_EXT_OWNER.CTSC_VITAL_SIGNS V                                                                           
        WHERE E.STUDY = V.STUDY (+)                                                                                     
          AND E.DOCNUM = V.DOCNUM (+) ) A,                                                                              
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     EN                                               
C_EN_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,''                           KEY1                                                                                     
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT        LINE_TEXT                                                                                            
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT                                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                                                                              
  FROM PP_EXT_OWNER.CTSC_ENROLLMENT                                                                                     
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     EX                                               
C_LAB_OTH_EX                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(PANEL, 2, 0)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_1_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_2_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_3_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_4_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_5_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_6_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_7_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_8_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_9_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_10_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_11_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_12_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_13_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_14_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_15_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_16_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_17_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_18_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_19_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_20_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_21_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_22_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_23_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_24_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_25_FUL, 9, 3)||' '     LINE_TEXT                                              
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_EX A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
02_C_0241                      THERADEX                       T310     EX                                               
C_LAB_OTH_EX_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     FO                                               
C_FO                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,''                                 KEY1                                                                               
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(OFF_STDY_DT_FUL)||                                                                       
    EXT_UTIL_PKG.F_FORMAT_DATE(OFF_FOLLOW_DT_FUL)||                                                                     
    EXT_UTIL_PKG.F_VAR(OFF_STDY_REAS_FUL, 1)||                                                                          
    EXT_UTIL_PKG.F_VAR(OFF_STDY_OTH_REAS_FUL, 24)||                                                                     
    EXT_UTIL_PKG.F_VAR(RESPS_ASSMNT_FUL, 2)||                                                                           
    EXT_UTIL_PKG.F_FORMAT_DATE(BEST_RSPNS_ONSET_DT_FUL)||                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(PROG_DT_FUL)         LINE_TEXT                                                           
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'                               COURSE_NUM   ----                                                                 
 ,A.PATIENT_FUL                                                                                                         
 ,A.OFF_STDY_REAS_FUL                                                                                                   
 ,A.OFF_STDY_OTH_REAS_FUL                                                                                               
 ,A.RESPS_ASSMNT_FUL                                                                                                    
 ,A.BEST_RSPNS_ONSET_DT_FUL                                                                                             
 ,A.PROG_DT_FUL                                                                                                         
 ,A.OFF_FOLLOW_DT_FUL                                                                                                   
 ,A.OFF_STDY_DT_FUL                                                                                                     
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     FO                                               
C_FO_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,''                                 KEY1                                                                               
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT         LINE_TEXT                                                                                           
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT                                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)   PATIENT                                                                    
  FROM PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM                                                                                 
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     FP                                               
C_FP                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NVL(DEATH_DT_FUL, LAST_CONTACT_DT_FUL))   KEY1                                             
 ,''                                                                  KEY2                                              
 ,''                                                                  KEY3                                              
 ,''                                                                  KEY4                                              
 ,''                                                                  KEY5                                              
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NVL(DEATH_DT_FUL, LAST_CONTACT_DT_FUL))||                                                
    EXT_UTIL_PKG.F_VAR(PAT_STAT_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_VAR(PT_OTH_STAT_FUL, 24)          LINE_TEXT                                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'       COURSE_NUM   ----                                                                                         
 ,A.PATIENT_FUL                                                                                                         
 ,A.LAST_CONTACT_DT_FUL                                                                                                 
 ,A.DEATH_DT_FUL                                                                                                        
 ,A.PAT_STAT_FUL                                                                                                        
 ,A.PT_OTH_STAT_FUL                                                                                                     
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_FOLLOW_UP A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     FP                                               
C_FP_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,LAST_CONTACT_DT                                 KEY1                                                                  
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LAST_CONTACT_DT          LINE_TEXT                                                                         
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LAST_CONTACT_DT                                                                 
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)   PATIENT                                                                    
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NVL(DEATH_DT_FUL, LAST_CONTACT_DT_FUL))  KEY1                                         
  FROM PP_EXT_OWNER.CTSC_FOLLOW_UP                                                                                      
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     HM                                               
C_HM                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(HEMOGLOBIN_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(HEMATOCRIT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(WBC_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(NEUTROPHIL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(BASOPHILS_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(MONOCYTES_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(EOSINOPHIL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_BANDS(BANDS_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR(BLASTS_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(ATYP_LYMPH_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(OTHER_DIFF_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PLATELETS_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(ANC_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(RBC_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(RETICULO_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(ESR_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(PTIME_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(PTT_FUL, 9, 3)||' '                       LINE_TEXT                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.HEMOGLOBIN_FUL                                                                                                      
 ,A.HEMATOCRIT_FUL                                                                                                      
 ,A.WBC_FUL                                                                                                             
 ,A.NEUTROPHIL_FUL                                                                                                      
 ,A.LYMPHOCYTE_FUL                                                                                                      
 ,A.BASOPHILS_FUL                                                                                                       
 ,A.MONOCYTES_FUL                                                                                                       
 ,A.EOSINOPHIL_FUL                                                                                                      
 ,A.BANDS_FUL                                                                                                           
 ,A.BLASTS_FUL                                                                                                          
 ,A.ATYP_LYMPH_FUL                                                                                                      
 ,A.OTHER_DIFF_FUL                                                                                                      
 ,A.PLATELETS_FUL                                                                                                       
 ,A.ANC_FUL                                                                                                             
 ,A.RBC_FUL                                                                                                             
 ,A.RETICULO_FUL                                                                                                        
 ,A.ESR_FUL                                                                                                             
 ,A.PTIME_FUL                                                                                                           
 ,A.PTT_FUL                                                                                                             
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_HEMA A,                                                                                     
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     HM                                               
C_HM_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_HEMA                                                                                       
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     HM                                               
C_LAB_OTH_HM                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
           EXT_UTIL_PKG.F_TO_CHAR(HEMOGLOBIN_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(HEMATOCRIT_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(WBC_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(NEUTROPHIL_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(BASOPHILS_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(MONOCYTES_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(EOSINOPHIL_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR_BANDS(BANDS_FUL, 9, 3)||' '||                                                         
           EXT_UTIL_PKG.F_TO_CHAR(BLASTS_FUL, 9, 3)||' '||                                                              
           EXT_UTIL_PKG.F_TO_CHAR(ATYP_LYMPH_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(OTHER_DIFF_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(PLATELETS_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(ANC_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(RBC_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(RETICULO_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(ESR_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(PTIME_FUL, 9, 3)||' '||                                                               
           EXT_UTIL_PKG.F_TO_CHAR(PTT_FUL, 9, 3)||' '      LINE_TEXT                                                    
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_HM A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
02_C_0241                      THERADEX                       T310     HM                                               
C_LAB_OTH_HM_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     IE                                               
C_IE                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)             KEY1                                                             
 ,EXT_UTIL_PKG.F_VAR(INFECT_TYP_FUL, 20)               KEY2                                                             
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(INFECT_TYP_FUL, 20)||                                                                            
    EXT_UTIL_PKG.F_VAR(PRIM_SITE_FUL, 20)||                                                                             
    EXT_UTIL_PKG.F_VAR(INFECT_AGNT_FUL, 24)||                                                                           
    EXT_UTIL_PKG.F_VAR(TX_FUL, 24)||                                                                                    
    EXT_UTIL_PKG.F_FORMAT_DATE(RESOLV_DT_FUL)||                                                                         
    EXT_UTIL_PKG.F_VAR(OUTCOME_FUL, 24)          LINE_TEXT                                                              
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.ONSET_DT_FUL)     COURSE_NUM   ----                          
 ,A.PATIENT_FUL                                                                                                         
 ,A.ONSET_DT_FUL                                                                                                        
 ,A.INFECT_TYP_FUL                                                                                                      
 ,A.PRIM_SITE_FUL                                                                                                       
 ,A.INFECT_AGNT_FUL                                                                                                     
 ,A.TX_FUL                                                                                                              
 ,A.RESOLV_DT_FUL                                                                                                       
 ,A.OUTCOME_FUL                                                                                                         
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_INFECTION_EP A,                                                                                 
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     IE                                               
C_IE_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,ONSET_DT                                 KEY1                                                                         
 ,INFECT_TYP                                      KEY2                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||ONSET_DT||INFECT_TYP          LINE_TEXT                                                                    
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 ONSET_DT, KEY2 INFECT_TYP                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)       PATIENT                                                                
      ,EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)  KEY1                                                                   
      ,EXT_UTIL_PKG.F_VAR(INFECT_TYP_FUL, 20)    KEY2                                                                   
  FROM PP_EXT_OWNER.CTSC_INFECTION_EP                                                                                   
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     IP                                               
C_IP                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(B_CELL_LEV_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(T_CELL_TOT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(T_CELL_HLP_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(T_CELL_SUP_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(T_CELL_DTH_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(T_CELL_CTL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(NK_ACTIV_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(ADCC_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(CYTOTOX_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CYTOSTASIS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PEROX_GEN_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(INTERFERON_FUL, 9, 3)||' '          LINE_TEXT                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.LYMPHOCYTE_FUL                                                                                                      
 ,A.B_CELL_LEV_FUL                                                                                                      
 ,A.T_CELL_TOT_FUL                                                                                                      
 ,A.T_CELL_HLP_FUL                                                                                                      
 ,A.T_CELL_SUP_FUL                                                                                                      
 ,A.T_CELL_DTH_FUL                                                                                                      
 ,A.T_CELL_CTL_FUL                                                                                                      
 ,A.NK_ACTIV_FUL                                                                                                        
 ,A.ADCC_FUL                                                                                                            
 ,A.CYTOTOX_FUL                                                                                                         
 ,A.CYTOSTASIS_FUL                                                                                                      
 ,A.PEROX_GEN_FUL                                                                                                       
 ,A.INTERFERON_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_IP A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     IP                                               
C_IP_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_IP                                                                                         
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     IP                                               
C_LAB_OTH_IP                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
           EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(B_CELL_LEV_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(T_CELL_TOT_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(T_CELL_HLP_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(T_CELL_SUP_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(T_CELL_DTH_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(T_CELL_CTL_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(NK_ACTIV_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(ADCC_FUL, 9, 3)||' '||                                                                
           EXT_UTIL_PKG.F_TO_CHAR(CYTOTOX_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(CYTOSTASIS_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(PEROX_GEN_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(INTERFERON_FUL, 9, 3)||' '      LINE_TEXT                                             
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_IP A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
02_C_0241                      THERADEX                       T310     IP                                               
C_LAB_OTH_IP_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     LA                                               
C_LA                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(OFF_STDY_DT_FUL)                KEY1                                                       
 ,EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)                           KEY2                                                   
 ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8) KEY3                                                  
 ,''                                    KEY4                                                                            
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(OFF_STDY_DT_FUL)||                                                                       
    EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)||                                                                              
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8)||                                                   
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_CTC_CD_FUL, 10, 0)||                                                                    
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(RESOLV_DT_FUL), 8)||                                                  
    EXT_UTIL_PKG.F_VAR(AER_IND_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(CTC_GRADE_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_VAR(ATTRIBN_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_VAR(DOSE_LIMT_TOX_IND_FUL, 1)||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(AE_SERIOUS_FUL, 2, 0)||                                                                      
    EXT_UTIL_PKG.F_VAR(AE_ACTION_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_VAR(AE_THRPY_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_VAR(AE_OUTCOME_FUL, 1)      LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.ONSET_DT_FUL)  COURSE_NUM   ----                             
 ,A.PATIENT_FUL                                                                                                         
 ,''                                 COURSE_START_DT_FUL                                                                
 ,NVL(A.AE_DESCR_FUL, SUBSTR(A.CTC_TERM_FUL, 1, 33))   AE_DESCR_FUL                                                     
 ,A.ONSET_DT_FUL                                                                                                        
 ,A.ONSET_DT                                                                                                            
 ,A.OFF_STDY_DT_FUL                                                                                                     
 ,A.CDUS_CTC_CD_FUL                                                                                                     
 ,A.RESOLV_DT_FUL                                                                                                       
 ,A.RESOLV_DT                                                                                                           
 ,A.AER_IND_FUL                                                                                                         
 ,SUBSTR(A.CTC_GRADE_FUL, 1, 1)      CTC_GRADE_FUL                                                                      
 ,A.ATTRIBN_FUL                                                                                                         
 ,A.DOSE_LIMT_TOX_IND_FUL                                                                                               
 ,SUBSTR(A.AE_SER_FUL, 1, 1)   AE_SERIOUS_FUL                                                                           
 ,A.AE_ACTION_FUL                                                                                                       
 ,A.AE_THRPY_FUL                                                                                                        
 ,A.AE_OUTCOME_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM ( SELECT E.*, O.OFF_STDY_DT_FUL                                                                                   
          FROM PP_EXT_OWNER.CTSC_ADVERSE_EVENTS E,                                                                      
               PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM O                                                                       
         WHERE E.STUDY = O.STUDY                                                                                        
           AND E.PT = O.PT                                                                                              
           AND RPAD(E.ONSET_DT, 8, '0') >= RPAD(O.OFF_STDY_DT, 8, '0') ) A,                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     LA                                               
C_LA_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,OFF_STDY_DT                            KEY1                                                                           
 ,TOXICITY                                   KEY2                                                                       
 ,ONSET_DT                                   KEY3                                                                       
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||OFF_STDY_DT||TOXICITY||ONSET_DT            LINE_TEXT                                                       
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 OFF_STDY_DT, KEY2 TOXICITY, KEY3 ONSET_DT                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'LA'                                                                                                   
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                            PATIENT                                           
      ,EXT_UTIL_PKG.F_FORMAT_DATE(OFF_STDY_DT_FUL)                    KEY1                                              
      ,EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)                           KEY2                                              
      ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8) KEY3                                             
  FROM ( SELECT E.*, O.OFF_STDY_DT_FUL                                                                                  
          FROM PP_EXT_OWNER.CTSC_ADVERSE_EVENTS E,                                                                      
               PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM O                                                                       
         WHERE E.STUDY = O.STUDY                                                                                        
           AND E.PT = O.PT                                                                                              
           AND RPAD(E.ONSET_DT, 8, '0') >= RPAD(O.OFF_STDY_DT, 8, '0')                                                  
 ) )  )                                                                                                                 
                                                                                                                        
02_C_0241                      THERADEX                       T310     LL                                               
C_LL                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)           KEY1                                                                 
 ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)         KEY2                                                                     
 ,EXT_UTIL_PKG.F_VAR(TEST_NAME_FUL, 8)             KEY3                                                                 
 ,EXT_UTIL_PKG.F_VAR(BD_SITE_FUL, 8)               KEY4                                                                 
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)||                                                                            
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)||                                                                              
    EXT_UTIL_PKG.F_VAR(TEST_NAME_FUL, 8)||                                                                              
    EXT_UTIL_PKG.F_VAR(BD_SITE_FUL, 8)||                                                                                
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(NORM_ABNORM_IND_FUL, 1)||                                                                        
    EXT_UTIL_PKG.F_VAR(RSLT_FUL, 128)||' '         LINE_TEXT                                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.LAB_DT_FUL)     COURSE_NUM   ----                            
 ,A.PATIENT_FUL                                                                                                         
 ,A.LAB_DT_FUL                                                                                                          
 ,A.TIME_FUL                                                                                                            
 ,'        '             LAB_GROUP                                                                                      
 ,'    '                 LAB_CODE                                                                                       
 ,A.BD_SITE_FUL                                                                                                         
 ,A.NORM_ABNORM_IND_FUL                                                                                                 
 ,A.RSLT_FUL                                                                                                            
 ,A.TEST_NAME_FUL                                                                                                       
 ,A.REG_INST_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_SPEC_LITERAL A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     LL                                               
C_LL_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,LAB_DT                                       KEY1                                                                     
 ,LAB_TIME                                     KEY2                                                                     
 ,TEST_NAME                                    KEY3                                                                     
 ,BD_SITE                                      KEY4                                                                     
 ,''                                           KEY5                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LAB_DT||LAB_TIME||TEST_NAME||BD_SITE        LINE_TEXT                                                      
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LAB_DT, KEY2 LAB_TIME, KEY3 TEST_NAME, KEY4 BD_SITE                             
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)       PATIENT                                                                
      ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)    KEY1                                                                   
      ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)  KEY2                                                                       
      ,EXT_UTIL_PKG.F_VAR(TEST_NAME_FUL, 8)      KEY3                                                                   
      ,EXT_UTIL_PKG.F_VAR(BD_SITE_FUL, 8)        KEY4                                                                   
  FROM PP_EXT_OWNER.CTSC_LAB_SPEC_LITERAL                                                                               
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     LS                                               
C_LS                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0)      KEY1                                                                
 ,''                                            KEY2                                                                    
 ,''                                            KEY3                                                                    
 ,''                                            KEY4                                                                    
 ,''                                            KEY5                                                                    
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0)||                                                                      
    EXT_UTIL_PKG.F_VAR(ORGAN_FUL, 8)||                                                                                  
    EXT_UTIL_PKG.F_VAR(LESION_DESCR_FUL, 32)||                                                                          
    EXT_UTIL_PKG.F_VAR(PREV_IRRAD_IND_FUL, 1)||                                                                         
    EXT_UTIL_PKG.F_VAR(MEASUR_IND_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_VAR(FOLLOW_RESPS_IND_FUL, 1)             LINE_TEXT                                                   
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'              COURSE_NUM   ----                                                                                  
 ,A.PATIENT_FUL                                                                                                         
 ,A.LESION_NUM_FUL                                                                                                      
 ,A.ORGAN_FUL                                                                                                           
 ,A.LESION_DESCR_FUL                                                                                                    
 ,A.PREV_IRRAD_IND_FUL                                                                                                  
 ,A.FOLLOW_RESPS_IND_FUL                                                                                                
 ,A.MEASUR_IND_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LESION_DESCRIPTION A,                                                                           
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     LS                                               
C_LS_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,LESION_NUM                                      KEY1                                                                  
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LESION_NUM          LINE_TEXT                                                                              
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LESION_NUM                                                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0) KEY1                                                                
  FROM PP_EXT_OWNER.CTSC_LESION_DESCRIPTION                                                                             
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     LX                                               
C_LAB_OTH_LX                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(PANEL, 2, 0)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
              EXT_UTIL_PKG.F_VAR(FIELD_1_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_2_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_3_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_4_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_5_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_6_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_7_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_8_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_9_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_10_FUL, 64)||' '     LINE_TEXT                                                   
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_LX A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
02_C_0241                      THERADEX                       T310     LX                                               
C_LAB_OTH_LX_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     MH                                               
C_MH                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL)            KEY1                                                               
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(HEENT_FUL, 128)||                                                                                
    EXT_UTIL_PKG.F_VAR(NECK_FUL, 128)||                                                                                 
    EXT_UTIL_PKG.F_VAR(RESPIRAT_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(CARDIO_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(GASTRO_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(MUSKULOSKEL_FUL, 128)||                                                                          
    EXT_UTIL_PKG.F_VAR(DERMAT_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(HEM_LYM_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(ENDO_MET_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(URINARY_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(GENITAL_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(BREASTS_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(PELVIS_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(ABDOMEN_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(NEUROLOG_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(PHYSCHOL_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(IMMUNE_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(OTHER_FUL, 128)         LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'    COURSE_NUM   ----                                                                                            
 ,A.PATIENT_FUL                                                                                                         
 ,A.EXAM_DT_FUL                                                                                                         
 ,A.HEENT_FUL                                                                                                           
 ,A.NECK_FUL                                                                                                            
 ,A.RESPIRAT_FUL                                                                                                        
 ,A.CARDIO_FUL                                                                                                          
 ,A.GASTRO_FUL                                                                                                          
 ,A.MUSKULOSKEL_FUL                                                                                                     
 ,A.DERMAT_FUL                                                                                                          
 ,A.HEM_LYM_FUL                                                                                                         
 ,A.ENDO_MET_FUL                                                                                                        
 ,A.URINARY_FUL                                                                                                         
 ,A.GENITAL_FUL                                                                                                         
 ,A.BREASTS_FUL                                                                                                         
 ,A.PELVIS_FUL                                                                                                          
 ,A.ABDOMEN_FUL                                                                                                         
 ,A.NEUROLOG_FUL                                                                                                        
 ,A.PHYSCHOL_FUL                                                                                                        
 ,A.IMMUNE_FUL                                                                                                          
 ,A.OTHER_FUL     ---------------                                                                                       
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_BASE_MED_HIST A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     MH                                               
C_MH_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,EXAM_DT                                 KEY1                                                                          
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||EXAM_DT         LINE_TEXT                                                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 EXAM_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)     PATIENT                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL) KEY1                                                                     
  FROM PP_EXT_OWNER.CTSC_BASE_MED_HIST                                                                                  
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     OU                                               
C_LAB_OTH_OU                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CHLORIDE_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(OSMOLALITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(OXALATE_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(POTASSIUM_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALBUM_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALPH1_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALPH2_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_BETA_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PROT_GAMMA_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(SODIUM_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(UREA_NITRO_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(URIC_ACID_FUL, 9, 3)||' '       LINE_TEXT                                                    
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_OU A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
02_C_0241                      THERADEX                       T310     OU                                               
C_LAB_OTH_OU_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     OU                                               
C_OU                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CHLORIDE_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(OSMOLALITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(OXALATE_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(POTASSIUM_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALBUM_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALPH1_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALPH2_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_BETA_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PROT_GAMMA_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(SODIUM_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(UREA_NITRO_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(URIC_ACID_FUL, 9, 3)||' '           LINE_TEXT                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.CALCIUM_FUL                                                                                                         
 ,A.CHLORIDE_FUL                                                                                                        
 ,A.OSMOLALITY_FUL                                                                                                      
 ,A.OXALATE_FUL                                                                                                         
 ,A.POTASSIUM_FUL                                                                                                       
 ,A.PROT_ALBUM_FUL                                                                                                      
 ,A.PROT_ALPH1_FUL                                                                                                      
 ,A.PROT_ALPH2_FUL                                                                                                      
 ,A.PROT_BETA_FUL                                                                                                       
 ,A.PROT_GAMMA_FUL                                                                                                      
 ,A.SODIUM_FUL                                                                                                          
 ,A.UREA_NITRO_FUL                                                                                                      
 ,A.URIC_ACID_FUL                                                                                                       
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OU A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     OU                                               
C_OU_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_OU                                                                                         
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     PE                                               
C_PE                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL)       KEY1                                                                    
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(HEENT_FLAG_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_VAR(HEENT_FUL, 128)||                                                                                
    EXT_UTIL_PKG.F_VAR(NECK_FLAG_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_VAR(NECK_FUL, 128)||                                                                                 
    EXT_UTIL_PKG.F_VAR(RESPIRAT_FLAG_FUL, 1)||                                                                          
    EXT_UTIL_PKG.F_VAR(RESPIRAT_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(CARDIO_FLAG_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(CARDIO_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(GASTRO_FLAG_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(GASTRO_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(MUSKULOSKEL_FLAG_FUL, 1)||                                                                       
    EXT_UTIL_PKG.F_VAR(MUSKULOSKEL_FUL, 128)||                                                                          
    EXT_UTIL_PKG.F_VAR(DERMAT_FLAG_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(DERMAT_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(HEM_LYM_FLAG_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(HEM_LYM_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(ENDO_MET_FLAG_FUL, 1)||                                                                          
    EXT_UTIL_PKG.F_VAR(ENDO_MET_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(URINARY_FLAG_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(URINARY_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(GENITAL_FLAG_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(GENITAL_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(BREASTS_FLAG_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(BREASTS_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(PELVIS_FLAG_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(PELVIS_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(ABDOMEN_FLAG_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(ABDOMEN_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(NEUROLOG_FLAG_FUL, 1)||                                                                          
    EXT_UTIL_PKG.F_VAR(NEUROLOG_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(PHYSCHOL_FLAG_FUL, 1)||                                                                          
    EXT_UTIL_PKG.F_VAR(PHYSCHOL_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(OTHER_FLAG_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_VAR(OTHER_FUL, 128)               LINE_TEXT                                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.EXAM_DT_FUL)     COURSE_NUM   ----                           
 ,A.PATIENT_FUL                                                                                                         
 ,A.EXAM_DT_FUL                                                                                                         
 ,A.HEENT_FLAG_FUL                                                                                                      
 ,A.HEENT_FUL                                                                                                           
 ,A.NECK_FLAG_FUL                                                                                                       
 ,A.NECK_FUL                                                                                                            
 ,A.RESPIRAT_FLAG_FUL                                                                                                   
 ,A.RESPIRAT_FUL                                                                                                        
 ,A.CARDIO_FLAG_FUL                                                                                                     
 ,A.CARDIO_FUL                                                                                                          
 ,A.GASTRO_FLAG_FUL                                                                                                     
 ,A.GASTRO_FUL                                                                                                          
 ,A.MUSKULOSKEL_FLAG_FUL                                                                                                
 ,A.MUSKULOSKEL_FUL                                                                                                     
 ,A.DERMAT_FLAG_FUL                                                                                                     
 ,A.DERMAT_FUL                                                                                                          
 ,A.HEM_LYM_FLAG_FUL                                                                                                    
 ,A.HEM_LYM_FUL                                                                                                         
 ,A.ENDO_MET_FLAG_FUL                                                                                                   
 ,A.ENDO_MET_FUL                                                                                                        
 ,A.URINARY_FLAG_FUL                                                                                                    
 ,A.URINARY_FUL                                                                                                         
 ,A.GENITAL_FLAG_FUL                                                                                                    
 ,A.GENITAL_FUL                                                                                                         
 ,A.BREASTS_FLAG_FUL                                                                                                    
 ,A.BREASTS_FUL                                                                                                         
 ,A.PELVIS_FLAG_FUL                                                                                                     
 ,A.PELVIS_FUL                                                                                                          
 ,A.ABDOMEN_FLAG_FUL                                                                                                    
 ,A.ABDOMEN_FUL                                                                                                         
 ,A.NEUROLOG_FLAG_FUL                                                                                                   
 ,A.NEUROLOG_FUL                                                                                                        
 ,A.PHYSCHOL_FLAG_FUL                                                                                                   
 ,A.PHYSCHOL_FUL                                                                                                        
 ,A.OTHER_FLAG_FUL                                                                                                      
 ,A.OTHER_FUL                                                                                                           
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PHYSICAL_EXAM A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     PE                                               
C_PE_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,EXAM_DT                                 KEY1                                                                          
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||EXAM_DT         LINE_TEXT                                                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 EXAM_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_PHYSICAL_EXAM                                                                                  
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     PH                                               
C_PH_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,EXT_UTIL_PKG.F_VAR(TYP_CD, 3)            KEY3                                                                         
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(TYP_CD, 3)||                                                                                     
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                       LINE_TEXT                                                  
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,DECODE(A.TYP_CD, 'TR', 'PL', A.TYP_CD)  TYP_CD                                                                        
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_COMMENTS_CM A,                                                                                  
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     PH                                               
C_PH_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                            KEY1                                                                               
 ,:P_FILE_ID                          KEY2                                                                              
 ,TYP_CD                             KEY3                                                                               
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT, KEY3 TYP_CD                                                            
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
      ,EXT_UTIL_PKG.F_VAR(DECODE(TYP_CD, 'TR', 'PL', TYP_CD), 3)            KEY3                                        
  FROM PP_EXT_OWNER.CTSC_COMMENTS_CM                                                                                    
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     PK                                               
C_PK                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)                KEY1                                                             
 ,EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)              KEY2                                                             
 ,EXT_UTIL_PKG.F_FORMAT_TIME(START_TIME_FUL)           KEY3                                                             
 ,EXT_UTIL_PKG.F_VAR(SAMPL_SPCMN_FUL, 8)               KEY4                                                             
 ,EXT_UTIL_PKG.F_TO_CHAR(INJECT_DURATN_FUL, 2, 0)      KEY5                                                             
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_FORMAT_TIME(START_TIME_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(SAMPL_SPCMN_FUL, 8)||                                                                            
    EXT_UTIL_PKG.F_TO_CHAR(INJECT_DURATN_FUL, 2, 0)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(PRNT_DRUG_ASSAY_FUL1, 8, 3)||                                                                
    EXT_UTIL_PKG.F_VAR(PRNT_DRUG_ASSAY_UOM_FUL1, 10)||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PRNT_DRUG_ASSAY_FUL2, 8, 3)||                                                                
    EXT_UTIL_PKG.F_VAR(PRNT_DRUG_ASSAY_UOM_FUL2, 10)||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PRNT_DRUG_MEAN_CONC_FUL, 8, 3)||                                                             
    EXT_UTIL_PKG.F_VAR(PRNT_DRG_MN_CONC_UOM_FUL, 10)||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(METABOLITE_ASSAY_FUL1, 8, 3)||                                                               
    EXT_UTIL_PKG.F_VAR(METABOLITE_ASSAY_UOM_FUL1, 10)||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(METABOLITE_ASSAY_FUL2, 8, 3)||                                                               
    EXT_UTIL_PKG.F_VAR(METABOLITE_ASSAY_UOM_FUL2, 10)||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MTBLIT_MEAN_CONC_FUL, 8, 3)||                                                                
    EXT_UTIL_PKG.F_VAR(MTBLIT_MEAN_CONC_UOM_FUL, 10)             LINE_TEXT                                              
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.DOSE_DT_FUL)     COURSE_NUM   ----                           
 ,A.PATIENT_FUL                                                                                                         
 ,A.CTMS_AGENT_FUL                                                                                                      
 ,A.DOSE_DT_FUL                                                                                                         
 ,A.START_TIME_FUL                                                                                                      
 ,A.SAMPL_SPCMN_FUL                                                                                                     
 ,A.INJECT_DURATN_FUL                                                                                                   
 ,A.PRNT_DRUG_ASSAY_FUL1                                                                                                
 ,A.PRNT_DRUG_ASSAY_UOM_FUL1                                                                                            
 ,A.PRNT_DRUG_ASSAY_FUL2                                                                                                
 ,A.PRNT_DRUG_ASSAY_UOM_FUL2                                                                                            
 ,A.PRNT_DRUG_MEAN_CONC_FUL                                                                                             
 ,A.PRNT_DRG_MN_CONC_UOM_FUL                                                                                            
 ,A.METABOLITE_ASSAY_FUL1                                                                                               
 ,A.METABOLITE_ASSAY_UOM_FUL1                                                                                           
 ,A.METABOLITE_ASSAY_FUL2                                                                                               
 ,A.METABOLITE_ASSAY_UOM_FUL2                                                                                           
 ,A.MTBLIT_MEAN_CONC_FUL                                                                                                
 ,A.MTBLIT_MEAN_CONC_UOM_FUL                                                                                            
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PHARMACOKINETICS  A,                                                                            
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     PK                                               
C_PK_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,CTMS_AGENT                                 KEY1                                                                       
 ,DOSE_DT                                          KEY2                                                                 
 ,START_TIME                                       KEY3                                                                 
 ,SAMPL_SPCMN                                       KEY4                                                                
 ,INJECT_DURATN                                     KEY5                                                                
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||CTMS_AGENT||DOSE_DT||START_TIME||SAMPL_SPCMN||INJECT_DURATN        LINE_TEXT                               
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT,                                                                                      
       KEY1 CTMS_AGENT, KEY2 DOSE_DT, KEY3 START_TIME, KEY4 SAMPL_SPCMN, KEY5 INJECT_DURATN                             
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)              PATIENT                                                         
      ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)            KEY1                                                            
      ,EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)          KEY2                                                            
      ,EXT_UTIL_PKG.F_FORMAT_TIME(START_TIME_FUL)       KEY3                                                            
      ,EXT_UTIL_PKG.F_VAR(SAMPL_SPCMN_FUL, 8)           KEY4                                                            
      ,EXT_UTIL_PKG.F_TO_CHAR(INJECT_DURATN_FUL, 5, 0)  KEY5                                                            
  FROM PP_EXT_OWNER.CTSC_PHARMACOKINETICS                                                                               
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     PL                                               
C_PL_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,LAB_DT                                     KEY1                                                                       
 ,TIME                                     KEY2                                                                         
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LAB_DT||TIME         LINE_TEXT                                                                             
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LAB_DT, KEY2 TIME                                                               
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)     PATIENT                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)  KEY1                                                                     
      ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)    KEY2                                                                     
  FROM PP_EXT_OWNER.CTSC_VITAL_SIGNS                                                                                    
 )                                                                                                                      
)                                                                                                                       
                                                                                                                        
02_C_0241                      THERADEX                       T310     PL                                               
C_PL_PLVS                                                                                                               
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)         KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)||                                                                              
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(PERF_ZUBROD_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR(HEIGHT_CM_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(WEIGHT_KG_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(TMP_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(PULSE_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(RESP_RATE_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(SYST_BP_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(DIAST_BP_FUL, 9, 3)||' '            LINE_TEXT                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.LAB_DT)     COURSE_NUM   ----                                
 ,A.PATIENT_FUL                                                                                                         
 ,A.LAB_DT_FUL             SMPL_DT                                                                                      
 ,A.TIME_FUL           SMPL_TM                                                                                          
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.BSA_FUL                                                                                                             
 ,A.HEIGHT_CM_FUL                                                                                                       
 ,A.NOTE_FUL                                                                                                            
 ,DECODE(NVL(INSTR(A.PERF_ZUBROD_FUL, '='), 0), 0, SUBSTR(A.PERF_ZUBROD_FUL, 1, 3),                                     
               SUBSTR(A.PERF_ZUBROD_FUL, 1, INSTR(A.PERF_ZUBROD_FUL, '=') - 1)) PERF_ZUBROD_FUL                         
 ,A.WEIGHT_KG_FUL                                                                                                       
 ,A.DIAST_BP_FUL                                                                                                        
 ,A.PULSE_FUL                                                                                                           
 ,A.RESP_RATE_FUL                                                                                                       
 ,A.SYST_BP_FUL                                                                                                         
 ,A.TMP_FUL                                                                                                             
 ,A.REG_INST_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,A.TIME_FUL                                                                                                            
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_VITAL_SIGNS A,                                                                                  
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     PR                                               
C_PR                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL)         KEY1                                                             
 ,EXT_UTIL_PKG.F_VAR(RADTN_TYPE_FUL, 24)               KEY2                                                             
 ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)               KEY3                                                             
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL)||                                                                      
    EXT_UTIL_PKG.F_VAR(RADTN_TYPE_FUL, 24)||                                                                            
    EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)||                                                                            
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_DOSE_DT_FUL)||                                                                      
    EXT_UTIL_PKG.F_VAR(RT_SITE_FUL, 24)||                                                                               
    EXT_UTIL_PKG.F_VAR(RT_SCHED_FUL, 24)||                                                                              
    EXT_UTIL_PKG.F_VAR(RT_DOSE_FUL, 8)||                                                                                
    EXT_UTIL_PKG.F_VAR(DOSE_UOM_FUL, 8)||                                                                               
    EXT_UTIL_PKG.F_VAR(BEST_RESPS_FUL, 2)||                                                                             
    EXT_UTIL_PKG.F_VAR(THERAPY_TYPE_CODE_FUL, 2)        LINE_TEXT                                                       
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'       COURSE_NUM   ----                                                                                         
 ,A.PATIENT_FUL                                                                                                         
 ,A.FRST_DOSE_DT_FUL                                                                                                    
 ,A.RADTN_TYPE_FUL                                                                                                      
 ,A.REPEATSN                                                                                                            
 ,A.LAST_DOSE_DT_FUL                                                                                                    
 ,NVL(A.RT_SITE_FUL, '*')     RT_SITE_FUL                                                                               
 ,NVL(A.RT_SCHED_FUL, '*')    RT_SCHED_FUL                                                                              
 ,NVL(A.RT_DOSE_FUL, '*')     RT_DOSE_FUL                                                                               
 ,NVL(A.DOSE_UOM_FUL, '*')    DOSE_UOM_FUL                                                                              
 ,NVL(A.BEST_RESPS_FUL, '*')  BEST_RESPS_FUL                                                                            
 ,A.THERAPY_TYPE_CODE_FUL                                                                                               
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_RAD_SUPP A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     PR                                               
C_PR_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,FRST_DOSE_DT                                 KEY1                                                                     
 ,RADTN_TYPE                                         KEY2                                                               
 ,REPEATSN                                            KEY3                                                              
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||FRST_DOSE_DT||RADTN_TYPE||REPEATSN        LINE_TEXT                                                        
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 FRST_DOSE_DT, KEY2 RADTN_TYPE, KEY3 REPEATSN                                    
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)           PATIENT                                                            
      ,EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL)  KEY1                                                               
      ,EXT_UTIL_PKG.F_VAR(RADTN_TYPE_FUL, 24)        KEY2                                                               
      ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)        KEY3                                                               
  FROM PP_EXT_OWNER.CTSC_PRIOR_RAD_SUPP                                                                                 
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     PS                                               
C_PS                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SURG_DT_FUL)                 KEY1                                                          
 ,EXT_UTIL_PKG.F_VAR(PROC_FUL||' - '||ANAT_SITE_FUL, 24)  KEY2                                                          
 ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)                  KEY3                                                          
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SURG_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(PROC_FUL||' - '||ANAT_SITE_FUL, 24)||                                                            
    EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)||                                                                            
    EXT_UTIL_PKG.F_VAR(FIND_FUL, 24)||                                                                                  
    EXT_UTIL_PKG.F_VAR(ESID_DIS_EXTENT_FUL, 24)||                                                                       
    EXT_UTIL_PKG.F_VAR(THERAPEUTIC_IND_FUL, 1)          LINE_TEXT                                                       
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'       COURSE_NUM   ----                                                                                         
 ,A.PATIENT_FUL                                                                                                         
 ,A.SURG_DT_FUL                                                                                                         
 ,A.PROC_FUL                                                                                                            
 ,A.ANAT_SITE_FUL                                                                                                       
 ,A.REPEATSN                                                                                                            
 ,NVL(A.FIND_FUL, '*')             FIND_FUL                                                                             
 ,NVL(A.RESID_DIS_EXTENT_FUL, '*')  ESID_DIS_EXTENT_FUL                                                                 
 ,THERAPEUTIC_IND_FUL                                                                                                   
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_SURG_SUPP A,                                                                              
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     PS                                               
C_PS_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SURG_DT               KEY1                                                                                            
 ,PROC                  KEY2                                                                                            
 ,REPEATSN              KEY3                                                                                            
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SURG_DT|| PROC||REPEATSN          LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SURG_DT, KEY2 PROC, KEY3 REPEATSN                                               
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                     PATIENT                                                  
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SURG_DT_FUL)                 KEY1                                                     
      ,EXT_UTIL_PKG.F_VAR(PROC_FUL||' - '||ANAT_SITE_FUL, 24)  KEY2                                                     
      ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)                  KEY3                                                     
  FROM PP_EXT_OWNER.CTSC_PRIOR_SURG_SUPP                                                                                
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     PT                                               
C_PT                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL)       KEY1                                                               
 ,EXT_UTIL_PKG.F_VAR(AGT_NM_FUL, 24)                 KEY2                                                               
 ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)             KEY3                                                               
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL)||                                                                      
    EXT_UTIL_PKG.F_VAR(AGT_NM_FUL, 24)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)||                                                                            
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_DOSE_DT_FUL)||                                                                      
    EXT_UTIL_PKG.F_VAR(MED_SCHED_FUL, 24)||                                                                             
    EXT_UTIL_PKG.F_VAR(TOT_DOSE_FUL, 8)||                                                                               
    EXT_UTIL_PKG.F_VAR(AGENT_UOM_FUL, 12)||                                                                             
    EXT_UTIL_PKG.F_VAR(BEST_RESPS_FUL, 2)||                                                                             
    EXT_UTIL_PKG.F_VAR(THERAPY_TYPE_CODE_FUL, 2)          LINE_TEXT                                                     
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'              COURSE_NUM   ----                                                                                  
 ,A.PATIENT_FUL                                                                                                         
 ,A.FRST_DOSE_DT_FUL                                                                                                    
 ,A.AGT_NM_FUL                                                                                                          
 ,A.REPEATSN                                                                                                            
 ,A.LAST_DOSE_DT_FUL                                                                                                    
 ,NVL(A.MED_SCHED_FUL, '*')   MED_SCHED_FUL                                                                             
 ,NVL(A.TOT_DOSE_FUL, '*')    TOT_DOSE_FUL                                                                              
 ,NVL(A.AGENT_UOM_FUL, '*')   AGENT_UOM_FUL                                                                             
 ,NVL(A.BEST_RESPS_FUL, '*')  BEST_RESPS_FUL                                                                            
 ,A.THERAPY_TYPE_CODE_FUL                                                                                               
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_THRPY_SUPP A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
END                                                                                                                     
                                                                                                                        
02_C_0241                      THERADEX                       T310     PT                                               
C_PT_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,FRST_DOSE_DT                                 KEY1                                                                     
 ,AGT_NM                                             KEY2                                                               
 ,REPEATSN                                         KEY3                                                                 
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||FRST_DOSE_DT||AGT_NM||REPEATSN      LINE_TEXT                                                              
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 FRST_DOSE_DT, KEY2 AGT_NM, KEY3 REPEATSN                                        
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL) KEY1                                                                
      ,EXT_UTIL_PKG.F_VAR(AGT_NM_FUL, 24)           KEY2                                                                
      ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)       KEY3                                                                
  FROM PP_EXT_OWNER.CTSC_PRIOR_THRPY_SUPP                                                                               
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     RC                                               
C_LAB_OTH_RC                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
           EXT_UTIL_PKG.F_TO_CHAR(MCH_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(MCHC_FUL, 9, 3)||' '||                                                                
           EXT_UTIL_PKG.F_TO_CHAR(MCV_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(BLEED_TIME_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(CLOT_RETR_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(SEMI_QUANT_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(QUANT_FUL, 9, 3)||' '||                                                               
           EXT_UTIL_PKG.F_TO_CHAR(CLOT_TIME_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(FDP_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(FIBRINOGEN_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(THROMB_TIM_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(NUCL_RBCS_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(COMPLEMENT_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(COOMBS_TST_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(ANF_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(TOT_SER_PR_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(ALBUMIN_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(ALPHA1_FUL, 9, 3)||' '||                                                              
           EXT_UTIL_PKG.F_TO_CHAR(ALPHA2_FUL, 9, 3)||' '||                                                              
           EXT_UTIL_PKG.F_TO_CHAR(BETA_FUL, 9, 3)||' '||                                                                
           EXT_UTIL_PKG.F_TO_CHAR(GAMMA_FUL, 9, 3)||' '         LINE_TEXT                                               
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_RC A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
02_C_0241                      THERADEX                       T310     RC                                               
C_LAB_OTH_RC_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     RC                                               
C_RC                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(MCH_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(MCHC_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(MCV_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(BLEED_TIME_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(CLOT_RETR_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(SEMI_QUANT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(QUANT_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(CLOT_TIME_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(FDP_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(FIBRINOGEN_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(THROMB_TIM_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(NUCL_RBCS_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(COMPLEMENT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_POS_NEG(COOMBS_TST_FUL, 9, 3)||' '||                                                         
    EXT_UTIL_PKG.F_TO_CHAR(ANF_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(TOT_SER_PR_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(ALBUMIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(ALPHA1_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(ALPHA2_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BETA_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(GAMMA_FUL, 9, 3)||' '             LINE_TEXT                                                  
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.MCH_FUL                                                                                                             
 ,A.MCHC_FUL                                                                                                            
 ,A.MCV_FUL                                                                                                             
 ,A.BLEED_TIME_FUL                                                                                                      
 ,A.CLOT_RETR_FUL                                                                                                       
 ,A.SEMI_QUANT_FUL                                                                                                      
 ,A.QUANT_FUL                                                                                                           
 ,A.CLOT_TIME_FUL                                                                                                       
 ,A.FDP_FUL                                                                                                             
 ,A.FIBRINOGEN_FUL                                                                                                      
 ,A.THROMB_TIM_FUL                                                                                                      
 ,A.NUCL_RBCS_FUL                                                                                                       
 ,A.COMPLEMENT_FUL                                                                                                      
 ,A.COOMBS_TST_FUL                                                                                                      
 ,A.ANF_FUL                                                                                                             
 ,A.TOT_SER_PR_FUL                                                                                                      
 ,A.ALBUMIN_FUL                                                                                                         
 ,A.ALPHA1_FUL                                                                                                          
 ,A.ALPHA2_FUL                                                                                                          
 ,A.BETA_FUL                                                                                                            
 ,A.GAMMA_FUL                                                                                                           
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_RC A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     RC                                               
C_RC_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_RC                                                                                         
)  )                                                                                                                    
                                                                                                                        

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
02_C_0241                      THERADEX                       T310     RF                                               
C_LAB_OTH_RF                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(ACIDITY_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(PART_CO2_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(PARTIAL_O2_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(BICARB_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BASE_EXC_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(BASE_DEF_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(OXYGEN_SAT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(CARB_MONOX_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(METHEMOGLO_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(VITAL_CAP_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(EXP_VOL_1_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(MAX_CAP_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(RESID_VOL_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(TIDAL_VOL_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(FUN_RES_CP_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PULM_COMPL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(DIFF_CAPAC_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MAX_EXP_FL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MID_EXP_FL_FUL, 9, 3)||' '       LINE_TEXT                                                   
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_RF A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
02_C_0241                      THERADEX                       T310     RF                                               
C_LAB_OTH_RF_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     RF                                               
C_RF                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(ACIDITY_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(PART_CO2_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(PARTIAL_O2_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(BICARB_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BASE_EXC_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(BASE_DEF_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(OXYGEN_SAT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(CARB_MONOX_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(METHEMOGLO_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(VITAL_CAP_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(EXP_VOL_1_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(MAX_CAP_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(RESID_VOL_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(TIDAL_VOL_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(FUN_RES_CP_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PULM_COMPL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(DIFF_CAPAC_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MAX_EXP_FL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MID_EXP_FL_FUL, 9, 3)||' '         LINE_TEXT                                                 
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.ACIDITY_FUL                                                                                                         
 ,A.PART_CO2_FUL                                                                                                        
 ,A.PARTIAL_O2_FUL                                                                                                      
 ,A.BICARB_FUL                                                                                                          
 ,A.BASE_EXC_FUL                                                                                                        
 ,A.BASE_DEF_FUL                                                                                                        
 ,A.OXYGEN_SAT_FUL                                                                                                      
 ,A.CARB_MONOX_FUL                                                                                                      
 ,A.METHEMOGLO_FUL                                                                                                      
 ,A.VITAL_CAP_FUL                                                                                                       
 ,A.EXP_VOL_1_FUL                                                                                                       
 ,A.MAX_CAP_FUL                                                                                                         
 ,A.RESID_VOL_FUL                                                                                                       
 ,A.TIDAL_VOL_FUL                                                                                                       
 ,A.FUN_RES_CP_FUL                                                                                                      
 ,A.PULM_COMPL_FUL                                                                                                      
 ,A.DIFF_CAPAC_FUL                                                                                                      
 ,A.MAX_EXP_FL_FUL                                                                                                      
 ,A.MID_EXP_FL_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_RF A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     RF                                               
C_RF_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_RF                                                                                         
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     SC                                               
C_LAB_OTH_SC                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(ALDOLASE_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(AMMONIA_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(COPPER_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(FERRITIN_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(HDL_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(INSULIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(IRON_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IRON_BIND_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(IRON_SAT_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(LDL_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(LIPASE_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(OSMOLALITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(ACID_PHOS_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(TRANSFERRI_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(TRIGLYC_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(T3_FUL, 9, 3)||' '||                                                                         
    EXT_UTIL_PKG.F_TO_CHAR(T4_FUL, 9, 3)||' '||                                                                         
    EXT_UTIL_PKG.F_TO_CHAR(TSH_FUL, 9, 3)||' '         LINE_TEXT                                                        
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_SC A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
02_C_0241                      THERADEX                       T310     SC                                               
C_LAB_OTH_SC_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     SE                                               
C_LAB_OTH_SE                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(IG_A_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_D_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_E_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_G_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_M_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(MONOCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(POLYCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(KAPPA_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(LAMBDA_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BENCEJONES_FUL, 9, 3)||' '      LINE_TEXT                                                    
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_SE A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
02_C_0241                      THERADEX                       T310     SE                                               
C_LAB_OTH_SE_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     SE                                               
C_SE                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(IG_A_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_D_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_E_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_G_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_M_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(MONOCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(POLYCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(KAPPA_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(LAMBDA_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BENCEJONES_FUL, 9, 3)||' '        LINE_TEXT                                                  
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.IG_A_FUL                                                                                                            
 ,A.IG_D_FUL                                                                                                            
 ,A.IG_E_FUL                                                                                                            
 ,A.IG_G_FUL                                                                                                            
 ,A.IG_M_FUL                                                                                                            
 ,A.MONOCLONAL_FUL                                                                                                      
 ,A.POLYCLONAL_FUL                                                                                                      
 ,A.KAPPA_FUL                                                                                                           
 ,A.LAMBDA_FUL                                                                                                          
 ,A.BENCEJONES_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_SE A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     SE                                               
C_SE_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_SE                                                                                         
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     SH                                               
C_SH                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)       KEY1                                                                
 ,''                                KEY2                                                                                
 ,''                                    KEY3                                                                            
 ,''                                    KEY4                                                                            
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_COLLCT_DT_FUL)||                                                                    
    EXT_UTIL_PKG.F_VAR(NCLD_NM_FUL1 , 8)||                                                                              
    EXT_UTIL_PKG.F_TO_CHAR(ALIQ_CNT_ML_FUL1, 8, 3)||                                                                    
    EXT_UTIL_PKG.F_VAR(AB_NM_FUL1 , 8)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(COR_ALIQ_CPM_FUL1, 9, 0)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(TOT_ADMIN_ML_FUL1, 8, 3)||                                                                   
    EXT_UTIL_PKG.F_VAR(NCLD_NM_FUL2 , 8)||                                                                              
    EXT_UTIL_PKG.F_TO_CHAR(ALIQ_CNT_ML_FUL2, 8, 3)||                                                                    
    EXT_UTIL_PKG.F_VAR(AB_NM_FUL2 , 8)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(COR_ALIQ_CPM_FUL2, 9, 0)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(TOT_ADMIN_ML_FUL2, 8, 3)        LINE_TEXT                                                    
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_COLLCT_DT_FUL)     COURSE_NUM   ----                    
 ,A.PATIENT_FUL                                                                                                         
 ,A.TRIAL_NUM_FUL                                                                                                       
 ,A.SMPL_COLLCT_DT_FUL                                                                                                  
 ,A.NCLD_NM_FUL1                                                                                                        
 ,A.ALIQ_CNT_ML_FUL1                                                                                                    
 ,A.AB_NM_FUL1                                                                                                          
 ,A.COR_ALIQ_CPM_FUL1                                                                                                   
 ,A.TOT_ADMIN_ML_FUL1                                                                                                   
 ,A.NCLD_NM_FUL2                                                                                                        
 ,A.ALIQ_CNT_ML_FUL2                                                                                                    
 ,A.AB_NM_FUL2                                                                                                          
 ,A.COR_ALIQ_CPM_FUL2                                                                                                   
 ,A.TOT_ADMIN_ML_FUL2                                                                                                   
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_SCINTIGRAPHY_HEADER A,                                                                          
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     SH                                               
C_SH_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,TRIAL_NUM                                 KEY1                                                                        
 ,''                                        KEY2                                                                        
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||TRIAL_NUM             LINE_TEXT                                                                            
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 TRIAL_NUM                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)  KEY1                                                                
  FROM PP_EXT_OWNER.CTSC_SCINTIGRAPHY_HEADER                                                                            
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     SR                                               
C_LAB_OTH_SR                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(PSA_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(CA125_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(CEA_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(CA19_9_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(CA15_3_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(CA27_29_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(AFP_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(HCG_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(HIV_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(HBS_AG_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(PREGNANT_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(STOOL_GUAIAC_FUL, 9, 3)||' '     LINE_TEXT                                                   
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_SR A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
02_C_0241                      THERADEX                       T310     SR                                               
C_LAB_OTH_SR_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     SR                                               
C_SR                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(PSA_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(CA125_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(CEA_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(CA19_9_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(CA15_3_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(CA27_29_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(AFP_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(HCG_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR_POS_NEG(HIV_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR_POS_NEG(HBS_AG_FUL, 9, 3)||' '||                                                             
    EXT_UTIL_PKG.F_TO_CHAR_POS_NEG(PREGNANT_FUL, 9, 3)||' '||                                                           
    EXT_UTIL_PKG.F_TO_CHAR_POS_NEG(STOOL_GUAIAC_FUL, 9, 3)||' '        LINE_TEXT                                        
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.PSA_FUL                                                                                                             
 ,A.CA125_FUL                                                                                                           
 ,A.CEA_FUL                                                                                                             
 ,A.CA19_9_FUL                                                                                                          
 ,A.CA15_3_FUL                                                                                                          
 ,A.CA27_29_FUL                                                                                                         
 ,A.AFP_FUL                                                                                                             
 ,A.HCG_FUL                                                                                                             
 ,A.HIV_FUL                                                                                                             
 ,A.HBS_AG_FUL                                                                                                          
 ,A.PREGNANT_FUL                                                                                                        
 ,A.STOOL_GUAIAC_FUL                                                                                                    
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_SR A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     SR                                               
C_SR_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_SR                                                                                         
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     SS                                               
C_SS                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)        KEY1                                                               
 ,EXT_UTIL_PKG.F_TO_CHAR(SMPL_ID_NUM_FUL, 2, 0)      KEY2                                                               
 ,''                                    KEY3                                                                            
 ,''                                    KEY4                                                                            
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(SMPL_ID_NUM_FUL, 2, 0)||                                                                     
    EXT_UTIL_PKG.F_VAR(SRCE_ORG_FUL, 8)||                                                                               
    EXT_UTIL_PKG.F_VAR(SMPL_DESCR_FUL, 18)||                                                                            
    EXT_UTIL_PKG.F_VAR(TIS_CLAS_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_VAR(GAMMA_SCAN_POS_FUL, 1)||                                                                         
    EXT_UTIL_PKG.F_VAR(CT_POS_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SURG_BIOPSY_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_TO_CHAR(SMPL_WT_GRAM_FUL, 8, 3)||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(PCT_TUMOR_FUL, 8, 3)||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(CRCT_CPM_NUCLIDE_FUL1, 9, 0)||                                                               
    EXT_UTIL_PKG.F_TO_CHAR(CRCT_CPM_NUCLIDE_FUL2, 9, 0)          LINE_TEXT                                              
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_COLLCT_DT_FUL)     COURSE_NUM   ----                    
 ,A.PATIENT_FUL                                                                                                         
 ,A.TRIAL_NUM_FUL                                                                                                       
 ,A.SMPL_ID_NUM_FUL                                                                                                     
 ,A.SRCE_ORG_FUL                                                                                                        
 ,A.SMPL_DESCR_FUL                                                                                                      
 ,A.TIS_CLAS_FUL                                                                                                        
 ,A.GAMMA_SCAN_POS_FUL                                                                                                  
 ,A.CT_POS_FUL                                                                                                          
 ,A.SURG_BIOPSY_FUL                                                                                                     
 ,A.SMPL_WT_GRAM_FUL                                                                                                    
 ,A.PCT_TUMOR_FUL                                                                                                       
 ,A.CRCT_CPM_NUCLIDE_FUL1                                                                                               
 ,A.CRCT_CPM_NUCLIDE_FUL2                                                                                               
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_SCINTIGRAPHY A,                                                                                 
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     SS                                               
C_SS_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,TRIAL_NUM                                 KEY1                                                                        
 ,SMPL_ID_NUM                                       KEY2                                                                
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||TRIAL_NUM||SMPL_ID_NUM         LINE_TEXT                                                                   
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 TRIAL_NUM, KEY2 SMPL_ID_NUM                                                     
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)            PATIENT                                                           
      ,EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)    KEY1                                                              
      ,EXT_UTIL_PKG.F_TO_CHAR(SMPL_ID_NUM_FUL, 3, 0)  KEY2                                                              
  FROM PP_EXT_OWNER.CTSC_SCINTIGRAPHY                                                                                   
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     TF                                               
C_TF                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,''                                 KEY1                                                                               
 ,''                                    KEY2                                                                            
 ,''                                    KEY3                                                                            
 ,''                                    KEY4                                                                            
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_VAR(CHEMO_SING_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_CHEM_S_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(CHEMO_MULT_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_CHEM_M_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(CHEMO_UNKN_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_CHEM_U_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(HORMONAL_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_HORM_FUL)||                                                                         
    EXT_UTIL_PKG.F_VAR(SURGERY_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_SURG_FUL)||                                                                         
    EXT_UTIL_PKG.F_VAR(IMMUNOTHER_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_IMM_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(EXTENS_RAD_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_EX_RAD_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(LIM_RAD_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_LM_RAD_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(RAD_UNKN_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_UN_RAD_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(BONE_MARR_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_BMT_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(GENE_THRPY_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_GENE_FUL)||                                                                         
    EXT_UTIL_PKG.F_VAR(OTH_THRPY_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_OTHER_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(NON_CYTO_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_NOCYT_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(ANTI_RTVIR_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_ANTRTV_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(ANTISENSE_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_ANTISNS_FUL)||                                                                       
    EXT_UTIL_PKG.F_VAR(ONCO_VIRO_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_ONCVIR_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(VACCINE_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_VAC_FUL)         LINE_TEXT                                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'                           COURSE_NUM   ----                                                                     
 ,A.PATIENT_FUL                                                                                                         
 ,A.CHEMO_SING_FUL                                                                                                      
 ,A.LST_CHEM_S_FUL                                                                                                      
 ,A.CHEMO_MULT_FUL                                                                                                      
 ,A.LST_CHEM_M_FUL                                                                                                      
 ,A.CHEMO_UNKN_FUL                                                                                                      
 ,A.LST_CHEM_U_FUL                                                                                                      
 ,A.HORMONAL_FUL                                                                                                        
 ,A.LAST_HORM_FUL                                                                                                       
 ,A.SURGERY_FUL                                                                                                         
 ,A.LAST_SURG_FUL                                                                                                       
 ,A.IMMUNOTHER_FUL                                                                                                      
 ,A.LAST_IMM_FUL                                                                                                        
 ,A.EXTENS_RAD_FUL                                                                                                      
 ,A.LST_EX_RAD_FUL                                                                                                      
 ,A.LIM_RAD_FUL                                                                                                         
 ,A.LST_LM_RAD_FUL                                                                                                      
 ,A.RAD_UNKN_FUL                                                                                                        
 ,A.LST_UN_RAD_FUL                                                                                                      
 ,A.BONE_MARR_FUL                                                                                                       
 ,A.LAST_BMT_FUL                                                                                                        
 ,A.GENE_THRPY_FUL                                                                                                      
 ,A.LAST_GENE_FUL                                                                                                       
 ,A.OTH_THRPY_FUL                                                                                                       
 ,A.LAST_OTHER_FUL                                                                                                      
 ,A.NON_CYTO_FUL                                                                                                        
 ,A.LAST_NOCYT_FUL                                                                                                      
 ,A.ANTI_RTVIR_FUL                                                                                                      
 ,A.LST_ANTRTV_FUL                                                                                                      
 ,A.ANTISENSE_FUL                                                                                                       
 ,A.LST_ANTISNS_FUL                                                                                                     
 ,A.ONCO_VIRO_FUL                                                                                                       
 ,A.LST_ONCVIR_FUL                                                                                                      
 ,A.VACCINE_FUL                                                                                                         
 ,A.LAST_VAC_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_TREAT_SUMM A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     TF                                               
C_TF_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,''                                 KEY1                                                                               
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT        LINE_TEXT                                                                                            
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT                                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12) PATIENT                                                                      
  FROM PP_EXT_OWNER.CTSC_PRIOR_TREAT_SUMM                                                                               
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     TX                                               
C_TX                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)                KEY1                                                   
 ,EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)                           KEY2                                                   
 ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8) KEY3                                                  
 ,RESOLV_DT_FUL                                   KEY4                                                                  
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)||                                                                   
    EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)||                                                                              
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8)||                                                   
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_CTC_CD_FUL, 10, 0)||                                                                    
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(RESOLV_DT_FUL), 8)||                                                  
    EXT_UTIL_PKG.F_VAR(AER_IND_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(CTC_GRADE_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_VAR(ATTRIBN_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_VAR(DOSE_LIMT_TOX_IND_FUL, 1)||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(AE_SERIOUS_FUL, 2, 0)||                                                                      
    EXT_UTIL_PKG.F_VAR(AE_ACTION_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_VAR(AE_THRPY_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_VAR(AE_OUTCOME_FUL, 1)      LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'   '                       COURSE_NUM   ----                                                                         
 ,A.PATIENT_FUL                                                                                                         
 ,''                                 COURSE_START_DT_FUL                                                                
 ,NVL(A.AE_DESCR_FUL, SUBSTR(A.CTC_TERM_FUL, 1, 33))   AE_DESCR_FUL                                                     
 ,A.ONSET_DT_FUL                                                                                                        
 ,A.ONSET_DT                                                                                                            
 ,A.CDUS_CTC_CD_FUL                                                                                                     
 ,A.RESOLV_DT_FUL                                                                                                       
 ,A.RESOLV_DT                                                                                                           
 ,A.AER_IND_FUL                                                                                                         
 ,SUBSTR(A.CTC_GRADE_FUL, 1, 1)      CTC_GRADE_FUL                                                                      
 ,A.ATTRIBN_FUL                                                                                                         
 ,A.DOSE_LIMT_TOX_IND_FUL                                                                                               
 ,SUBSTR(A.AE_SER_FUL, 1, 1)   AE_SERIOUS_FUL                                                                           
 ,A.AE_ACTION_FUL                                                                                                       
 ,A.AE_THRPY_FUL                                                                                                        
 ,A.AE_OUTCOME_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM ( SELECT E.*                                                                                                      
          FROM PP_EXT_OWNER.CTSC_ADVERSE_EVENTS E                                                                       
         WHERE NOT EXISTS                                                                                               
                 (SELECT 1                                                                                              
                    FROM PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM O                                                             
                   WHERE E.STUDY = O.STUDY                                                                              
                     AND E.PT = O.PT                                                                                    
                     AND RPAD(E.ONSET_DT, 8, '0') >= RPAD(O.OFF_STDY_DT, 8, '0') ) ) A,                                 
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
ORDER BY PATIENT, AE_DESCR_FUL, COURSE_START_DT_FUL, ONSET_DT_FUL                                                       
                                                                                                                        
02_C_0241                      THERADEX                       T310     TX                                               
C_TX_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,COURSE_START_DT                            KEY1                                                                       
 ,TOXICITY                                   KEY2                                                                       
 ,ONSET_DT                                   KEY3                                                                       
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||COURSE_START_DT||TOXICITY||ONSET_DT            LINE_TEXT                                                   
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 COURSE_START_DT, KEY2 TOXICITY, KEY3 ONSET_DT                                   
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 COURSE_START_DT, KEY2 TOXICITY, KEY3 ONSET_DT                          
  FROM CT_EXT_TEMP                                                                                                      
 WHERE PROTOCOL = :P_STUDY)  )                                                                                          
                                                                                                                        
02_C_0241                      THERADEX                       T310     TX                                               
C_TX_TEMP                                                                                                               
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)                KEY1                                                   
 ,EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)                           KEY2                                                   
 ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8) KEY3                                                  
 ,RESOLV_DT_FUL                                  KEY4                                                                   
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)||                                                                   
    EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)||                                                                              
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8)||                                                   
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_CTC_CD_FUL, 10, 0)||                                                                    
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(RESOLV_DT_FUL), 8)||                                                  
    EXT_UTIL_PKG.F_VAR(AER_IND_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(CTC_GRADE_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_VAR(ATTRIBN_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_VAR(DOSE_LIMT_TOX_IND_FUL, 1)||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(AE_SERIOUS_FUL, 2, 0)||                                                                      
    EXT_UTIL_PKG.F_VAR(AE_ACTION_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_VAR(AE_THRPY_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_VAR(AE_OUTCOME_FUL, 1)      LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'   '                       COURSE_NUM   ----                                                                         
 ,A.PATIENT_FUL                                                                                                         
 ,''                                 COURSE_START_DT_FUL                                                                
 ,NVL(A.AE_DESCR_FUL, SUBSTR(A.CTC_TERM_FUL, 1, 33))   AE_DESCR_FUL                                                     
 ,A.ONSET_DT_FUL                                                                                                        
 ,A.ONSET_DT                                                                                                            
 ,A.CDUS_CTC_CD_FUL                                                                                                     
 ,A.RESOLV_DT_FUL                                                                                                       
 ,A.RESOLV_DT                                                                                                           
 ,A.AER_IND_FUL                                                                                                         
 ,SUBSTR(A.CTC_GRADE_FUL, 1, 1)      CTC_GRADE_FUL                                                                      
 ,A.ATTRIBN_FUL                                                                                                         
 ,A.DOSE_LIMT_TOX_IND_FUL                                                                                               
 ,SUBSTR(A.AE_SER_FUL, 1, 1)   AE_SERIOUS_FUL                                                                           
 ,A.AE_ACTION_FUL                                                                                                       
 ,A.AE_THRPY_FUL                                                                                                        
 ,A.AE_OUTCOME_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM ( SELECT E.*                                                                                                      
          FROM PP_EXT_OWNER.CTSC_ADVERSE_EVENTS E                                                                       
         WHERE NOT EXISTS                                                                                               
                 (SELECT 1                                                                                              
                    FROM PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM O                                                             
                   WHERE E.STUDY = O.STUDY                                                                              
                     AND E.PT = O.PT                                                                                    
                     AND RPAD(E.ONSET_DT, 8, '0') >= RPAD(O.OFF_STDY_DT, 8, '0') ) ) A,                                 
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
ORDER BY PATIENT, AE_DESCR_FUL, COURSE_START_DT_FUL, ONSET_DT_FUL                                                       
                                                                                                                        
02_C_0241                      THERADEX                       T310     UE                                               
C_LAB_OTH_UE                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(IG_A_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_D_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_E_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_G_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_M_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(MONOCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(POLYCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(KAPPA_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(LAMBDA_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BENCEJONES_FUL, 9, 3)||' '       LINE_TEXT                                                   
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_UE A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
02_C_0241                      THERADEX                       T310     UE                                               
C_LAB_OTH_UE_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     UL                                               
C_LAB_OTH_UL                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(DCMDATE)               KEY1                                                                
 ,EXT_UTIL_PKG.F_FORMAT_TIME(DCMTIME)               KEY2                                                                
 ,EXT_UTIL_PKG.F_VAR(LAB_TEST, 8)                   KEY3                                                                
 ,'        '                                       KEY4                                                                 
 ,''                                               KEY5                                                                 
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
           EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                     
           EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                        
           EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                        
           EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                       
           A_FILLER||                                                                                                   
           DEL_FLAG||                                                                                                   
           DEL_DATE||                                                                                                   
           EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                              
           EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                             
           ENTRY_PASS||                                                                                                 
           TOUCH_DATE||                                                                                                 
           TOUCH_TIMER||                                                                                                
           COURSE_NUM||               ------------                                                                      
           EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                        
           EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                        
           EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                        
           EXT_UTIL_PKG.F_VAR(LAB_TEST, 8)||                                                                            
           EXT_UTIL_PKG.F_VAR(BODY_SITE, 8)||                                                                           
           LAB_GROUP||                                                                                                  
           LAB_CODE||                                                                                                   
           EXT_UTIL_PKG.F_VAR_OTH_UL_NA(LAB_RANGE_IND, 1)||                                                             
           EXT_UTIL_PKG.F_OTH_UL_VAL_STR(LVALUE_FUL)||                                                                  
           EXT_UTIL_PKG.F_VAR(SIGNIFICANCE_FLAG_FUL, 1)          LINE_TEXT                                              
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             PROTOCOL                                                          
 ,S.NAME                                       INST_ID                                                                  
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.DCMDATE)     COURSE_NUM   ----                               
 ,A.DCMDATE             SMPL_DT                                                                                         
 ,A.DCMTIME             SMPL_TM                                                                                         
 ,'        '            LAB_GROUP                                                                                       
 ,'    '                LAB_CODE                                                                                        
 ,'        '            BODY_SITE                                                                                       
 ,A.LPARM_FUL           LAB_TEST                                                                                        
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_UL A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY))                                                          
                                                                                                                        
02_C_0241                      THERADEX                       T310     UL                                               
C_LAB_OTH_UL_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                       PATIENT                                                                                 
 ,LAB_DT                        KEY1                                                                                    
 ,LAB_TIME                      KEY2                                                                                    
 ,LAB_TEST                      KEY3                                                                                    
 ,BD_SITE                       KEY4                                                                                    
 ,''                            KEY5                                                                                    
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT)||                                                                                
    EXT_UTIL_PKG.F_FORMAT_TIME(LAB_TIME)||                                                                              
    EXT_UTIL_PKG.F_VAR(LAB_TEST, 8)||                                                                                   
    EXT_UTIL_PKG.F_VAR(BD_SITE, 8)         LINE_TEXT                                                                    
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 LAB_DT, KEY2 LAB_TIME, KEY3 LAB_TEST, KEY4 BD_SITE                     
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 LAB_DT, KEY2 LAB_TIME, KEY3 LAB_TEST, KEY4 BD_SITE            
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     US                                               
C_LAB_OTH_US                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(CREAT_CLR_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(HYDROGEN_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(SP_GRAVITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(WBCS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(RBCS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(GLUCOSE_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(PROTEIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(KETONES_FUL, 9, 3)||' '||                                                              
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(BILE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(URIN_CREAT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(VOLUME_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(COLL_PER_FUL, 9, 3)||' '      LINE_TEXT                                                      
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_US A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
02_C_0241                      THERADEX                       T310     US                                               
C_LAB_OTH_US_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     US                                               
C_US                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(CREAT_CLR_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(HYDROGEN_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(SP_GRAVITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(WBCS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(RBCS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(GLUCOSE_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(PROTEIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(KETONES_FUL, 9, 3)||' '||                                                              
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(BILE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(URIN_CREAT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(VOLUME_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(COLL_PER_FUL, 9, 3)||' '       LINE_TEXT                                                     
FROM (                                                                                                                  

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.CREAT_CLR_FUL                                                                                                       
 ,A.HYDROGEN_FUL                                                                                                        
 ,A.SP_GRAVITY_FUL                                                                                                      
 ,A.WBCS_FUL                                                                                                            
 ,A.RBCS_FUL                                                                                                            
 ,A.GLUCOSE_FUL                                                                                                         
 ,A.PROTEIN_FUL                                                                                                         
 ,A.KETONES_FUL                                                                                                         
 ,A.BILE_FUL                                                                                                            
 ,A.URIN_CREAT_FUL                                                                                                      
 ,A.VOLUME_FUL                                                                                                          
 ,A.COLL_PER_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_US A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     US                                               
C_US_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_US                                                                                         
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     UX                                               
C_UX                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                 PATIENT                                                           
 ,EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)        KEY1                                                                   
 ,EXT_UTIL_PKG.F_FORMAT_TIME(FRST_TIME_FUL)      KEY2                                                                   
 ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)          KEY3                                                                   
 ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)         KEY4                                                                   
 ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL1)          KEY5                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_FORMAT_TIME(FRST_TIME_FUL)||                                                                         
    EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)||                                                                            
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL2)||                                                                             
    EXT_UTIL_PKG.F_TO_CHAR(URINE_VOLUME_ML_FUL ,4, 0)||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(P_VOID_AMT_FUL, 8, 3)||                                                                      
    EXT_UTIL_PKG.F_VAR(P_VOID_AMT_UOM_FUL, 10)||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(P_DRUG_ASSAY_FUL1, 8, 3)||                                                                   
    EXT_UTIL_PKG.F_VAR(P_DRUG_ASSAY_UOM_FUL1, 10)||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(P_DRUG_ASSAY_FUL2, 8, 3)||                                                                   
    EXT_UTIL_PKG.F_VAR(P_DRUG_ASSAY_UOM_FUL2, 10)||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(P_VOID_AMT_FUL, 8, 3)||                                                                      
    EXT_UTIL_PKG.F_VAR(P_VOID_AMT_UOM_FUL, 10)||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(MTBLIT_ASSAY_FUL1, 8, 3)||                                                                   
    EXT_UTIL_PKG.F_VAR(MTBLIT_ASSAY_UOM_FUL1, 10)||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(MTBLIT_ASSAY_FUL2, 8, 3)||                                                                   
    EXT_UTIL_PKG.F_VAR(MTBLIT_ASSAY_UOM_FUL2, 10)||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(MTBLIT_MEAN_CONC_FUL, 8, 3)||                                                                
    EXT_UTIL_PKG.F_VAR(MTBLIT_MEAN_CONC_UOM_FUL, 10)||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(VOID_MTBLIT_AMT_FUL, 8, 3)||                                                                 
    EXT_UTIL_PKG.F_VAR(VOID_MTBLIT_AMT_UOM_FUL, 10)       LINE_TEXT                                                     
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.DOSE_DT_FUL)     COURSE_NUM   ----                           
 ,A.PATIENT_FUL                                                                                                         
 ,A.DOSE_DT_FUL                                                                                                         
 ,A.FRST_TIME_FUL                                                                                                       
 ,A.CTMS_AGENT_FUL                                                                                                      
 ,A.LAB_DT_FUL                                                                                                          
 ,A.START_TIME_FUL                                                                                                      
 ,A.END_TIME_FUL                                                                                                        
 ,A.TIME_FUL1                                                                                                           
 ,A.TIME_FUL2                                                                                                           
 ,A.URINE_VOLUME_ML_FUL                                                                                                 
 ,A.MTBLIT_ASSAY_FUL1                                                                                                   
 ,A.MTBLIT_ASSAY_UOM_FUL1                                                                                               
 ,A.MTBLIT_ASSAY_FUL2                                                                                                   
 ,A.MTBLIT_ASSAY_UOM_FUL2                                                                                               
 ,A.MTBLIT_MEAN_CONC_FUL                                                                                                
 ,A.MTBLIT_MEAN_CONC_UOM_FUL                                                                                            
 ,A.P_VOID_AMT_FUL                                                                                                      
 ,A.P_VOID_AMT_UOM_FUL                                                                                                  
 ,A.P_DRUG_ASSAY_FUL1                                                                                                   
 ,A.P_DRUG_ASSAY_UOM_FUL1                                                                                               
 ,A.P_DRUG_ASSAY_FUL2                                                                                                   
 ,A.P_DRUG_ASSAY_UOM_FUL2                                                                                               
 ,A.VOID_MTBLIT_AMT_FUL                                                                                                 
 ,A.VOID_MTBLIT_AMT_UOM_FUL                                                                                             
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_URINARY_EXCR A,                                                                                 
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
02_C_0241                      THERADEX                       T310     UX                                               
C_UX_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,DOSE_DT                                 KEY1                                                                          
 ,FRST_TIME                                         KEY2                                                                
 ,CTMS_AGENT                                          KEY3                                                              
 ,LAB_DT                                         KEY4                                                                   
 ,TIME1                                          KEY5                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||DOSE_DT||FRST_TIME||CTMS_AGENT||LAB_DT||TIME1          LINE_TEXT                                           
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 DOSE_DT, KEY2 FRST_TIME, KEY3 CTMS_AGENT, KEY4 LAB_DT, KEY5 TIME1               
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)        PATIENT                                                               
      ,EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)    KEY1                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_TIME(FRST_TIME_FUL)  KEY2                                                                  
      ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)      KEY3                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)     KEY4                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL1)      KEY5                                                                  
  FROM PP_EXT_OWNER.CTSC_URINARY_EXCR                                                                                   
)  )                                                                                                                    
                                                                                                                        
02_C_0241                      THERADEX                       T310     XT                                               
C_XT                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0)       KEY1                                                               
 ,EXT_UTIL_PKG.F_FORMAT_DATE(EVAL_DT_FUL)            KEY2                                                               
 ,''                                    KEY3                                                                            
 ,''                                    KEY4                                                                            
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0)||                                                                      
    EXT_UTIL_PKG.F_FORMAT_DATE(EVAL_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(MEASUREMENT_MTHD_FUL, 12)||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(MEASUREMENT_X_FUL, 7, 2)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(MEASUREMENT_Y_FUL, 7, 2)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(MEASUREMENT_Z_FUL, 7, 2)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(EVAL_NUM_FUL, 2, 0)||                                                                        
    EXT_UTIL_PKG.F_VAR(EVAL_CD_FUL, 1)         LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.EVAL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.LESION_NUM_FUL                                                                                                      
 ,A.EVAL_DT_FUL                                                                                                         
 ,A.MEASUREMENT_MTHD_FUL                                                                                                
 ,A.MEASUREMENT_X_FUL                                                                                                   
 ,A.MEASUREMENT_Y_FUL                                                                                                   
 ,A.MEASUREMENT_Z_FUL                                                                                                   
 ,A.EVAL_NUM_FUL                                                                                                        
 ,A.EVAL_CD_FUL                                            ---------------                                              
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_EXT_OF_DISEASE A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
END                                                                                                                     
                                                                                                                        
02_C_0241                      THERADEX                       T310     XT                                               
C_XT_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,LESION_NUM                          KEY1                                                                              
 ,EVAL_DT                             KEY2                                                                              
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LESION_NUM||EVAL_DT       LINE_TEXT                                                                        
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LESION_NUM, KEY2 EVAL_DT                                                        
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)           PATIENT                                                            
      ,EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0)  KEY1                                                               
      ,EXT_UTIL_PKG.F_FORMAT_DATE(EVAL_DT_FUL)       KEY2                                                               
  FROM PP_EXT_OWNER.CTSC_EXT_OF_DISEASE                                                                                 
)  )                                                                                                                    
END                                                                                                                     
                                                                                                                        
ALL                            ALL                            ALL      TX                                               
GC_COURSE_DT_NUM                                                                                                        
  SELECT LPAD(NVL(TO_CHAR(COURS_NUM), ' '), 3, ' ')                                                                     
          ,EXT_UTIL_PKG.F_FORMAT_DATE(START_DT)                                                                         
      FROM PP_EXT_OWNER.CTSC_CINI                                                                                       
     WHERE STUDY = :P_STUDY                                                                                             
       AND PT = :P_PT                                                                                                   
       AND (START_DT = NVL(:P_LAST_COURSE_START_DT, '19000101')                                                         
           OR (START_DT > NVL(:P_LAST_COURSE_START_DT, '19000101')                                                      
                        AND START_DT < NVL(:P_RESOLV_DT, TO_CHAR(SYSDATE, 'RRRRMMDD'))))                                
    ORDER BY 1                                                                                                          
                                                                                                                        
ALL                            ALL                            ALL      TX                                               
GC_LAST_COURSE_START_DT                                                                                                 
    SELECT MAX(START_DT)                                                                                                
      FROM PP_EXT_OWNER.CTSC_CINI                                                                                       
     WHERE STUDY = :P_STUDY                                                                                             
       AND PT = :P_PT                                                                                                   
       AND START_DT <= :P_ONSET_DT                                                                                      
                                                                                                                        
NCI5319                        THERADEX                       T300     BC                                               
C_BC                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(BUN_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(CREATININE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(SODIUM_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(POTASSIUM_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(CHLORIDE_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(MAGNESIUM_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(BICARB_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(URIC_ACID_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(BILIRUBIN_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(ALK_PHOS_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(SGOT_AST_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(SGPT_ALT_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(SGGT_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(LDH_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(TOTAL_PROT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(ALBUMIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(GLOBULIN_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(INORG_PHOS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(GLUC_FAST_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(GLUC_NFAST_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(CHOLEST_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(AMYLASE_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(FIVE_NUCLEO_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR(CREAT_PHOS_FUL, 9, 3)||' '             LINE_TEXT                                             
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.BUN_FUL                                                                                                             
 ,A.CREATININE_FUL                                                                                                      
 ,A.SODIUM_FUL                                                                                                          
 ,A.POTASSIUM_FUL                                                                                                       
 ,A.CHLORIDE_FUL                                                                                                        
 ,A.MAGNESIUM_FUL                                                                                                       
 ,A.BICARB_FUL                                                                                                          
 ,A.URIC_ACID_FUL                                                                                                       
 ,A.BILIRUBIN_FUL                                                                                                       
 ,A.ALK_PHOS_FUL                                                                                                        
 ,A.SGOT_AST_FUL                                                                                                        
 ,A.SGPT_ALT_FUL                                                                                                        
 ,A.SGGT_FUL                                                                                                            
 ,A.LDH_FUL                                                                                                             
 ,A.TOTAL_PROT_FUL                                                                                                      
 ,A.ALBUMIN_FUL                                                                                                         
 ,A.GLOBULIN_FUL                                                                                                        
 ,A.CALCIUM_FUL                                                                                                         
 ,A.INORG_PHOS_FUL                                                                                                      
 ,A.GLUC_FAST_FUL                                                                                                       
 ,A.GLUC_NFAST_FUL                                                                                                      
 ,A.CHOLEST_FUL                                                                                                         
 ,A.AMYLASE_FUL                                                                                                         
 ,A.FIVE_NUCLEO_FUL                                                                                                     
 ,A.CREAT_PHOS_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_BC A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     BC                                               
C_BC_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_BC_CM A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     BC                                               
C_BC_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_LAB_BC_CM                                                                                      
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     BC                                               
C_BC_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_BC                                                                                         
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     BC                                               
C_LAB_OTH_BC                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
           EXT_UTIL_PKG.F_TO_CHAR(BUN_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(CREATININE_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(SODIUM_FUL, 9, 3)||' '||                                                              
           EXT_UTIL_PKG.F_TO_CHAR(POTASSIUM_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(CHLORIDE_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(MAGNESIUM_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(BICARB_FUL, 9, 3)||' '||                                                              
           EXT_UTIL_PKG.F_TO_CHAR(URIC_ACID_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(BILIRUBIN_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(ALK_PHOS_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(SGOT_AST_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(SGPT_ALT_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(SGGT_FUL, 9, 3)||' '||                                                                
           EXT_UTIL_PKG.F_TO_CHAR(LDH_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(TOTAL_PROT_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(ALBUMIN_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(GLOBULIN_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(INORG_PHOS_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(GLUC_FAST_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(GLUC_NFAST_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(CHOLEST_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(AMYLASE_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(FIVE_NUCLEO_FUL, 9, 3)||' '||                                                         
           EXT_UTIL_PKG.F_TO_CHAR(CREAT_PHOS_FUL, 9, 3)||' '       LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_BC A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
NCI5319                        THERADEX                       T300     BC                                               
C_LAB_OTH_BC_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     BM                                               
C_BM                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(MYELOBLAST_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROMYELO_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(MYEL_NEUT_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(MYEL_EOS_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(MYEL_BASOS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(METAMYELO_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(POLY_NEUT_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(POLY_EOS_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(POLY_BASOS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PLASMA_CEL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MONOCYTES_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(RETIC_CELL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MEGAKARYO_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PRONORMO_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(NORMOBLAST_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(M_RATING_FUL, 9, 3)||' '          LINE_TEXT                                                  
 FROM (                                                                                                                 
 select                                                                                                                 
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,A.MYELOBLAST_FUL                                                                                                      
 ,A.PROMYELO_FUL                                                                                                        
 ,A.MYEL_NEUT_FUL                                                                                                       
 ,A.MYEL_EOS_FUL                                                                                                        
 ,A.MYEL_BASOS_FUL                                                                                                      
 ,A.METAMYELO_FUL                                                                                                       
 ,A.POLY_NEUT_FUL                                                                                                       
 ,A.POLY_EOS_FUL                                                                                                        
 ,A.POLY_BASOS_FUL                                                                                                      
 ,A.LYMPHOCYTE_FUL                                                                                                      
 ,A.PLASMA_CEL_FUL                                                                                                      
 ,A.MONOCYTES_FUL                                                                                                       
 ,A.RETIC_CELL_FUL                                                                                                      
 ,A.MEGAKARYO_FUL                                                                                                       
 ,A.PRONORMO_FUL                                                                                                        
 ,A.NORMOBLAST_FUL                                                                                                      
 ,A.M_RATING_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_BONEMRW A,                                                                                  
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     BM                                               
C_BM_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_BONEMRW_CM A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     BM                                               
C_BM_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_LAB_BONEMRW_CM                                                                                 
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     BM                                               
C_BM_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_BONEMRW                                                                                    
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     BM                                               
C_LAB_OTH_BM                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
           EXT_UTIL_PKG.F_TO_CHAR(MYELOBLAST_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(PROMYELO_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(MYEL_NEUT_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(MYEL_EOS_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(MYEL_BASOS_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(METAMYELO_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(POLY_NEUT_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(POLY_EOS_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(POLY_BASOS_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(PLASMA_CEL_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(MONOCYTES_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(RETIC_CELL_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(MEGAKARYO_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(PRONORMO_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(NORMOBLAST_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(M_RATING_FUL, 9, 3)||' '      LINE_TEXT                                               
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_BM A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
NCI5319                        THERADEX                       T300     BM                                               
C_LAB_OTH_BM_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     BS                                               
C_BS                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)      KEY1                                                                    
 ,EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)          KEY2                                                                    
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)||                                                                              
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_CTC_CD_FUL, 10, 0)||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CTC_GRADE_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_VAR(DISEASE_RELAT_IND_FUL, 1)         LINE_TEXT                                                      
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'     COURSE_NUM   ----                                                                                           
 ,A.PATIENT_FUL                                                                                                         
 ,A.ONSET_DT_FUL                                                                                                        
 ,NVL(A.AE_DESCR_FUL, SUBSTR(A.CTC_TERM_FUL, 1, 33))       AE_DESCR_FUL                                                 
 ,A.CDUS_CTC_CD_FUL                                                                                                     
 ,SUBSTR(A.CTC_GRADE_FUL, 1, 1)    CTC_GRADE_FUL                                                                        
 ,A.DISEASE_RELAT_IND_FUL                                                                                               
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_BASE_SYMP A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     BS                                               
C_BS_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_BASE_SYMP_CM A,                                                                                 
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     BS                                               
C_BS_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_BASE_SYMP_CM                                                                                   
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     BS                                               
C_BS_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,ONSET_DT        KEY1                                                                                                  
 ,AE_DESCR            KEY2                                                                                              
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||ONSET_DT||AE_DESCR     LINE_TEXT                                                                           
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 ONSET_DT, KEY2 AE_DESCR                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                      PATIENT                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)         KEY1                                                            
      ,EXT_UTIL_PKG.F_VAR(NVL(AE_DESCR_FUL, SUBSTR(CTC_TERM_FUL, 1, 33)), 33) KEY2                                      
  FROM PP_EXT_OWNER.CTSC_BASE_SYMP                                                                                      
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     CA                                               
C_CA                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)  KEY1                                                                 
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)||                                                                   
    EXT_UTIL_PKG.F_VAR(RESPS_ASSMNT_FUL, 2)||                                                                           
    EXT_UTIL_PKG.F_FORMAT_DATE(RESPS_ONSET_DT_FUL)||                                                                    
    EXT_UTIL_PKG.F_FORMAT_DATE(PROGRES_ONSET_DT_FUL)||                                                                  
    EXT_UTIL_PKG.F_VAR(COURS_DISP_FUL, 4)||                                                                             
    EXT_UTIL_PKG.F_VAR(TOXICITY_IND_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(RESP_NOTE_FUL, 32)||                                                                             
    EXT_UTIL_PKG.F_TO_CHAR(PREV_DOSE_CHANGE_FUL, 2, 0)             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.COURSE_START_DT_FUL)     COURSE_NUM   ----                   
 ,A.PATIENT_FUL                                                                                                         
 ,A.COURSE_START_DT_FUL                                                                                                 
 ,A.COURS_DISP_FUL                                                                                                      
 ,SUBSTR(A.PREV_DOSE_CHANGE_FUL, 1, 1)   PREV_DOSE_CHANGE_FUL                                                           
 ,A.PROGRES_ONSET_DT_FUL                                                                                                
 ,A.RESPS_ASSMNT_FUL                                                                                                    
 ,A.RESPS_ONSET_DT_FUL                                                                                                  
 ,A.RESP_NOTE_FUL                                                                                                       
 ,A.TOXICITY_IND_FUL                             ---------------                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_COURSE_ASSESS A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     CA                                               
C_CA_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_COURSE_ASSESS_CM A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     CA                                               
C_CA_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_COURSE_ASSESS_CM                                                                               
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     CA                                               
C_CA_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                     PATIENT                                                                                   
 ,COURSE_START_DT      KEY1                                                                                             
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||COURSE_START_DT        LINE_TEXT                                                                           
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 COURSE_START_DT                                                                 
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                     
      ,EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)      KEY1                                                        
  FROM PP_EXT_OWNER.CTSC_COURSE_ASSESS                                                                                  
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     CI                                               
C_CI                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL), 8)   KEY1                                                
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    EXT_UTIL_PKG.F_VAR(COURSE_NUM, 3)||               ------------                                                      
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL), 8)||                                                   
    EXT_UTIL_PKG.F_VAR(ARM_FUL, 4)||                                                                                    
    EXT_UTIL_PKG.F_VAR(CDUS_TX_ASSIG_CD_FUL, 10)||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(WEIGHT_KG_FUL, 6, 2)||                                                                       
    EXT_UTIL_PKG.F_VAR(WEIGHT_UNITS_FUL, 4)||                                                                           
    EXT_UTIL_PKG.F_TO_CHAR(HEIGHT_CM_FUL, 6, 2)||                                                                       
    EXT_UTIL_PKG.F_VAR(HEIGHT_UNITS_FUL, 4)||                                                                           
    EXT_UTIL_PKG.F_TO_CHAR(BSA_FUL, 5, 2)||                                                                             
    EXT_UTIL_PKG.F_VAR(CDUS_TX_INST_FUL, 6)             LINE_TEXT                                                       
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,LPAD(A.COURS_NUM, 3, ' ')         COURSE_NUM    ----                                                                  
 ,A.PATIENT_FUL                                                                                                         
 ,A.START_DT_FUL                                                                                                        
 ,A.ARM_FUL                                                                                                             
 ,A.CDUS_TX_ASSIG_CD_FUL                                                                                                
 ,A.WEIGHT_KG_FUL                                                                                                       
 ,'kg'                     WEIGHT_UNITS_FUL                                                                             
 ,A.HEIGHT_CM_FUL                                                                                                       
 ,'cm'                     HEIGHT_UNITS_FUL                                                                             
 ,A.BSA_FUL                                                                                                             
 ,A.CDUS_TX_INST_FUL                                                                                                    
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_COURSE_INIT A,                                                                                  
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     CI                                               
C_CI_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_COURSE_INIT_CM A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     CI                                               
C_CI_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                                  KEY2                                                                      
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_COURSE_INIT_CM                                                                                 
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     CI                                               
C_CI_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                     PATIENT                                                                                   
 ,START_DT   KEY1                                                                                                       
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||START_DT         LINE_TEXT                                                                                 
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 START_DT                                                                        
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                              PATIENT                                         
      ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL), 8)   KEY1                                           
  FROM PP_EXT_OWNER.CTSC_COURSE_INIT                                                                                    
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     CM                                               
C_CM                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)         KEY1                                                                 
 ,EXT_UTIL_PKG.F_VAR(PROC_FUL, 24)                 KEY2                                                                 
 ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)           KEY3                                                                 
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(PROC_FUL, 24)||                                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)||                                                                            
    EXT_UTIL_PKG.F_VAR(TOTL_DLY_DS_FUL, 8)||                                                                            
    EXT_UTIL_PKG.F_VAR(DOSE_UOM_FUL, 8)||                                                                               
    EXT_UTIL_PKG.F_VAR(MED_SCHED_FUL, 24)||                                                                             
    EXT_UTIL_PKG.F_VAR(REAS_FUL, 24)||                                                                                  
    EXT_UTIL_PKG.F_FORMAT_DATE(STOP_DT_FUL)        LINE_TEXT                                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.START_DT_FUL)     COURSE_NUM   ----                          
 ,A.PATIENT_FUL                                                                                                         
 ,A.START_DT_FUL                                                                                                        
 ,NVL(TRIM(A.AGT_NM_FUL), A.PROC_FUL) PROC_FUL                                                                          
 ,A.REPEATSN                                                                                                            
 ,A.TOTL_DLY_DS_FUL                                                                                                     
 ,A.DOSE_UOM_FUL                                                                                                        
 ,A.MED_SCHED_FUL                                                                                                       
 ,A.REAS_FUL                                                                                                            
 ,A.STOP_DT_FUL                                                                                                         
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_CONCOM_MEDS_MEAS A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     CM                                               
C_CM_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_CONCOM_MEDS_MEAS_CM A,                                                                          
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     CM                                               
C_CM_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_CONCOM_MEDS_MEAS_CM                                                                            
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     CM                                               
C_CM_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,START_DT             KEY1                                                                                             
 ,PROC                 KEY2                                                                                             
 ,REPEATSN             KEY3                                                                                             
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||START_DT||PROC||REPEATSN       LINE_TEXT                                                                   
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 START_DT, KEY2 PROC, KEY3 REPEATSN                                              
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                     
      ,EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)             KEY1                                                        
      ,EXT_UTIL_PKG.F_VAR(NVL(TRIM(AGT_NM_FUL), PROC_FUL), 24)  KEY2                                                    
      ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)               KEY3                                                        
  FROM PP_EXT_OWNER.CTSC_CONCOM_MEDS_MEAS                                                                               
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     DA                                               
C_DA                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)          KEY1                                                                
 ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)              KEY2                                                                
 ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)             KEY3                                                                
 ,''                                               KEY4                                                                 
 ,''                                               KEY5                                                                 
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)||                                                                          
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)||                                                                              
    EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)||                                                                             
    EXT_UTIL_PKG.F_VAR(LOT_NUM_FUL, 24)||                                                                               
    EXT_UTIL_PKG.F_DA_TO_CHAR(DECODE(E_TOT_DOSE_FUL, 0, TOT_DOSE_FUL,                                                   
                             DECODE(X_TOT_DOSE_FUL, 0, TOT_DOSE_FUL, SUBSTR(TOT_DOSE_FUL, 1, X_TOT_DOSE_FUL - 1))), 9, 3
)||                                                                                                                     
    EXT_UTIL_PKG.F_VAR(DECODE(E_TOT_DOSE_FUL, 0, NULL,                                                                  
              DECODE(X_TOT_DOSE_FUL, 0, NULL, SUBSTR(TOT_DOSE_FUL, X_TOT_DOSE_FUL + 1)))||AGENT_UOM_FUL, 10)||          
    EXT_UTIL_PKG.F_VAR(MED_SCHED_FUL, 24)||                                                                             
    EXT_UTIL_PKG.F_DA_TO_CHAR(DECODE(E_ACTL_DOSE_FUL, 0, ACTL_DOSE_FUL,                                                 
                             DECODE(X_ACTL_DOSE_FUL, 0, ACTL_DOSE_FUL, SUBSTR(ACTL_DOSE_FUL, 1, X_ACTL_DOSE_FUL - 1))), 
9, 3)||                                                                                                                 
    EXT_UTIL_PKG.F_VAR(DECODE(E_ACTL_DOSE_FUL, 0, NULL,                                                                 
              DECODE(X_ACTL_DOSE_FUL, 0, NULL, SUBSTR(ACTL_DOSE_FUL, X_ACTL_DOSE_FUL + 1)))||ACTL_DOSE_UOM_FUL, 10)||   
    EXT_UTIL_PKG.F_VAR(ROUTE_FUL, 8)||                                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(DURATN_FUL, 7, 2)||                                                                          
    EXT_UTIL_PKG.F_VAR(DURATN_UOM_FUL, 2)                LINE_TEXT                                                      
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.START_DT_FUL)     COURSE_NUM   ----                          
 ,A.PATIENT_FUL                                                                                                         
 ,A.START_DT_FUL                                                                                                        
 ,A.TIME_FUL                                                                                                            
 ,A.CTMS_AGENT_FUL                                                                                                      
 ,A.LOT_NUM_FUL                                                                                                         
 ,A.TOT_DOSE_FUL                                                                                                        
 ,NVL(INSTR(A.TOT_DOSE_FUL, 'E'), 0) E_TOT_DOSE_FUL                                                                     
 ,NVL(INSTR(A.TOT_DOSE_FUL, 'X'), 0) X_TOT_DOSE_FUL                                                                     
 ,A.AGENT_UOM_FUL                                                                                                       
 ,SUBSTR(A.AGENT_UOM_FUL, 1, INSTR(A.AGENT_UOM_FUL, 'X'))   X_AGENT_UOM_FUL                                             
 ,A.MED_SCHED_FUL                                                                                                       
 ,A.ACTL_DOSE_FUL                                                                                                       
 ,NVL(INSTR(A.ACTL_DOSE_FUL, 'E'), 0) E_ACTL_DOSE_FUL                                                                   
 ,NVL(INSTR(A.ACTL_DOSE_FUL, 'X'), 0) X_ACTL_DOSE_FUL                                                                   
 ,A.ACTL_DOSE_UOM_FUL                                                                                                   
 ,SUBSTR(A.ACTL_DOSE_UOM_FUL, 1, INSTR(A.ACTL_DOSE_UOM_FUL, 'X'))   X_ACTL_DOSE_UOM_FUL                                 
 ,A.ROUTE_FUL                                                                                                           
 ,A.DURATN_FUL                                                                                                          
 ,A.DURATN_UOM_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_STUDY_DRUG_ADMIN A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     DA                                               
C_DA_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_STUDY_DRUG_ADMIN_CM A,                                                                          
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     DA                                               
C_DA_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_STUDY_DRUG_ADMIN_CM                                                                            
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     DA                                               
C_DA_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,START_DT                                 KEY1                                                                         
 ,TIME                                     KEY2                                                                         
 ,CTMS_AGENT                               KEY3                                                                         
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||START_DT||TIME||CTMS_AGENT              LINE_TEXT                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 START_DT, KEY2 TIME, KEY3 CTMS_AGENT                                            
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)       PATIENT                                                                
      ,EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)  KEY1                                                                   
      ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)      KEY2                                                                   
      ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)     KEY3                                                                   
  FROM PP_EXT_OWNER.CTSC_STUDY_DRUG_ADMIN                                                                               
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     DS                                               
C_DS                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,''                                 KEY1                                                                               
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(DEATH_DT_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(DEATH_CAUSE_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(DEATH_OTH_CAUSE_FUL, 24)||                                                                       
    EXT_UTIL_PKG.F_VAR(CTMS_AUTOPSY_IND_FUL, 1)||                                                                       
    EXT_UTIL_PKG.F_VAR(AUTOPSY_DEATH_CAUSE_FUL, 1)||                                                                    
    EXT_UTIL_PKG.F_VAR(ATPSY_OTH_DEATH_CAUS_FUL, 24)||                                                                  
    EXT_UTIL_PKG.F_VAR(SITE1_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE2_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE3_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE4_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE5_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE6_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE7_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE8_FUL, 18)          LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'                                               COURSE_NUM   ----                                                 
 ,A.PATIENT_FUL                                                                                                         
 ,A.DEATH_DT_FUL                                                                                                        
 ,A.DEATH_CAUSE_FUL                                                                                                     
 ,A.DEATH_OTH_CAUSE_FUL                                                                                                 
 ,A.CTMS_AUTOPSY_IND_FUL                                                                                                
 ,A.AUTOPSY_DEATH_CAUSE_FUL                                                                                             
 ,A.ATPSY_OTH_DEATH_CAUS_FUL                                                                                            
 ,A.SITE1_FUL                                                                                                           
 ,A.SITE2_FUL                                                                                                           
 ,A.SITE3_FUL                                                                                                           
 ,A.SITE4_FUL                                                                                                           
 ,A.SITE5_FUL                                                                                                           
 ,A.SITE6_FUL                                                                                                           
 ,A.SITE7_FUL                                                                                                           
 ,A.SITE8_FUL                                                                                                           
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_DEATH_SUMMARY A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     DS                                               
C_DS_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,''                                 KEY1                                                                               
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT       LINE_TEXT                                                                                             
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT                                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12) PATIENT                                                                      
  FROM PP_EXT_OWNER.CTSC_DEATH_SUMMARY                                                                                  
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     DT                                               
C_DT                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT_FUL                                             PATIENT                                                       
 ,EXT_UTIL_PKG.F_VAR(PT_SUBGRP_FUL, 10)       KEY1                                                                      
 ,EXT_UTIL_PKG.F_VAR(TOXICITY_FUL, 33)        KEY2                                                                      
 ,''                                         KEY3                                                                       
 ,''                                         KEY4                                                                       
 ,''                                         KEY5                                                                       
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PT_SUBGRP_FUL, 10)||                                                                             
    EXT_UTIL_PKG.F_VAR(TOXICITY_FUL, 33)||                                                                              
    EXT_UTIL_PKG.F_VAR(CDUS_CTC_CD_FUL, 10)           LINE_TEXT                                                         
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'                   COURSE_NUM   ----                                                                             
 ,' '                                                  PATIENT_FUL                                                      
 ,A.PT_SUBGRP_FUL                                                                                                       
 ,NVL(A.AE_DESCR_FUL, SUBSTR(A.CTC_TERM_FUL, 1, 33)) TOXICITY_FUL                                                       
 ,A.CDUS_CTC_CD_FUL                                                                                                     
 ,A.DOCNUM                                                                                                              
 ,' '                          PT                                                                                       
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_DOS_LIMIT_TOX A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     DT                                               
C_DT_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,PT_SUBGRP                                 KEY1                                                                        
 ,TOXICITY                                  KEY2                                                                        
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PT_SUBGRP||TOXICITY         LINE_TEXT                                                                               
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 PT_SUBGRP, KEY2 TOXICITY                                                        
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, ' ' PT                                                                                            
      ,' '                                     PATIENT                                                                  
      ,EXT_UTIL_PKG.F_VAR(PT_SUBGRP_FUL, 10)    KEY1                                                                    
      ,EXT_UTIL_PKG.F_VAR(NVL(AE_DESCR_FUL, SUBSTR(CTC_TERM_FUL, 1, 33)), 33)  KEY2                                     
  FROM PP_EXT_OWNER.CTSC_DOS_LIMIT_TOX                                                                                  
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     EC                                               
C_EC                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,''                                 KEY1                                                                               
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_VAR(CHECKLIST_NUM_FUL, 2)||                                                                          
    EXT_UTIL_PKG.F_VAR_EC(Q1_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q2_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q3_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q4_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q5_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q6_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q7_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q8_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q9_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q10_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q11_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q12_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q13_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q14_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q15_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q16_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q17_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q18_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q19_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q20_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q21_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q22_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q23_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q24_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q25_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q26_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q27_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q28_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q29_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q30_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q31_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q32_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q33_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q34_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q35_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q36_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q37_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q38_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q39_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q40_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR(PT_ELIG_IND_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(ELIG_WAIVER_REAS_FUL, 64)||                                                                      
    EXT_UTIL_PKG.F_VAR(WAIVER_NUM_FUL, 12)           LINE_TEXT                                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'     COURSE_NUM   ----                                                                                           
 ,A.PATIENT_FUL                                                                                                         
 ,A.CHECKLIST_NUM_FUL                                                                                                   
 ,A.EFFCT_DT_FUL                                                                                                        
 ,A.Q1_FUL                                                                                                              
 ,A.Q2_FUL                                                                                                              
 ,A.Q3_FUL                                                                                                              
 ,A.Q4_FUL                                                                                                              
 ,A.Q5_FUL                                                                                                              
 ,A.Q6_FUL                                                                                                              
 ,A.Q7_FUL                                                                                                              
 ,A.Q8_FUL                                                                                                              
 ,A.Q9_FUL                                                                                                              
 ,A.Q10_FUL                                                                                                             
 ,A.Q11_FUL                                                                                                             
 ,A.Q12_FUL                                                                                                             
 ,A.Q13_FUL                                                                                                             
 ,A.Q14_FUL                                                                                                             
 ,A.Q15_FUL                                                                                                             
 ,A.Q16_FUL                                                                                                             
 ,A.Q17_FUL                                                                                                             
 ,A.Q18_FUL                                                                                                             
 ,A.Q19_FUL                                                                                                             
 ,A.Q20_FUL                                                                                                             
 ,A.Q21_FUL                                                                                                             
 ,A.Q22_FUL                                                                                                             
 ,A.Q23_FUL                                                                                                             
 ,A.Q24_FUL                                                                                                             
 ,A.Q25_FUL                                                                                                             
 ,A.Q26_FUL                                                                                                             
 ,A.Q27_FUL                                                                                                             
 ,A.Q28_FUL                                                                                                             
 ,A.Q29_FUL                                                                                                             
 ,A.Q30_FUL                                                                                                             
 ,A.Q31_FUL                                                                                                             
 ,A.Q32_FUL                                                                                                             
 ,A.Q33_FUL                                                                                                             
 ,A.Q34_FUL                                                                                                             
 ,A.Q35_FUL                                                                                                             
 ,A.Q36_FUL                                                                                                             
 ,A.Q37_FUL                                                                                                             
 ,A.Q38_FUL                                                                                                             
 ,A.Q39_FUL                                                                                                             
 ,A.Q40_FUL                                                                                                             
 ,A.PT_ELIG_IND_FUL                                                                                                     
 ,A.ELIG_WAIVER_REAS_FUL                                                                                                
 ,NVL(A.WAIVER_NUM_FUL, '*') WAIVER_NUM_FUL                                                                             
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_ELIG_CHECK A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     EC                                               
C_EC_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,''                                KEY1                                                                                
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT          LINE_TEXT                                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT                                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                                                                              
  FROM PP_EXT_OWNER.CTSC_ELIG_CHECK                                                                                     
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     EN                                               
C_EN                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,''                             KEY1                                                                                   
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_VAR(PT_GENDER_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_TO_CHAR(RACE_FUL, 2, 0)||                                                                            
    EXT_UTIL_PKG.F_VAR(OTHER_RACE_FUL, 20)||                                                                            
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(PT_DOB_FUL), 8)||                                                     
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(REG_DT_FUL), 8)||                                                     
    EXT_UTIL_PKG.F_AGE_TO_CHAR(CTMS_AGE_FUL, 6, 2)||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(WEIGHT_KG_FUL, 6, 2)||                                                                       
    EXT_UTIL_PKG.F_VAR(WGT_UNIT_FUL, 4)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(HEIGHT_CM_FUL, 6, 2)||                                                                       
    EXT_UTIL_PKG.F_VAR(HT_UNIT_FUL, 4)||                                                                                
    EXT_UTIL_PKG.F_VAR(FILTER_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(BSA_FUL, 5, 2)||                                                                             
    EXT_UTIL_PKG.F_VAR(PT_SUBGRP_FUL, 10)||                                                                             
    EXT_UTIL_PKG.F_VAR(REG_GRP_FUL, 6)||                                                                                
    EXT_UTIL_PKG.F_VAR(REG_INST_FUL, 6)||                                                                               
    EXT_UTIL_PKG.F_VAR(CNTRY_CD_FUL, 2)||                                                                               
    EXT_UTIL_PKG.F_VAR(PST_CD_FUL, 10)||                                                                                
    EXT_UTIL_PKG.F_VAR(PYMT_MTHD_FUL, 2)||                                                                              
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_DISEAS_CD_FUL, 10, 0)||                                                                 
    EXT_UTIL_PKG.F_VAR(PRIM_SITE_FUL, 20)||                                                                             
    EXT_UTIL_PKG.F_VAR(DISEAS_STG_FUL, 8)||                                                                             
    GRADE_FUL||                                                                                                         
    EXT_UTIL_PKG.F_TO_CHAR(PERF_ZUBROD_FUL, 3, 0)||                                                                     
    EXT_UTIL_PKG.F_VAR(HIST_CYTPATH_FUL, 40)||                                                                          
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(HIST_CONF_DT_FUL), 8)||                                               
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(DIAG_DT_FUL), 8)||                                                    
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(CONS_DT_FUL), 8)||                                                    
    EXT_UTIL_PKG.F_VAR(CONS_VERS_FUL, 12)||                                                                             
    EXT_UTIL_PKG.F_VAR(CDUS_TX_ASSIG_CD_FUL, 10)                                  LINE_TEXT                             
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'                                                COURSE_NUM   ----                                                
 ,A.PATIENT_FUL                                                                                                         
 ,DECODE(A.PT_GENDER_FUL, 'F', 'F', 'M', 'M', NULL)   PT_GENDER_FUL                                                     
 ,DECODE(NVL(INSTR(A.RACE_FUL, '='), 0), 0, SUBSTR(A.RACE_FUL, 1, 2),                                                   
                                      SUBSTR(A.RACE_FUL, 1, INSTR(A.RACE_FUL, '=') - 1)) RACE_FUL                       
 ,DECODE(A.RACE_FUL, '98', 'OTHER RACE', '*')  OTHER_RACE_FUL                                                           
 ,A.PT_DOB_FUL       PT_DOB_FUL                                                                                         
 ,A.REG_DT_FUL       REG_DT_FUL                                                                                         
 ,A.CTMS_AGE_FUL                                                                                                        
 ,A.WEIGHT_KG_FUL                                                                                                       
 ,'kg'    WGT_UNIT_FUL                                                                                                  
 ,A.HEIGHT_CM_FUL                                                                                                       
 ,'cm'    HT_UNIT_FUL                                                                                                   
 ,'0' FILTER_FUL                                                                                                        
 ,A.BSA_FUL                                                                                                             
 ,NVL(A.PT_SUBGRP_FUL, 'SUBGROUPA')   PT_SUBGRP_FUL                                                                     
 ,NVL(A.REG_GRP_FUL, '*')    REG_GRP_FUL                                                                                
 ,A.REG_INST_FUL                                                                                                        
 ,A.CNTRY_CD_FUL                                                                                                        
 ,A.PST_CD_FUL                                                                                                          
 ,NVL(A.PYMT_MTHD_FUL, '98')  PYMT_MTHD_FUL                                                                             
 ,A.CDUS_DISEAS_CD_FUL                                                                                                  
 ,A.CDUS_TX_ASSIG_CD_FUL                                                                                                
 ,A.PRIM_SITE_FUL                                                                                                       
 ,A.DISEAS_STG_FUL                                                                                                      
 ,'    '              GRADE_FUL                                                                                         
 ,DECODE(NVL(INSTR(A.PERF_ZUBROD_FUL, '='), 0), 0, SUBSTR(A.PERF_ZUBROD_FUL, 1, 3),                                     
                         SUBSTR(A.PERF_ZUBROD_FUL, 1, INSTR(A.PERF_ZUBROD_FUL, '=') - 1)) PERF_ZUBROD_FUL               
 ,A.HIST_CYTPATH_FUL                                                                                                    
 ,A.HIST_CONF_DT_FUL                                                                                                    
 ,A.DIAG_DT_FUL                                                                                                         
 ,A.CONS_DT_FUL                                                                                                         
 ,A.CONS_VERS_FUL                                                                                                       
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_ENROLLMENT A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     EN                                               
C_EN_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_ENROLLMENT_CM A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     EN                                               
C_EN_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_ENROLLMENT_CM                                                                                  
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     EN                                               
C_EN_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,''                           KEY1                                                                                     
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT        LINE_TEXT                                                                                            
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT                                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                                                                              
  FROM PP_EXT_OWNER.CTSC_ENROLLMENT                                                                                     
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     EX                                               
C_LAB_OTH_EX                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(PANEL, 2, 0)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_1_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_2_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_3_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_4_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_5_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_6_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_7_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_8_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_9_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_10_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_11_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_12_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_13_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_14_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_15_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_16_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_17_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_18_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_19_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_20_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_21_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_22_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_23_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_24_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_25_FUL, 9, 3)||' '     LINE_TEXT                                              
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_EX A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
NCI5319                        THERADEX                       T300     EX                                               
C_LAB_OTH_EX_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     FO                                               
C_FO                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,''                                 KEY1                                                                               
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(OFF_STDY_DT_FUL)||                                                                       
    EXT_UTIL_PKG.F_VAR(OFF_STDY_REAS_FUL, 1)||                                                                          
    EXT_UTIL_PKG.F_VAR(OFF_STDY_OTH_REAS_FUL, 24)||                                                                     
    EXT_UTIL_PKG.F_VAR(RESPS_ASSMNT_FUL, 2)||                                                                           
    EXT_UTIL_PKG.F_FORMAT_DATE(BEST_RSPNS_ONSET_DT_FUL)||                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(RELAPSE_DT_FUL)||                                                                        
    EXT_UTIL_PKG.F_FORMAT_DATE(PROG_DT_FUL)         LINE_TEXT                                                           
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'                               COURSE_NUM   ----                                                                 
 ,A.PATIENT_FUL                                                                                                         
 ,A.OFF_STDY_DT_FUL                                                                                                     
 ,A.OFF_STDY_REAS_FUL                                                                                                   
 ,A.OFF_STDY_OTH_REAS_FUL                                                                                               
 ,A.RESPS_ASSMNT_FUL                                                                                                    
 ,A.BEST_RSPNS_ONSET_DT_FUL                                                                                             
 ,A.RELAPSE_DT_FUL                                                                                                      
 ,A.PROG_DT_FUL                                                                                                         
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     FO                                               
C_FO_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM_CM A,                                                                            
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     FO                                               
C_FO_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM_CM                                                                              
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     FO                                               
C_FO_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,''                                 KEY1                                                                               
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT         LINE_TEXT                                                                                           
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT                                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)   PATIENT                                                                    
  FROM PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM                                                                                 
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     FP                                               
C_FP                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NVL(DEATH_DT_FUL, LAST_CONTACT_DT_FUL))   KEY1                                             
 ,''                                                                  KEY2                                              
 ,''                                                                  KEY3                                              
 ,''                                                                  KEY4                                              
 ,''                                                                  KEY5                                              
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NVL(DEATH_DT_FUL, LAST_CONTACT_DT_FUL))||                                                
    EXT_UTIL_PKG.F_VAR(PAT_STAT_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_VAR(PT_OTH_STAT_FUL, 24)          LINE_TEXT                                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'       COURSE_NUM   ----                                                                                         
 ,A.PATIENT_FUL                                                                                                         
 ,A.LAST_CONTACT_DT_FUL                                                                                                 
 ,A.DEATH_DT_FUL                                                                                                        
 ,A.PT_STAT_FUL                                                                                                         
 ,A.PT_OTH_STAT_FUL                                                                                                     
 ,A.PAT_STAT_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_FOLLOW_UP A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     FP                                               
C_FP_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_FOLLOW_UP_CM A,                                                                                 
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     FP                                               
C_FP_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_FOLLOW_UP_CM                                                                                   
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     FP                                               
C_FP_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,LAST_CONTACT_DT                                 KEY1                                                                  
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LAST_CONTACT_DT          LINE_TEXT                                                                         
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LAST_CONTACT_DT                                                                 
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)   PATIENT                                                                    
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NVL(DEATH_DT_FUL, LAST_CONTACT_DT_FUL))  KEY1                                         
  FROM PP_EXT_OWNER.CTSC_FOLLOW_UP                                                                                      
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     HM                                               
C_HM                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(HEMOGLOBIN_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(HEMATOCRIT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(WBC_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(NEUTROPHIL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(BASOPHILS_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(MONOCYTES_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(EOSINOPHIL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_BANDS(BANDS_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR(BLASTS_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(ATYP_LYMPH_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(OTHER_DIFF_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PLATELETS_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(ANC_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(RBC_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(RETICULO_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(ESR_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(PTIME_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(PTT_FUL, 9, 3)||' '                       LINE_TEXT                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.HEMOGLOBIN_FUL                                                                                                      
 ,A.HEMATOCRIT_FUL                                                                                                      
 ,A.WBC_FUL                                                                                                             
 ,A.NEUTROPHIL_FUL                                                                                                      
 ,A.LYMPHOCYTE_FUL                                                                                                      
 ,A.BASOPHILS_FUL                                                                                                       
 ,A.MONOCYTES_FUL                                                                                                       
 ,A.EOSINOPHIL_FUL                                                                                                      
 ,A.BANDS_FUL                                                                                                           
 ,A.BLASTS_FUL                                                                                                          
 ,A.ATYP_LYMPH_FUL                                                                                                      
 ,A.OTHER_DIFF_FUL                                                                                                      
 ,A.PLATELETS_FUL                                                                                                       
 ,A.ANC_FUL                                                                                                             
 ,A.RBC_FUL                                                                                                             
 ,A.RETICULO_FUL                                                                                                        
 ,A.ESR_FUL                                                                                                             
 ,A.PTIME_FUL                                                                                                           
 ,A.PTT_FUL                                                                                                             
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_HEMA A,                                                                                     
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     HM                                               
C_HM_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_HEMA_CM A,                                                                                  
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     HM                                               
C_HM_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_LAB_HEMA_CM                                                                                    
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     HM                                               
C_HM_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_HEMA                                                                                       
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     HM                                               
C_LAB_OTH_HM                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
           EXT_UTIL_PKG.F_TO_CHAR(HEMOGLOBIN_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(HEMATOCRIT_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(WBC_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(NEUTROPHIL_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(BASOPHILS_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(MONOCYTES_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(EOSINOPHIL_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR_BANDS(BANDS_FUL, 9, 3)||' '||                                                         
           EXT_UTIL_PKG.F_TO_CHAR(BLASTS_FUL, 9, 3)||' '||                                                              
           EXT_UTIL_PKG.F_TO_CHAR(ATYP_LYMPH_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(OTHER_DIFF_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(PLATELETS_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(ANC_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(RBC_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(RETICULO_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(ESR_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(PTIME_FUL, 9, 3)||' '||                                                               
           EXT_UTIL_PKG.F_TO_CHAR(PTT_FUL, 9, 3)||' '      LINE_TEXT                                                    
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_HM A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
NCI5319                        THERADEX                       T300     HM                                               
C_LAB_OTH_HM_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     IE                                               
C_IE                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)             KEY1                                                             
 ,EXT_UTIL_PKG.F_VAR(INFECT_TYP_FUL, 20)               KEY2                                                             
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(INFECT_TYP_FUL, 20)||                                                                            
    EXT_UTIL_PKG.F_VAR(PRIM_SITE_FUL, 20)||                                                                             
    EXT_UTIL_PKG.F_VAR(INFECT_AGNT_FUL, 24)||                                                                           
    EXT_UTIL_PKG.F_VAR(TX_FUL, 24)||                                                                                    
    EXT_UTIL_PKG.F_FORMAT_DATE(RESOLV_DT_FUL)||                                                                         
    EXT_UTIL_PKG.F_VAR(OUTCOME_FUL, 24)          LINE_TEXT                                                              
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.ONSET_DT_FUL)     COURSE_NUM   ----                          
 ,A.PATIENT_FUL                                                                                                         
 ,A.ONSET_DT_FUL                                                                                                        
 ,A.INFECT_TYP_FUL                                                                                                      
 ,A.PRIM_SITE_FUL                                                                                                       
 ,A.INFECT_AGNT_FUL                                                                                                     
 ,A.TX_FUL                                                                                                              
 ,A.RESOLV_DT_FUL                                                                                                       
 ,A.OUTCOME_FUL                                                                                                         
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_INFECTION_EP A,                                                                                 
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     IE                                               
C_IE_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_INFECTION_EP_CM A,                                                                              
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     IE                                               
C_IE_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_INFECTION_EP_CM                                                                                
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     IE                                               
C_IE_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,ONSET_DT                                 KEY1                                                                         
 ,INFECT_TYP                                      KEY2                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||ONSET_DT||INFECT_TYP          LINE_TEXT                                                                    
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 ONSET_DT, KEY2 INFECT_TYP                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)       PATIENT                                                                
      ,EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)  KEY1                                                                   
      ,EXT_UTIL_PKG.F_VAR(INFECT_TYP_FUL, 20)    KEY2                                                                   
  FROM PP_EXT_OWNER.CTSC_INFECTION_EP                                                                                   
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     IP                                               
C_IP                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(B_CELL_LEV_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(T_CELL_TOT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(T_CELL_HLP_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(T_CELL_SUP_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(T_CELL_DTH_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(T_CELL_CTL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(NK_ACTIV_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(ADCC_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(CYTOTOX_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CYTOSTASIS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PEROX_GEN_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(INTERFERON_FUL, 9, 3)||' '          LINE_TEXT                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.LYMPHOCYTE_FUL                                                                                                      
 ,A.B_CELL_LEV_FUL                                                                                                      
 ,A.T_CELL_TOT_FUL                                                                                                      
 ,A.T_CELL_HLP_FUL                                                                                                      
 ,A.T_CELL_SUP_FUL                                                                                                      
 ,A.T_CELL_DTH_FUL                                                                                                      
 ,A.T_CELL_CTL_FUL                                                                                                      
 ,A.NK_ACTIV_FUL                                                                                                        
 ,A.ADCC_FUL                                                                                                            
 ,A.CYTOTOX_FUL                                                                                                         
 ,A.CYTOSTASIS_FUL                                                                                                      
 ,A.PEROX_GEN_FUL                                                                                                       
 ,A.INTERFERON_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_IP A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     IP                                               
C_IP_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_IP_CM A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     IP                                               
C_IP_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_LAB_IP_CM                                                                                      
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     IP                                               
C_IP_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_IP                                                                                         
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     IP                                               
C_LAB_OTH_IP                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
           EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(B_CELL_LEV_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(T_CELL_TOT_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(T_CELL_HLP_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(T_CELL_SUP_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(T_CELL_DTH_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(T_CELL_CTL_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(NK_ACTIV_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(ADCC_FUL, 9, 3)||' '||                                                                
           EXT_UTIL_PKG.F_TO_CHAR(CYTOTOX_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(CYTOSTASIS_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(PEROX_GEN_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(INTERFERON_FUL, 9, 3)||' '      LINE_TEXT                                             
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_IP A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
NCI5319                        THERADEX                       T300     IP                                               
C_LAB_OTH_IP_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     LL                                               
C_LL                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)           KEY1                                                                 
 ,EXT_UTIL_PKG.F_FORMAT_TIME(LAB_TIME_FUL)         KEY2                                                                 
 ,EXT_UTIL_PKG.F_VAR(TEST_NAME_FUL, 8)             KEY3                                                                 
 ,EXT_UTIL_PKG.F_VAR(BD_SITE_FUL, 8)               KEY4                                                                 
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)||                                                                            
    EXT_UTIL_PKG.F_FORMAT_TIME(LAB_TIME_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(TEST_NAME_FUL, 8)||                                                                              
    EXT_UTIL_PKG.F_VAR(BD_SITE_FUL, 8)||                                                                                
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(NORM_ABNORM_IND_FUL, 1)||                                                                        
    EXT_UTIL_PKG.F_VAR(RSLT_FUL, 128)||' '         LINE_TEXT                                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.LAB_DT_FUL)     COURSE_NUM   ----                            
 ,A.PATIENT_FUL                                                                                                         
 ,A.LAB_DT_FUL                                                                                                          
 ,A.LAB_TIME_FUL                                                                                                        
 ,'        '             LAB_GROUP                                                                                      
 ,'    '                 LAB_CODE                                                                                       
 ,A.BD_SITE_FUL                                                                                                         
 ,A.NORM_ABNORM_IND_FUL                                                                                                 
 ,A.RSLT_FUL                                                                                                            
 ,A.TEST_NAME_FUL                                                                                                       
 ,A.TIME_FUL                                                                                                            
 ,A.REG_INST_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_SPEC_LITERAL A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     LL                                               
C_LL_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_SPEC_LITERAL_CM A,                                                                          
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     LL                                               
C_LL_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_LAB_SPEC_LITERAL_CM                                                                            
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     LL                                               
C_LL_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,LAB_DT                                       KEY1                                                                     
 ,LAB_TIME                                     KEY2                                                                     
 ,TEST_NAME                                    KEY3                                                                     
 ,BD_SITE                                      KEY4                                                                     
 ,''                                           KEY5                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LAB_DT||LAB_TIME||TEST_NAME||BD_SITE        LINE_TEXT                                                      
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LAB_DT, KEY2 LAB_TIME, KEY3 TEST_NAME, KEY4 BD_SITE                             
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)       PATIENT                                                                
      ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)    KEY1                                                                   
      ,EXT_UTIL_PKG.F_FORMAT_TIME(LAB_TIME_FUL)  KEY2                                                                   
      ,EXT_UTIL_PKG.F_VAR(TEST_NAME_FUL, 8)      KEY3                                                                   
      ,EXT_UTIL_PKG.F_VAR(BD_SITE_FUL, 8)        KEY4                                                                   
  FROM PP_EXT_OWNER.CTSC_LAB_SPEC_LITERAL                                                                               
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     LS                                               
C_LS                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0)      KEY1                                                                
 ,''                                            KEY2                                                                    
 ,''                                            KEY3                                                                    
 ,''                                            KEY4                                                                    
 ,''                                            KEY5                                                                    
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0)||                                                                      
    EXT_UTIL_PKG.F_VAR(ORGAN_FUL, 8)||                                                                                  
    EXT_UTIL_PKG.F_VAR(LESION_DESCR_FUL, 32)||                                                                          
    EXT_UTIL_PKG.F_VAR(PREV_IRRAD_IND_FUL, 1)||                                                                         
    EXT_UTIL_PKG.F_VAR(MEASUR_IND_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_VAR(FOLLOW_RESPS_IND_FUL, 1)             LINE_TEXT                                                   
FROM (                                                                                                                  

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'              COURSE_NUM   ----                                                                                  
 ,A.PATIENT_FUL                                                                                                         
 ,A.LESION_NUM_FUL                                                                                                      
 ,A.ORGAN_FUL                                                                                                           
 ,A.LESION_DESCR_FUL                                                                                                    
 ,A.PREV_IRRAD_IND_FUL                                                                                                  
 ,A.FOLLOW_RESPS_IND_FUL                                                                                                
 ,A.MEASUR_IND_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LESION_DESCRIPTION A,                                                                           
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     LS                                               
C_LS_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,LESION_NUM                                      KEY1                                                                  
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LESION_NUM          LINE_TEXT                                                                              
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LESION_NUM                                                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0) KEY1                                                                
  FROM PP_EXT_OWNER.CTSC_LESION_DESCRIPTION                                                                             
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     LX                                               
C_LAB_OTH_LX                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(PANEL, 2, 0)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
              EXT_UTIL_PKG.F_VAR(FIELD_1_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_2_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_3_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_4_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_5_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_6_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_7_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_8_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_9_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_10_FUL, 64)||' '     LINE_TEXT                                                   
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_LX A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
NCI5319                        THERADEX                       T300     LX                                               
C_LAB_OTH_LX_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     MH                                               
C_MH                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL)            KEY1                                                               
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(HEENT_FUL, 128)||                                                                                
    EXT_UTIL_PKG.F_VAR(NECK_FUL, 128)||                                                                                 
    EXT_UTIL_PKG.F_VAR(RESPIRAT_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(CARDIO_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(GASTRO_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(MUSKULOSKEL_FUL, 128)||                                                                          
    EXT_UTIL_PKG.F_VAR(DERMAT_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(HEM_LYM_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(ENDO_MET_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(URINARY_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(GENITAL_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(BREASTS_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(PELVIS_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(ABDOMEN_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(NEUROLOG_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(PHYSCHOL_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(OTHER_FUL, 128)         LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'    COURSE_NUM   ----                                                                                            
 ,A.PATIENT_FUL                                                                                                         
 ,A.EXAM_DT_FUL                                                                                                         
 ,A.HEENT_FUL                                                                                                           
 ,A.NECK_FUL                                                                                                            
 ,A.RESPIRAT_FUL                                                                                                        
 ,A.CARDIO_FUL                                                                                                          
 ,A.GASTRO_FUL                                                                                                          
 ,A.MUSKULOSKEL_FUL                                                                                                     
 ,A.DERMAT_FUL                                                                                                          
 ,A.HEM_LYM_FUL                                                                                                         
 ,A.ENDO_MET_FUL                                                                                                        
 ,A.URINARY_FUL                                                                                                         
 ,A.GENITAL_FUL                                                                                                         
 ,A.BREASTS_FUL                                                                                                         
 ,A.PELVIS_FUL                                                                                                          
 ,A.ABDOMEN_FUL                                                                                                         
 ,A.NEUROLOG_FUL                                                                                                        
 ,A.PHYSCHOL_FUL                                                                                                        
 ,A.OTHER_FUL     ---------------                                                                                       
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_BASE_MED_HIST A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     MH                                               
C_MH_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_BASE_MED_HIST_CM A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     MH                                               
C_MH_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_BASE_MED_HIST_CM                                                                               
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     MH                                               
C_MH_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,EXAM_DT                                 KEY1                                                                          
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||EXAM_DT         LINE_TEXT                                                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 EXAM_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)     PATIENT                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL) KEY1                                                                     
  FROM PP_EXT_OWNER.CTSC_BASE_MED_HIST                                                                                  
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     OU                                               
C_LAB_OTH_OU                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CHLORIDE_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(OSMOLALITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(OXALATE_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(POTASSIUM_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALBUM_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALPH1_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALPH2_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_BETA_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PROT_GAMMA_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(SODIUM_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(UREA_NITRO_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(URIC_ACID_FUL, 9, 3)||' '       LINE_TEXT                                                    
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_OU A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
NCI5319                        THERADEX                       T300     OU                                               
C_LAB_OTH_OU_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     OU                                               
C_OU                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CHLORIDE_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(OSMOLALITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(OXALATE_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(POTASSIUM_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALBUM_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALPH1_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALPH2_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_BETA_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PROT_GAMMA_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(SODIUM_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(UREA_NITRO_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(URIC_ACID_FUL, 9, 3)||' '           LINE_TEXT                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.CALCIUM_FUL                                                                                                         
 ,A.CHLORIDE_FUL                                                                                                        
 ,A.OSMOLALITY_FUL                                                                                                      
 ,A.OXALATE_FUL                                                                                                         
 ,A.POTASSIUM_FUL                                                                                                       
 ,A.PROT_ALBUM_FUL                                                                                                      
 ,A.PROT_ALPH1_FUL                                                                                                      
 ,A.PROT_ALPH2_FUL                                                                                                      
 ,A.PROT_BETA_FUL                                                                                                       
 ,A.PROT_GAMMA_FUL                                                                                                      
 ,A.SODIUM_FUL                                                                                                          
 ,A.UREA_NITRO_FUL                                                                                                      
 ,A.URIC_ACID_FUL                                                                                                       
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OU A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     OU                                               
C_OU_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OU_CM A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     OU                                               
C_OU_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_LAB_OU_CM                                                                                      
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     OU                                               
C_OU_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_OU                                                                                         
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     PE                                               
C_PE                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL)       KEY1                                                                    
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(HEENT_FLAG_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_VAR(HEENT_FUL, 128)||                                                                                
    EXT_UTIL_PKG.F_VAR(NECK_FLAG_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_VAR(NECK_FUL, 128)||                                                                                 
    EXT_UTIL_PKG.F_VAR(RESPIRAT_FLAG_FUL, 1)||                                                                          
    EXT_UTIL_PKG.F_VAR(RESPIRAT_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(CARDIO_FLAG_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(CARDIO_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(GASTRO_FLAG_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(GASTRO_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(MUSKULOSKEL_FLAG_FUL, 1)||                                                                       
    EXT_UTIL_PKG.F_VAR(MUSKULOSKEL_FUL, 128)||                                                                          
    EXT_UTIL_PKG.F_VAR(DERMAT_FLAG_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(DERMAT_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(HEM_LYM_FLAG_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(HEM_LYM_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(ENDO_MET_FLAG_FUL, 1)||                                                                          
    EXT_UTIL_PKG.F_VAR(ENDO_MET_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(URINARY_FLAG_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(URINARY_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(GENITAL_FLAG_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(GENITAL_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(BREASTS_FLAG_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(BREASTS_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(PELVIS_FLAG_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(PELVIS_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(ABDOMEN_FLAG_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(ABDOMEN_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(NEUROLOG_FLAG_FUL, 1)||                                                                          
    EXT_UTIL_PKG.F_VAR(NEUROLOG_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(PHYSCHOL_FLAG_FUL, 1)||                                                                          
    EXT_UTIL_PKG.F_VAR(PHYSCHOL_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(OTHER_FLAG_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_VAR(OTHER_FUL, 128)               LINE_TEXT                                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.EXAM_DT_FUL)     COURSE_NUM   ----                           
 ,A.PATIENT_FUL                                                                                                         
 ,A.EXAM_DT_FUL                                                                                                         
 ,A.HEENT_FLAG_FUL                                                                                                      
 ,A.HEENT_FUL                                                                                                           
 ,A.NECK_FLAG_FUL                                                                                                       
 ,A.NECK_FUL                                                                                                            
 ,A.RESPIRAT_FLAG_FUL                                                                                                   
 ,A.RESPIRAT_FUL                                                                                                        
 ,A.CARDIO_FLAG_FUL                                                                                                     
 ,A.CARDIO_FUL                                                                                                          
 ,A.GASTRO_FLAG_FUL                                                                                                     
 ,A.GASTRO_FUL                                                                                                          
 ,A.MUSKULOSKEL_FLAG_FUL                                                                                                
 ,A.MUSKULOSKEL_FUL                                                                                                     
 ,A.DERMAT_FLAG_FUL                                                                                                     
 ,A.DERMAT_FUL                                                                                                          
 ,A.HEM_LYM_FLAG_FUL                                                                                                    
 ,A.HEM_LYM_FUL                                                                                                         
 ,A.ENDO_MET_FLAG_FUL                                                                                                   
 ,A.ENDO_MET_FUL                                                                                                        
 ,A.URINARY_FLAG_FUL                                                                                                    
 ,A.URINARY_FUL                                                                                                         
 ,A.GENITAL_FLAG_FUL                                                                                                    
 ,A.GENITAL_FUL                                                                                                         
 ,A.BREASTS_FLAG_FUL                                                                                                    
 ,A.BREASTS_FUL                                                                                                         
 ,A.PELVIS_FLAG_FUL                                                                                                     
 ,A.PELVIS_FUL                                                                                                          
 ,A.ABDOMEN_FLAG_FUL                                                                                                    
 ,A.ABDOMEN_FUL                                                                                                         
 ,A.NEUROLOG_FLAG_FUL                                                                                                   
 ,A.NEUROLOG_FUL                                                                                                        
 ,A.PHYSCHOL_FLAG_FUL                                                                                                   
 ,A.PHYSCHOL_FUL                                                                                                        
 ,A.OTHER_FLAG_FUL                                                                                                      
 ,A.OTHER_FUL                                                                                                           
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PHYSICAL_EXAM A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PE                                               
C_PE_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PHYSICAL_EXAM_CM A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PE                                               
C_PE_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_PHYSICAL_EXAM_CM                                                                               
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     PE                                               
C_PE_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,EXAM_DT                                 KEY1                                                                          
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||EXAM_DT         LINE_TEXT                                                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 EXAM_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_PHYSICAL_EXAM                                                                                  
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     PH                                               
C_LAB_OTH_CM                                                                                                            
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT_FUL                                             PATIENT                                                       
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)                                 KEY1                                          
 ,:P_FILE_ID                                           KEY2                                                             
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                    INST_ID                                                                                     
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT)             COURSE_NUM   ----                       
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_CM A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE IS NOT NULL                                                                                                
  AND A.NOTE IS NOT NULL                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY))                                                          
                                                                                                                        
NCI5319                        THERADEX                       T300     PH                                               
C_LAB_OTH_CM_DEL                                                                                                        
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,''                                                  PATIENT                                                           
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT)                                 KEY1                                              
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT)||                                                                               
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 8)              LINE_TEXT                                                            
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND EXT_SOURCE = 'O'                                                                                                 
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT, PATIENT_FUL, EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)                                          
  FROM PP_EXT_OWNER.CTSC_LAB_OTH_CM                                                                                     
 WHERE STUDY = :P_STUDY))                                                                                               
                                                                                                                        
NCI5319                        THERADEX                       T300     PH                                               
C_PH_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT)      KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,EXT_UTIL_PKG.F_VAR(TYP_CD, 3)            KEY3                                                                         
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT)||                                                                               
    EXT_UTIL_PKG.F_VAR(TYP_CD, 3)||                                                                                     
    EXT_UTIL_PKG.F_VAR(NOTE, 1024)                             LINE_TEXT                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT)             COURSE_NUM   ----                       
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT                                                                                                             
 ,A.TYP_CD                                                                                                              
 ,A.NOTE                                                                                                                
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PHYSICAL_EXAM_CM A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE IS NOT NULL                                                                                                
  AND 1 = 2                                                                                                             
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PH                                               
C_PH_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                            KEY1                                                                               
 ,:P_FILE_ID                          KEY2                                                                              
 ,TYP_CD                             KEY3                                                                               
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT, KEY3 TYP_CD                                                            
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT)      KEY1                                                                    
      ,EXT_UTIL_PKG.F_VAR(TYP_CD, 3)            KEY3                                                                    
  FROM PP_EXT_OWNER.CTSC_PHYSICAL_EXAM_CM                                                                               
)  )                                                                                                                    
WHERE 1 = 2                                                                                                             
                                                                                                                        
NCI5319                        THERADEX                       T300     PK                                               
C_PK                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)                KEY1                                                             
 ,EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)              KEY2                                                             
 ,EXT_UTIL_PKG.F_FORMAT_TIME(START_TIME_FUL)           KEY3                                                             
 ,EXT_UTIL_PKG.F_VAR(SAMPL_SPCMN_FUL, 8)               KEY4                                                             
 ,EXT_UTIL_PKG.F_TO_CHAR(INJECT_DURATN_FUL, 2, 0)      KEY5                                                             
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_FORMAT_TIME(START_TIME_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(SAMPL_SPCMN_FUL, 8)||                                                                            
    EXT_UTIL_PKG.F_TO_CHAR(INJECT_DURATN_FUL, 2, 0)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(PRNT_DRUG_ASSAY_FUL1, 8, 3)||                                                                
    EXT_UTIL_PKG.F_VAR(PRNT_DRUG_ASSAY_UOM_FUL1, 10)||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PRNT_DRUG_ASSAY_FUL2, 8, 3)||                                                                
    EXT_UTIL_PKG.F_VAR(PRNT_DRUG_ASSAY_UOM_FUL2, 10)||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PRNT_DRUG_MEAN_CONC_FUL, 8, 3)||                                                             
    EXT_UTIL_PKG.F_VAR(PRNT_DRG_MN_CONC_UOM_FUL, 10)||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(METABOLITE_ASSAY_FUL1, 8, 3)||                                                               
    EXT_UTIL_PKG.F_VAR(METABOLITE_ASSAY_UOM_FUL1, 10)||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(METABOLITE_ASSAY_FUL2, 8, 3)||                                                               
    EXT_UTIL_PKG.F_VAR(METABOLITE_ASSAY_UOM_FUL2, 10)||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MTBLIT_MEAN_CONC_FUL, 8, 3)||                                                                
    EXT_UTIL_PKG.F_VAR(MTBLIT_MEAN_CONC_UOM_FUL, 10)             LINE_TEXT                                              
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.DOSE_DT_FUL)     COURSE_NUM   ----                           
 ,A.PATIENT_FUL                                                                                                         
 ,A.CTMS_AGENT_FUL                                                                                                      
 ,A.DOSE_DT_FUL                                                                                                         
 ,A.START_TIME_FUL                                                                                                      
 ,A.SAMPL_SPCMN_FUL                                                                                                     
 ,A.INJECT_DURATN_FUL                                                                                                   
 ,A.PRNT_DRUG_ASSAY_FUL1                                                                                                
 ,A.PRNT_DRUG_ASSAY_UOM_FUL1                                                                                            
 ,A.PRNT_DRUG_ASSAY_FUL2                                                                                                
 ,A.PRNT_DRUG_ASSAY_UOM_FUL2                                                                                            
 ,A.PRNT_DRUG_MEAN_CONC_FUL                                                                                             
 ,A.PRNT_DRG_MN_CONC_UOM_FUL                                                                                            
 ,A.METABOLITE_ASSAY_FUL1                                                                                               
 ,A.METABOLITE_ASSAY_UOM_FUL1                                                                                           
 ,A.METABOLITE_ASSAY_FUL2                                                                                               
 ,A.METABOLITE_ASSAY_UOM_FUL2                                                                                           
 ,A.MTBLIT_MEAN_CONC_FUL                                                                                                
 ,A.MTBLIT_MEAN_CONC_UOM_FUL                                                                                            
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PHARMACOKINETICS  A,                                                                            
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PK                                               
C_PK_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PHARMACOKINETICS_CM A,                                                                          
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PK                                               
C_PK_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_PHARMACOKINETICS_CM                                                                            
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     PK                                               
C_PK_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,CTMS_AGENT                                 KEY1                                                                       
 ,DOSE_DT                                          KEY2                                                                 
 ,START_TIME                                       KEY3                                                                 
 ,SAMPL_SPCMN                                       KEY4                                                                
 ,INJECT_DURATN                                     KEY5                                                                
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||CTMS_AGENT||DOSE_DT||START_TIME||SAMPL_SPCMN||INJECT_DURATN        LINE_TEXT                               
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT,                                                                                      
       KEY1 CTMS_AGENT, KEY2 DOSE_DT, KEY3 START_TIME, KEY4 SAMPL_SPCMN, KEY5 INJECT_DURATN                             
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)              PATIENT                                                         
      ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)            KEY1                                                            
      ,EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)          KEY2                                                            
      ,EXT_UTIL_PKG.F_FORMAT_TIME(START_TIME_FUL)       KEY3                                                            
      ,EXT_UTIL_PKG.F_VAR(SAMPL_SPCMN_FUL, 8)           KEY4                                                            
      ,EXT_UTIL_PKG.F_TO_CHAR(INJECT_DURATN_FUL, 5, 0)  KEY5                                                            
  FROM PP_EXT_OWNER.CTSC_PHARMACOKINETICS                                                                               
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     PL                                               
C_PL_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_VITAL_SIGNS_CM                                                                                 
UNION ALL (                                                                                                             
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_TRANSFUSION_CM                                                                                 
)  )                                                                                                                    
)                                                                                                                       
                                                                                                                        
NCI5319                        THERADEX                       T300     PL                                               
C_PL_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,LAB_DT                                     KEY1                                                                       
 ,TIME                                     KEY2                                                                         
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LAB_DT||TIME         LINE_TEXT                                                                             
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LAB_DT, KEY2 TIME                                                               
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)     PATIENT                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)  KEY1                                                                     
      ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)    KEY2                                                                     
  FROM PP_EXT_OWNER.CTSC_VITAL_SIGNS                                                                                    
UNION ALL (                                                                                                             
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)     PATIENT                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)  KEY1                                                                     
      ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)    KEY2                                                                     
  FROM PP_EXT_OWNER.CTSC_TRANSFUSION                                                                                    
)  )                                                                                                                    
)                                                                                                                       
                                                                                                                        
NCI5319                        THERADEX                       T300     PL                                               
C_PL_PLCD                                                                                                               
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)         KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)||                                                                              
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(' ', 130)||                                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(FRESH_BLOOD_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR(STORED_BLOOD_FUL, 9, 3)||' '||                                                               
    EXT_UTIL_PKG.F_TO_CHAR(FRESH_RED_CELLS_FUL, 9, 3)||' '               LINE_TEXT                                      
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.LAB_DT)     COURSE_NUM   ----                                
 ,A.PATIENT_FUL                                                                                                         
 ,A.LAB_DT             SMPL_DT                                                                                          
 ,A.LAB_TIME           SMPL_TM                                                                                          
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.FRESH_BLOOD_FUL                                                                                                     
 ,A.FRESH_RED_CELLS_FUL                                                                                                 
 ,A.PACKED_WHITE_CELLS_FUL                                                                                              
 ,A.PLATELETS_FUL                                                                                                       
 ,A.STORED_BLOOD_FUL                                                                                                    
 ,A.STORED_RED_CELLS_FUL                                                                                                
 ,A.REG_INST_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,A.TIME_FUL                                                                                                            
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_TRANSFUSION A,                                                                                  
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PL                                               
C_PL_PLCD_CM                                                                                                            
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_TRANSFUSION_CM A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PL                                               
C_PL_PLTR                                                                                                               
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)         KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)||                                                                              
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(' ', 80)||                                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(FRESH_BLOOD_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR(STORED_BLOOD_FUL, 9, 3)||' '||                                                               
    EXT_UTIL_PKG.F_TO_CHAR(FRESH_RED_CELLS_FUL, 9, 3)||' '||                                                            
    EXT_UTIL_PKG.F_TO_CHAR(STORED_RED_CELLS_FUL, 9, 3)||' '||                                                           
    EXT_UTIL_PKG.F_TO_CHAR(PACKED_WHITE_CELLS_FUL, 9, 3)||' '||                                                         
    EXT_UTIL_PKG.F_TO_CHAR(PLATELETS_FUL, 9, 3)||' '                 LINE_TEXT                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.LAB_DT)     COURSE_NUM   ----                                
 ,A.PATIENT_FUL                                                                                                         
 ,A.LAB_DT             SMPL_DT                                                                                          
 ,A.LAB_TIME           SMPL_TM                                                                                          
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.FRESH_BLOOD_FUL                                                                                                     
 ,A.FRESH_RED_CELLS_FUL                                                                                                 
 ,A.PACKED_WHITE_CELLS_FUL                                                                                              
 ,A.PLATELETS_FUL                                                                                                       
 ,A.STORED_BLOOD_FUL                                                                                                    
 ,A.STORED_RED_CELLS_FUL                                                                                                
 ,A.REG_INST_FUL                                                                                                        
 ,A.TIME_FUL                                                                                                            
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_TRANSFUSION A,                                                                                  
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PL                                               
C_PL_PLTR_CM                                                                                                            
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_TRANSFUSION_CM A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PL                                               
C_PL_PLVS                                                                                                               
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)         KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)||                                                                              
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(PERF_ZUBROD_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR(HEIGHT_CM_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(WEIGHT_KG_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(TMP_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(PULSE_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(RESP_RATE_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(SYST_BP_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(DIAST_BP_FUL, 9, 3)||' '            LINE_TEXT                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.LAB_DT)     COURSE_NUM   ----                                
 ,A.PATIENT_FUL                                                                                                         
 ,A.LAB_DT_FUL             SMPL_DT                                                                                      
 ,A.LAB_TIME_FUL           SMPL_TM                                                                                      
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.BSA_FUL                                                                                                             
 ,A.HEIGHT_CM_FUL                                                                                                       
 ,A.NOTE_FUL                                                                                                            
 ,A.PERF_ST_KARN_FUL                                                                                                    
 ,DECODE(NVL(INSTR(A.PERF_ZUBROD_FUL, '='), 0), 0, SUBSTR(A.PERF_ZUBROD_FUL, 1, 3),                                     
               SUBSTR(A.PERF_ZUBROD_FUL, 1, INSTR(A.PERF_ZUBROD_FUL, '=') - 1)) PERF_ZUBROD_FUL                         
 ,A.WEIGHT_KG_FUL                                                                                                       
 ,A.DIAST_BP_FUL                                                                                                        
 ,A.PULSE_FUL                                                                                                           
 ,A.RESP_RATE_FUL                                                                                                       
 ,A.SYST_BP_FUL                                                                                                         
 ,A.TMP_FUL                                                                                                             
 ,A.REG_INST_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,A.TIME_FUL                                                                                                            
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_VITAL_SIGNS A,                                                                                  
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PL                                               
C_PL_PLVS_CM                                                                                                            
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_VITAL_SIGNS_CM A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PR                                               
C_PR                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL)         KEY1                                                             
 ,EXT_UTIL_PKG.F_VAR(RADTN_TYPE_FUL, 24)               KEY2                                                             
 ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)               KEY3                                                             
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL)||                                                                      
    EXT_UTIL_PKG.F_VAR(RADTN_TYPE_FUL, 24)||                                                                            
    EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)||                                                                            
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_DOSE_DT_FUL)||                                                                      
    EXT_UTIL_PKG.F_VAR(RT_SITE_FUL, 24)||                                                                               
    EXT_UTIL_PKG.F_VAR(RT_SCHED_FUL, 24)||                                                                              
    EXT_UTIL_PKG.F_VAR(RT_DOSE_FUL, 8)||                                                                                
    EXT_UTIL_PKG.F_VAR(DOSE_UOM_FUL, 8)||                                                                               
    EXT_UTIL_PKG.F_VAR(BEST_RESPS_FUL, 2)||                                                                             
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_THRPY_CODE_FUL, 10, 0)        LINE_TEXT                                                 
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'       COURSE_NUM   ----                                                                                         
 ,A.PATIENT_FUL                                                                                                         
 ,A.FRST_DOSE_DT_FUL                                                                                                    
 ,A.RADTN_TYPE_FUL                                                                                                      
 ,A.REPEATSN                                                                                                            
 ,A.LAST_DOSE_DT_FUL                                                                                                    
 ,NVL(A.RT_SITE_FUL, '*')     RT_SITE_FUL                                                                               
 ,NVL(A.RT_SCHED_FUL, '*')    RT_SCHED_FUL                                                                              
 ,NVL(A.RT_DOSE_FUL, '*')     RT_DOSE_FUL                                                                               
 ,NVL(A.DOSE_UOM_FUL, '*')    DOSE_UOM_FUL                                                                              
 ,NVL(A.BEST_RESPS_FUL, '*')  BEST_RESPS_FUL                                                                            
 ,A.CDUS_THRPY_CODE_FUL                                                                                                 
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_RAD_SUPP A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PR                                               
C_PR_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)  COURSE_NUM   ----                              
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_RAD_SUPP_CM A,                                                                            
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PR                                               
C_PR_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_PRIOR_RAD_SUPP_CM                                                                              
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     PR                                               
C_PR_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,FRST_DOSE_DT                                 KEY1                                                                     
 ,RADTN_TYPE                                         KEY2                                                               
 ,REPEATSN                                            KEY3                                                              
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||FRST_DOSE_DT||RADTN_TYPE||REPEATSN        LINE_TEXT                                                        
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 FRST_DOSE_DT, KEY2 RADTN_TYPE, KEY3 REPEATSN                                    
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)           PATIENT                                                            
      ,EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL)  KEY1                                                               
      ,EXT_UTIL_PKG.F_VAR(RADTN_TYPE_FUL, 24)        KEY2                                                               
      ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)        KEY3                                                               
  FROM PP_EXT_OWNER.CTSC_PRIOR_RAD_SUPP                                                                                 
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     PS                                               
C_PS                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SURG_DT_FUL)                 KEY1                                                          
 ,EXT_UTIL_PKG.F_VAR(PROC_FUL||' - '||ANAT_SITE_FUL, 24)  KEY2                                                          
 ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)                  KEY3                                                          
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SURG_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(PROC_FUL||' - '||ANAT_SITE_FUL, 24)||                                                            
    EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)||                                                                            
    EXT_UTIL_PKG.F_VAR(FIND_FUL, 24)||                                                                                  
    EXT_UTIL_PKG.F_VAR(ESID_DIS_EXTENT_FUL, 24)||                                                                       
    EXT_UTIL_PKG.F_VAR(CDUS_SURG_CD_FUL, 10)          LINE_TEXT                                                         
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'       COURSE_NUM   ----                                                                                         
 ,A.PATIENT_FUL                                                                                                         
 ,A.SURG_DT_FUL                                                                                                         
 ,A.PROC_FUL                                                                                                            
 ,A.ANAT_SITE_FUL                                                                                                       
 ,A.REPEATSN                                                                                                            
 ,NVL(A.FIND_FUL, '*')             FIND_FUL                                                                             
 ,NVL(A.RESID_DIS_EXTENT_FUL, '*')  ESID_DIS_EXTENT_FUL                                                                 
 ,NVL(A.CDUS_SURG_CD_FUL, '4058')  CDUS_SURG_CD_FUL                                                                     
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_SURG_SUPP A,                                                                              
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PS                                               
C_PS_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)  COURSE_NUM   ----                              
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_SURG_SUPP_CM A,                                                                           
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PS                                               
C_PS_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_PRIOR_SURG_SUPP_CM                                                                             
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     PS                                               
C_PS_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SURG_DT               KEY1                                                                                            
 ,PROC                  KEY2                                                                                            
 ,REPEATSN              KEY3                                                                                            
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SURG_DT|| PROC||REPEATSN          LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SURG_DT, KEY2 PROC, KEY3 REPEATSN                                               
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                     PATIENT                                                  
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SURG_DT_FUL)                 KEY1                                                     
      ,EXT_UTIL_PKG.F_VAR(PROC_FUL||' - '||ANAT_SITE_FUL, 24)  KEY2                                                     
      ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)                  KEY3                                                     
  FROM PP_EXT_OWNER.CTSC_PRIOR_SURG_SUPP                                                                                
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     PT                                               
C_PT                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL)       KEY1                                                               
 ,EXT_UTIL_PKG.F_VAR(AGT_NM_FUL, 24)                 KEY2                                                               
 ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)             KEY3                                                               
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL)||                                                                      
    EXT_UTIL_PKG.F_VAR(AGT_NM_FUL, 24)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)||                                                                            
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_DOSE_DT_FUL)||                                                                      
    EXT_UTIL_PKG.F_VAR(MED_SCHED_FUL, 24)||                                                                             
    EXT_UTIL_PKG.F_VAR(TOT_DOSE_FUL, 8)||                                                                               
    EXT_UTIL_PKG.F_VAR(AGENT_UOM_FUL, 8)||                                                                              
    EXT_UTIL_PKG.F_VAR(BEST_RESPS_FUL, 2)||                                                                             
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_THRPY_CODE_FUL, 10, 0)          LINE_TEXT                                               
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'              COURSE_NUM   ----                                                                                  
 ,A.PATIENT_FUL                                                                                                         
 ,A.FRST_DOSE_DT_FUL                                                                                                    
 ,A.AGT_NM_FUL                                                                                                          
 ,A.REPEATSN                                                                                                            
 ,A.LAST_DOSE_DT_FUL                                                                                                    
 ,NVL(A.MED_SCHED_FUL, '*')   MED_SCHED_FUL                                                                             
 ,NVL(A.TOT_DOSE_FUL, '*')    TOT_DOSE_FUL                                                                              
 ,NVL(A.AGENT_UOM_FUL, '*')   AGENT_UOM_FUL                                                                             
 ,NVL(A.BEST_RESPS_FUL, '*')  BEST_RESPS_FUL                                                                            
 ,A.CDUS_THRPY_CODE_FUL                                                                                                 
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_THRPY_SUPP A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
END                                                                                                                     
                                                                                                                        
NCI5319                        THERADEX                       T300     PT                                               
C_PT_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)  COURSE_NUM   ----                              
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_THRPY_SUPP_CM A,                                                                          
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     PT                                               
C_PT_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_PRIOR_THRPY_SUPP_CM                                                                            
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     PT                                               
C_PT_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,FRST_DOSE_DT                                 KEY1                                                                     
 ,AGT_NM                                             KEY2                                                               
 ,REPEATSN                                         KEY3                                                                 
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||FRST_DOSE_DT||AGT_NM||REPEATSN      LINE_TEXT                                                              
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 FRST_DOSE_DT, KEY2 AGT_NM, KEY3 REPEATSN                                        
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL) KEY1                                                                
      ,EXT_UTIL_PKG.F_VAR(AGT_NM_FUL, 24)           KEY2                                                                
      ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)       KEY3                                                                
  FROM PP_EXT_OWNER.CTSC_PRIOR_THRPY_SUPP                                                                               
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     RC                                               
C_LAB_OTH_RC                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
           EXT_UTIL_PKG.F_TO_CHAR(MCH_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(MCHC_FUL, 9, 3)||' '||                                                                
           EXT_UTIL_PKG.F_TO_CHAR(MCV_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(BLEED_TIME_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(CLOT_RETR_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(SEMI_QUANT_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(QUANT_FUL, 9, 3)||' '||                                                               
           EXT_UTIL_PKG.F_TO_CHAR(CLOT_TIME_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(FDP_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(FIBRINOGEN_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(THROMB_TIM_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(NUCL_RBCS_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(COMPLEMENT_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(COOMBS_TST_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(ANF_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(TOT_SER_PR_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(ALBUMIN_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(ALPHA1_FUL, 9, 3)||' '||                                                              
           EXT_UTIL_PKG.F_TO_CHAR(ALPHA2_FUL, 9, 3)||' '||                                                              
           EXT_UTIL_PKG.F_TO_CHAR(BETA_FUL, 9, 3)||' '||                                                                
           EXT_UTIL_PKG.F_TO_CHAR(GAMMA_FUL, 9, 3)||' '         LINE_TEXT                                               
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_RC A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
NCI5319                        THERADEX                       T300     RC                                               
C_LAB_OTH_RC_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     RC                                               
C_RC                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(MCH_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(MCHC_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(MCV_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(BLEED_TIME_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(CLOT_RETR_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(SEMI_QUANT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(QUANT_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(CLOT_TIME_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(FDP_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(FIBRINOGEN_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(THROMB_TIM_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(NUCL_RBCS_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(COMPLEMENT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_POS_NEG(COOMBS_TST_FUL, 9, 3)||' '||                                                         
    EXT_UTIL_PKG.F_TO_CHAR(ANF_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(TOT_SER_PR_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(ALBUMIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(ALPHA1_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(ALPHA2_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BETA_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(GAMMA_FUL, 9, 3)||' '             LINE_TEXT                                                  
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.MCH_FUL                                                                                                             
 ,A.MCHC_FUL                                                                                                            
 ,A.MCV_FUL                                                                                                             
 ,A.BLEED_TIME_FUL                                                                                                      
 ,A.CLOT_RETR_FUL                                                                                                       
 ,A.SEMI_QUANT_FUL                                                                                                      
 ,A.QUANT_FUL                                                                                                           
 ,A.CLOT_TIME_FUL                                                                                                       
 ,A.FDP_FUL                                                                                                             
 ,A.FIBRINOGEN_FUL                                                                                                      
 ,A.THROMB_TIM_FUL                                                                                                      
 ,A.NUCL_RBCS_FUL                                                                                                       
 ,A.COMPLEMENT_FUL                                                                                                      
 ,A.COOMBS_TST_FUL                                                                                                      
 ,A.ANF_FUL                                                                                                             
 ,A.TOT_SER_PR_FUL                                                                                                      
 ,A.ALBUMIN_FUL                                                                                                         
 ,A.ALPHA1_FUL                                                                                                          
 ,A.ALPHA2_FUL                                                                                                          
 ,A.BETA_FUL                                                                                                            
 ,A.GAMMA_FUL                                                                                                           
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_RC A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     RC                                               
C_RC_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_RC_CM A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     RC                                               
C_RC_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_LAB_RC_CM                                                                                      
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     RC                                               
C_RC_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_RC                                                                                         
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     RF                                               
C_LAB_OTH_RF                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(ACIDITY_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(PART_CO2_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(PARTIAL_O2_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(BICARB_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BASE_EXC_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(BASE_DEF_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(OXYGEN_SAT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(CARB_MONOX_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(METHEMOGLO_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(VITAL_CAP_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(EXP_VOL_1_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(MAX_CAP_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(RESID_VOL_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(TIDAL_VOL_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(FUN_RES_CP_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PULM_COMPL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(DIFF_CAPAC_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MAX_EXP_FL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MID_EXP_FL_FUL, 9, 3)||' '       LINE_TEXT                                                   
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_RF A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
NCI5319                        THERADEX                       T300     RF                                               
C_LAB_OTH_RF_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     RF                                               
C_RF                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(ACIDITY_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(PART_CO2_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(PARTIAL_O2_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(BICARB_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BASE_EXC_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(BASE_DEF_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(OXYGEN_SAT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(CARB_MONOX_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(METHEMOGLO_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(VITAL_CAP_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(EXP_VOL_1_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(MAX_CAP_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(RESID_VOL_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(TIDAL_VOL_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(FUN_RES_CP_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PULM_COMPL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(DIFF_CAPAC_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MAX_EXP_FL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MID_EXP_FL_FUL, 9, 3)||' '         LINE_TEXT                                                 
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.ACIDITY_FUL                                                                                                         
 ,A.PART_CO2_FUL                                                                                                        
 ,A.PARTIAL_O2_FUL                                                                                                      
 ,A.BICARB_FUL                                                                                                          
 ,A.BASE_EXC_FUL                                                                                                        
 ,A.BASE_DEF_FUL                                                                                                        
 ,A.OXYGEN_SAT_FUL                                                                                                      
 ,A.CARB_MONOX_FUL                                                                                                      
 ,A.METHEMOGLO_FUL                                                                                                      
 ,A.VITAL_CAP_FUL                                                                                                       
 ,A.EXP_VOL_1_FUL                                                                                                       
 ,A.MAX_CAP_FUL                                                                                                         
 ,A.RESID_VOL_FUL                                                                                                       
 ,A.TIDAL_VOL_FUL                                                                                                       
 ,A.FUN_RES_CP_FUL                                                                                                      
 ,A.PULM_COMPL_FUL                                                                                                      
 ,A.DIFF_CAPAC_FUL                                                                                                      
 ,A.MAX_EXP_FL_FUL                                                                                                      
 ,A.MID_EXP_FL_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_RF A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     RF                                               
C_RF_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_RF_CM A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     RF                                               
C_RF_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_LAB_RF_CM                                                                                      
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     RF                                               
C_RF_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_RF                                                                                         
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     SC                                               
C_LAB_OTH_SC                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(ALDOLASE_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(AMMONIA_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(COPPER_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(FERRITIN_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(HDL_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(INSULIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(IRON_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IRON_BIND_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(IRON_SAT_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(LDL_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(LIPASE_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(OSMOLALITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(ACID_PHOS_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(TRANSFERRI_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(TRIGLYC_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(T3_FUL, 9, 3)||' '||                                                                         
    EXT_UTIL_PKG.F_TO_CHAR(T4_FUL, 9, 3)||' '||                                                                         
    EXT_UTIL_PKG.F_TO_CHAR(TSH_FUL, 9, 3)||' '         LINE_TEXT                                                        
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_SC A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
NCI5319                        THERADEX                       T300     SC                                               
C_LAB_OTH_SC_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     SC                                               
C_SC                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(ALDOLASE_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(AMMONIA_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(COPPER_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(FERRITIN_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(HDL_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(INSULIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(IRON_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IRON_BIND_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(IRON_SAT_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(LDL_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(LIPASE_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(OSMOLALITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(ACID_PHOS_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(TRANSFERRI_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(TRIGLYC_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(T3_FUL, 9, 3)||' '||                                                                         
    EXT_UTIL_PKG.F_TO_CHAR(T4_FUL, 9, 3)||' '||                                                                         
    EXT_UTIL_PKG.F_TO_CHAR(TSH_FUL, 9, 3)||' '        LINE_TEXT                                                         
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.ALDOLASE_FUL                                                                                                        
 ,A.AMMONIA_FUL                                                                                                         
 ,A.CALCIUM_FUL                                                                                                         
 ,A.COPPER_FUL                                                                                                          
 ,A.FERRITIN_FUL                                                                                                        
 ,A.HDL_FUL                                                                                                             
 ,A.INSULIN_FUL                                                                                                         
 ,A.IRON_FUL                                                                                                            
 ,A.IRON_BIND_FUL                                                                                                       
 ,A.IRON_SAT_FUL                                                                                                        
 ,A.LDL_FUL                                                                                                             
 ,A.LIPASE_FUL                                                                                                          
 ,A.OSMOLALITY_FUL                                                                                                      
 ,A.ACID_PHOS_FUL                                                                                                       
 ,A.TRANSFERRI_FUL                                                                                                      
 ,A.TRIGLYC_FUL                                                                                                         
 ,A.T3_FUL                                                                                                              
 ,A.T4_FUL                                                                                                              
 ,A.TSH_FUL                                                                                                             
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_SC A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     SC                                               
C_SC_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_SC_CM A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     SC                                               
C_SC_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_LAB_SC_CM                                                                                      
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     SC                                               
C_SC_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_SC                                                                                         
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     SE                                               
C_LAB_OTH_SE                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(IG_A_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_D_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_E_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_G_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_M_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(MONOCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(POLYCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(KAPPA_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(LAMBDA_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BENCEJONES_FUL, 9, 3)||' '      LINE_TEXT                                                    
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_SE A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
NCI5319                        THERADEX                       T300     SE                                               
C_LAB_OTH_SE_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     SE                                               
C_SE                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(IG_A_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_D_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_E_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_G_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_M_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(MONOCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(POLYCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(KAPPA_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(LAMBDA_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BENCEJONES_FUL, 9, 3)||' '        LINE_TEXT                                                  
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.IG_A_FUL                                                                                                            
 ,A.IG_D_FUL                                                                                                            
 ,A.IG_E_FUL                                                                                                            
 ,A.IG_G_FUL                                                                                                            
 ,A.IG_M_FUL                                                                                                            
 ,A.MONOCLONAL_FUL                                                                                                      
 ,A.POLYCLONAL_FUL                                                                                                      
 ,A.KAPPA_FUL                                                                                                           
 ,A.LAMBDA_FUL                                                                                                          
 ,A.BENCEJONES_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_SE A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     SE                                               
C_SE_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_SE_CM A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     SE                                               
C_SE_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_LAB_SE_CM                                                                                      
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     SE                                               
C_SE_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_SE                                                                                         
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     SH                                               
C_SH                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)       KEY1                                                                
 ,''                                KEY2                                                                                
 ,''                                    KEY3                                                                            
 ,''                                    KEY4                                                                            
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_COLLCT_DT_FUL)||                                                                    
    EXT_UTIL_PKG.F_VAR(NCLD_NM_FUL1 , 8)||                                                                              
    EXT_UTIL_PKG.F_TO_CHAR(ALIQ_CNT_ML_FUL1, 8, 3)||                                                                    
    EXT_UTIL_PKG.F_VAR(AB_NM_FUL1 , 8)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(COR_ALIQ_CPM_FUL1, 9, 0)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(TOT_ADMIN_ML_FUL1, 8, 3)||                                                                   
    EXT_UTIL_PKG.F_VAR(NCLD_NM_FUL2 , 8)||                                                                              
    EXT_UTIL_PKG.F_TO_CHAR(ALIQ_CNT_ML_FUL2, 8, 3)||                                                                    
    EXT_UTIL_PKG.F_VAR(AB_NM_FUL2 , 8)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(COR_ALIQ_CPM_FUL2, 9, 0)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(TOT_ADMIN_ML_FUL2, 8, 3)        LINE_TEXT                                                    
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_COLLCT_DT_FUL)     COURSE_NUM   ----                    
 ,A.PATIENT_FUL                                                                                                         
 ,A.TRIAL_NUM_FUL                                                                                                       
 ,A.SMPL_COLLCT_DT_FUL                                                                                                  
 ,A.NCLD_NM_FUL1                                                                                                        
 ,A.ALIQ_CNT_ML_FUL1                                                                                                    
 ,A.AB_NM_FUL1                                                                                                          
 ,A.COR_ALIQ_CPM_FUL1                                                                                                   
 ,A.TOT_ADMIN_ML_FUL1                                                                                                   
 ,A.NCLD_NM_FUL2                                                                                                        
 ,A.ALIQ_CNT_ML_FUL2                                                                                                    
 ,A.AB_NM_FUL2                                                                                                          
 ,A.COR_ALIQ_CPM_FUL2                                                                                                   
 ,A.TOT_ADMIN_ML_FUL2                                                                                                   
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_SCINTIGRAPHY_HEADER A,                                                                          
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     SH                                               
C_SH_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,TRIAL_NUM                                 KEY1                                                                        
 ,''                                        KEY2                                                                        
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||TRIAL_NUM             LINE_TEXT                                                                            
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 TRIAL_NUM                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)  KEY1                                                                
  FROM PP_EXT_OWNER.CTSC_SCINTIGRAPHY_HEADER                                                                            
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     SR                                               
C_LAB_OTH_SR                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(PSA_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(CA125_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(CEA_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(CA19_9_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(CA15_3_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(CA27_29_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(AFP_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(HCG_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(HIV_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(HBS_AG_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(PREGNANT_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(STOOL_GUAIAC_FUL, 9, 3)||' '     LINE_TEXT                                                   
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_SR A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
NCI5319                        THERADEX                       T300     SR                                               
C_LAB_OTH_SR_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     SR                                               
C_SR                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(PSA_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(CA125_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(CEA_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(CA19_9_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(CA15_3_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(CA27_29_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(AFP_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(HCG_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR_POS_NEG(HIV_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR_POS_NEG(HBS_AG_FUL, 9, 3)||' '||                                                             
    EXT_UTIL_PKG.F_TO_CHAR_POS_NEG(PREGNANT_FUL, 9, 3)||' '||                                                           
    EXT_UTIL_PKG.F_TO_CHAR_POS_NEG(STOOL_GUAIAC_FUL, 9, 3)||' '        LINE_TEXT                                        
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.PSA_FUL                                                                                                             
 ,A.CA125_FUL                                                                                                           
 ,A.CEA_FUL                                                                                                             
 ,A.CA19_9_FUL                                                                                                          
 ,A.CA15_3_FUL                                                                                                          
 ,A.CA27_29_FUL                                                                                                         
 ,A.AFP_FUL                                                                                                             
 ,A.HCG_FUL                                                                                                             
 ,A.HIV_FUL                                                                                                             
 ,A.HBS_AG_FUL                                                                                                          
 ,A.PREGNANT_FUL                                                                                                        
 ,A.STOOL_GUAIAC_FUL                                                                                                    
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_SR A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     SR                                               
C_SR_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_SR_CM A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     SR                                               
C_SR_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_LAB_SR_CM                                                                                      
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     SR                                               
C_SR_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_SR                                                                                         
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     SS                                               
C_SS                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)        KEY1                                                               
 ,EXT_UTIL_PKG.F_TO_CHAR(SMPL_ID_NUM_FUL, 2, 0)      KEY2                                                               
 ,''                                    KEY3                                                                            

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
 ,''                                    KEY4                                                                            
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(SMPL_ID_NUM_FUL, 2, 0)||                                                                     
    EXT_UTIL_PKG.F_VAR(SRCE_ORG_FUL, 8)||                                                                               
    EXT_UTIL_PKG.F_VAR(SMPL_DESCR_FUL, 18)||                                                                            
    EXT_UTIL_PKG.F_VAR(TIS_CLAS_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_VAR(GAMMA_SCAN_POS_FUL, 1)||                                                                         
    EXT_UTIL_PKG.F_VAR(CT_POS_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SURG_BIOPSY_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_TO_CHAR(SMPL_WT_GRAM_FUL, 8, 3)||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(PCT_TUMOR_FUL, 8, 3)||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(CRCT_CPM_NUCLIDE_FUL1, 9, 0)||                                                               
    EXT_UTIL_PKG.F_TO_CHAR(CRCT_CPM_NUCLIDE_FUL2, 9, 0)          LINE_TEXT                                              
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_COLLCT_DT_FUL)     COURSE_NUM   ----                    
 ,A.PATIENT_FUL                                                                                                         
 ,A.TRIAL_NUM_FUL                                                                                                       
 ,A.SMPL_ID_NUM_FUL                                                                                                     
 ,A.SRCE_ORG_FUL                                                                                                        
 ,A.SMPL_DESCR_FUL                                                                                                      
 ,A.TIS_CLAS_FUL                                                                                                        
 ,A.GAMMA_SCAN_POS_FUL                                                                                                  
 ,A.CT_POS_FUL                                                                                                          
 ,A.SURG_BIOPSY_FUL                                                                                                     
 ,A.SMPL_WT_GRAM_FUL                                                                                                    
 ,A.PCT_TUMOR_FUL                                                                                                       
 ,A.CRCT_CPM_NUCLIDE_FUL1                                                                                               
 ,A.CRCT_CPM_NUCLIDE_FUL2                                                                                               
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_SCINTIGRAPHY A,                                                                                 
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     SS                                               
C_SS_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_SCINTIGRAPHY_CM A,                                                                              
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     SS                                               
C_SS_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_SCINTIGRAPHY_CM                                                                                
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     SS                                               
C_SS_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,TRIAL_NUM                                 KEY1                                                                        
 ,SMPL_ID_NUM                                       KEY2                                                                
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||TRIAL_NUM||SMPL_ID_NUM         LINE_TEXT                                                                   
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 TRIAL_NUM, KEY2 SMPL_ID_NUM                                                     
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)            PATIENT                                                           
      ,EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)    KEY1                                                              
      ,EXT_UTIL_PKG.F_TO_CHAR(SMPL_ID_NUM_FUL, 3, 0)  KEY2                                                              
  FROM PP_EXT_OWNER.CTSC_SCINTIGRAPHY                                                                                   
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     TF                                               
C_TF                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,''                                 KEY1                                                                               
 ,''                                    KEY2                                                                            
 ,''                                    KEY3                                                                            
 ,''                                    KEY4                                                                            
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_VAR(CHEMO_SING_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_CHEM_S_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(CHEMO_MULT_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_CHEM_M_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(CHEMO_UNKN_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_CHEM_U_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(HORMONAL_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_HORM_FUL)||                                                                         
    EXT_UTIL_PKG.F_VAR(SURGERY_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_SURG_FUL)||                                                                         
    EXT_UTIL_PKG.F_VAR(IMMUNOTHER_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_IMM_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(EXTENS_RAD_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_EX_RAD_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(LIM_RAD_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_LM_RAD_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(RAD_UNKN_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_UN_RAD_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(BONE_MARR_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_BMT_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(GENE_THRPY_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_GENE_FUL)||                                                                         
    EXT_UTIL_PKG.F_VAR(OTH_THRPY_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_OTHER_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(RESERVED_1_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_VAR(LST_RSRV_1_FUL, 8)||                                                                             
    EXT_UTIL_PKG.F_VAR(RESERVED_2_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_VAR(LST_RSRV_2_FUL, 8)||                                                                             
    EXT_UTIL_PKG.F_VAR(RESERVED_3_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_VAR(LST_RSRV_3_FUL, 8)||                                                                             
    EXT_UTIL_PKG.F_VAR(RESERVED_4_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_VAR(LST_RSRV_4_FUL, 8)          LINE_TEXT                                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'                           COURSE_NUM   ----                                                                     
 ,A.PATIENT_FUL                                                                                                         
 ,A.CHEMO_SING_FUL                                                                                                      
 ,A.LST_CHEM_S_FUL                                                                                                      
 ,A.CHEMO_MULT_FUL                                                                                                      
 ,A.LST_CHEM_M_FUL                                                                                                      
 ,A.CHEMO_UNKN_FUL                                                                                                      
 ,A.LST_CHEM_U_FUL                                                                                                      
 ,A.HORMONAL_FUL                                                                                                        
 ,A.LAST_HORM_FUL                                                                                                       
 ,A.SURGERY_FUL                                                                                                         
 ,A.LAST_SURG_FUL                                                                                                       
 ,A.IMMUNOTHER_FUL                                                                                                      
 ,A.LAST_IMM_FUL                                                                                                        
 ,A.EXTENS_RAD_FUL                                                                                                      
 ,A.LST_EX_RAD_FUL                                                                                                      
 ,A.LIM_RAD_FUL                                                                                                         
 ,A.LST_LM_RAD_FUL                                                                                                      
 ,A.RAD_UNKN_FUL                                                                                                        
 ,A.LST_UN_RAD_FUL                                                                                                      
 ,A.BONE_MARR_FUL                                                                                                       
 ,A.LAST_BMT_FUL                                                                                                        
 ,A.GENE_THRPY_FUL                                                                                                      
 ,A.LAST_GENE_FUL                                                                                                       
 ,A.OTH_THRPY_FUL                                                                                                       
 ,A.LAST_OTHER_FUL                                                                                                      
 ,NVL(A.RESERVED_1_FUL, '*')    RESERVED_1_FUL                                                                          
 ,A.LST_RSRV_1_FUL                                                                                                      
 ,'*'    RESERVED_2_FUL                                                                                                 
 ,' '   LST_RSRV_2_FUL                                                                                                  
 ,'*'    RESERVED_3_FUL                                                                                                 
 ,' '   LST_RSRV_3_FUL                                                                                                  
 ,'*'    RESERVED_4_FUL                                                                                                 
 ,' '   LST_RSRV_4_FUL                                                                                                  
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_TREAT_SUMM A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     TF                                               
C_TF_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_TREAT_SUMM_CM A,                                                                          
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     TF                                               
C_TF_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                                  KEY2                                                                      
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_PRIOR_TREAT_SUMM_CM                                                                            
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     TF                                               
C_TF_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,''                                 KEY1                                                                               
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT        LINE_TEXT                                                                                            
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT                                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12) PATIENT                                                                      
  FROM PP_EXT_OWNER.CTSC_PRIOR_TREAT_SUMM                                                                               
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     TX                                               
C_TX                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)                KEY1                                                   
 ,EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)                           KEY2                                                   
 ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8) KEY3                                                  
 ,RESOLV_DT_FUL                                   KEY4                                                                  
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)||                                                                   
    EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)||                                                                              
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8)||                                                   
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_CTC_CD_FUL, 10, 0)||                                                                    
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(RESOLV_DT_FUL), 8)||                                                  
    EXT_UTIL_PKG.F_VAR(AER_IND_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(CTC_GRADE_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_VAR(ATTRIBN_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_VAR(DOSE_LIMT_TOX_IND_FUL, 1)||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(AE_SERIOUS_FUL, 2, 0)||                                                                      
    EXT_UTIL_PKG.F_VAR(AE_ACTION_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_VAR(AE_THRPY_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_VAR(AE_OUTCOME_FUL, 1)      LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'   '                       COURSE_NUM   ----                                                                         
 ,A.PATIENT_FUL                                                                                                         
 ,''                                 COURSE_START_DT_FUL                                                                
 ,NVL(A.AE_DESCR_FUL, SUBSTR(A.CTC_TERM_FUL, 1, 33))   AE_DESCR_FUL                                                     
 ,A.ONSET_DT_FUL                                                                                                        
 ,A.ONSET_DT                                                                                                            
 ,A.CDUS_CTC_CD_FUL                                                                                                     
 ,A.RESOLV_DT_FUL                                                                                                       
 ,A.RESOLV_DT                                                                                                           
 ,A.AER_IND_FUL                                                                                                         
 ,SUBSTR(A.CTC_GRADE_FUL, 1, 1)      CTC_GRADE_FUL                                                                      
 ,A.ATTRIBN_FUL                                                                                                         
 ,A.DOSE_LIMT_TOX_IND_FUL                                                                                               
 ,SUBSTR(A.AE_SER_FUL, 1, 1)   AE_SERIOUS_FUL                                                                           
 ,A.AE_ACTION_FUL                                                                                                       
 ,A.AE_THRPY_FUL                                                                                                        
 ,A.AE_OUTCOME_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_ADVERSE_EVENTS A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
ORDER BY PATIENT, AE_DESCR_FUL, COURSE_START_DT_FUL, ONSET_DT_FUL                                                       
                                                                                                                        
NCI5319                        THERADEX                       T300     TX                                               
C_TX_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_ADVERSE_EVENTS_CM A,                                                                            
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     TX                                               
C_TX_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                                  KEY2                                                                      
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_ADVERSE_EVENTS_CM                                                                              
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     TX                                               
C_TX_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,COURSE_START_DT                            KEY1                                                                       
 ,TOXICITY                                   KEY2                                                                       
 ,ONSET_DT                                   KEY3                                                                       
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||COURSE_START_DT||TOXICITY||ONSET_DT            LINE_TEXT                                                   
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 COURSE_START_DT, KEY2 TOXICITY, KEY3 ONSET_DT                                   
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 COURSE_START_DT, KEY2 TOXICITY, KEY3 ONSET_DT                          
  FROM CT_EXT_TEMP                                                                                                      
 WHERE PROTOCOL = :P_STUDY)  )                                                                                          
                                                                                                                        
NCI5319                        THERADEX                       T300     TX                                               
C_TX_TEMP                                                                                                               
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)                KEY1                                                   
 ,EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)                           KEY2                                                   
 ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8) KEY3                                                  
 ,RESOLV_DT_FUL                                  KEY4                                                                   
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)||                                                                   
    EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)||                                                                              
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8)||                                                   
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_CTC_CD_FUL, 10, 0)||                                                                    
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(RESOLV_DT_FUL), 8)||                                                  
    EXT_UTIL_PKG.F_VAR(AER_IND_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(CTC_GRADE_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_VAR(ATTRIBN_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_VAR(DOSE_LIMT_TOX_IND_FUL, 1)||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(AE_SERIOUS_FUL, 2, 0)||                                                                      
    EXT_UTIL_PKG.F_VAR(AE_ACTION_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_VAR(AE_THRPY_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_VAR(AE_OUTCOME_FUL, 1)      LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'   '                       COURSE_NUM   ----                                                                         
 ,A.PATIENT_FUL                                                                                                         
 ,''                                 COURSE_START_DT_FUL                                                                
 ,NVL(A.AE_DESCR_FUL, SUBSTR(A.CTC_TERM_FUL, 1, 33))   AE_DESCR_FUL                                                     
 ,A.ONSET_DT_FUL                                                                                                        
 ,A.ONSET_DT                                                                                                            
 ,A.CDUS_CTC_CD_FUL                                                                                                     
 ,A.RESOLV_DT_FUL                                                                                                       
 ,A.RESOLV_DT                                                                                                           
 ,A.AER_IND_FUL                                                                                                         
 ,SUBSTR(A.CTC_GRADE_FUL, 1, 1)      CTC_GRADE_FUL                                                                      
 ,A.ATTRIBN_FUL                                                                                                         
 ,A.DOSE_LIMT_TOX_IND_FUL                                                                                               
 ,SUBSTR(A.AE_SER_FUL, 1, 1)   AE_SERIOUS_FUL                                                                           
 ,A.AE_ACTION_FUL                                                                                                       
 ,A.AE_THRPY_FUL                                                                                                        
 ,A.AE_OUTCOME_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_ADVERSE_EVENTS A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
ORDER BY PATIENT, AE_DESCR_FUL, COURSE_START_DT_FUL, ONSET_DT_FUL                                                       
                                                                                                                        
NCI5319                        THERADEX                       T300     UE                                               
C_LAB_OTH_UE                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(IG_A_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_D_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_E_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_G_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_M_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(MONOCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(POLYCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(KAPPA_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(LAMBDA_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BENCEJONES_FUL, 9, 3)||' '       LINE_TEXT                                                   
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_UE A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
NCI5319                        THERADEX                       T300     UE                                               
C_LAB_OTH_UE_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     UE                                               
C_UE                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(IG_A_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_D_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_E_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_G_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_M_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(MONOCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(POLYCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(KAPPA_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(LAMBDA_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BENCEJONES_FUL, 9, 3)||' '        LINE_TEXT                                                  
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.IG_A_FUL                                                                                                            
 ,A.IG_D_FUL                                                                                                            
 ,A.IG_E_FUL                                                                                                            
 ,A.IG_G_FUL                                                                                                            
 ,A.IG_M_FUL                                                                                                            
 ,A.MONOCLONAL_FUL                                                                                                      
 ,A.POLYCLONAL_FUL                                                                                                      
 ,A.KAPPA_FUL                                                                                                           
 ,A.LAMBDA_FUL                                                                                                          
 ,A.BENCEJONES_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_UE A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     UE                                               
C_UE_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_UE_CM A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     UE                                               
C_UE_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_LAB_UE_CM                                                                                      
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     UE                                               
C_UE_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_UE                                                                                         
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     UL                                               
C_LAB_OTH_UL                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(DCMDATE)               KEY1                                                                
 ,EXT_UTIL_PKG.F_FORMAT_TIME(DCMTIME)               KEY2                                                                
 ,EXT_UTIL_PKG.F_VAR(LAB_TEST, 8)                   KEY3                                                                
 ,'        '                                       KEY4                                                                 
 ,''                                               KEY5                                                                 
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
           EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                     
           EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                        
           EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                        
           EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                       
           A_FILLER||                                                                                                   
           DEL_FLAG||                                                                                                   
           DEL_DATE||                                                                                                   
           EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                              
           EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                             
           ENTRY_PASS||                                                                                                 
           TOUCH_DATE||                                                                                                 
           TOUCH_TIMER||                                                                                                
           COURSE_NUM||               ------------                                                                      
           EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                        
           EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                        
           EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                        
           EXT_UTIL_PKG.F_VAR(LAB_TEST, 8)||                                                                            
           EXT_UTIL_PKG.F_VAR(BODY_SITE, 8)||                                                                           
           LAB_GROUP||                                                                                                  
           LAB_CODE||                                                                                                   
           EXT_UTIL_PKG.F_VAR_OTH_UL_NA(LAB_RANGE_IND, 1)||                                                             
           EXT_UTIL_PKG.F_OTH_UL_VAL_STR(LVALUE_FUL)||                                                                  
           EXT_UTIL_PKG.F_VAR(SIGNIFICANCE_FLAG_FUL, 1)          LINE_TEXT                                              
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             PROTOCOL                                                          
 ,S.NAME                                       INST_ID                                                                  
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.DCMDATE)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.DCMDATE             SMPL_DT                                                                                         
 ,A.DCMTIME             SMPL_TM                                                                                         
 ,'        '            BODY_SITE                                                                                       
 ,A.LPARM_FUL           LAB_TEST                                                                                        
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_UL A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY))                                                          
                                                                                                                        
NCI5319                        THERADEX                       T300     UL                                               
C_LAB_OTH_UL_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                       PATIENT                                                                                 
 ,LAB_DT                        KEY1                                                                                    
 ,LAB_TIME                      KEY2                                                                                    
 ,LAB_TEST                      KEY3                                                                                    
 ,BD_SITE                       KEY4                                                                                    
 ,''                            KEY5                                                                                    
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT)||                                                                                
    EXT_UTIL_PKG.F_FORMAT_TIME(LAB_TIME)||                                                                              
    EXT_UTIL_PKG.F_VAR(LAB_TEST, 8)||                                                                                   
    EXT_UTIL_PKG.F_VAR(BD_SITE, 8)         LINE_TEXT                                                                    
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 LAB_DT, KEY2 LAB_TIME, KEY3 LAB_TEST, KEY4 BD_SITE                     
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 LAB_DT, KEY2 LAB_TIME, KEY3 LAB_TEST, KEY4 BD_SITE            
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     UL                                               
C_UL                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)           KEY1                                                                 
 ,EXT_UTIL_PKG.F_FORMAT_TIME(LAB_TIME_FUL)         KEY2                                                                 
 ,EXT_UTIL_PKG.F_VAR(TEST_NAME_FUL, 8)             KEY3                                                                 
 ,EXT_UTIL_PKG.F_VAR(BD_SITE_FUL, 8)               KEY4                                                                 
 ,''                                         KEY5                                                                       
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)||                                                                            
    EXT_UTIL_PKG.F_FORMAT_TIME(LAB_TIME_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(TEST_NAME_FUL, 8)||                                                                              
    EXT_UTIL_PKG.F_VAR(BD_SITE_FUL, 8)||                                                                                
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(NORM_ABNORM_IND_FUL, 1)||                                                                        
    EXT_UTIL_PKG.F_VAR(RSLT_TYPE, 1)||                                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(NUM_VALUE_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_VAR(LIT_VALUE_FUL, 128)||' '           LINE_TEXT                                                     
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.LAB_DT)     COURSE_NUM   ----                                
 ,A.PATIENT_FUL                                                                                                         
 ,A.LAB_DT_FUL                                                                                                          
 ,A.LAB_TIME_FUL                                                                                                        
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.LPARM_FUL             TEST_NAME_FUL                                                                                 
 ,A.BD_SITE_FUL                                                                                                         
 ,A.NORM_ABNORM_IND_FUL                                                                                                 
 ,A.RSLT_TYPE                                                                                                           
 ,DECODE(A.RSLT_FUL, 'N', A.RSLT_FUL, NULL)    NUM_VALUE_FUL                                                            
 ,DECODE(A.RSLT_FUL, 'L', A.RSLT_FUL, NULL)    LIT_VALUE_FUL                                                            
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_UL A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     UL                                               
C_UL_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_UL_CM A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     UL                                               
C_UL_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_LAB_UL_CM                                                                                      
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     UL                                               
C_UL_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,LAB_DT                       KEY1                                                                                     
 ,LAB_TIME                     KEY2                                                                                     
 ,LAB_TEST                     KEY3                                                                                     
 ,BD_SITE                      KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LAB_DT||LAB_TIME||LAB_TEST||BD_SITE         LINE_TEXT                                                      
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LAB_DT, KEY2 LAB_TIME, KEY3 LAB_TEST, KEY4 BD_SITE                              
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)       PATIENT                                                                
      ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)    KEY1                                                                   
      ,EXT_UTIL_PKG.F_FORMAT_TIME(LAB_TIME_FUL)  KEY2                                                                   
      ,EXT_UTIL_PKG.F_VAR(LPARM_FUL, 8)          KEY3                                                                   
      ,EXT_UTIL_PKG.F_VAR(BD_SITE_FUL, 8)        KEY4                                                                   
  FROM PP_EXT_OWNER.CTSC_LAB_UL                                                                                         
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     US                                               
C_LAB_OTH_US                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(CREAT_CLR_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(HYDROGEN_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(SP_GRAVITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(WBCS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(RBCS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(GLUCOSE_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(PROTEIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(KETONES_FUL, 9, 3)||' '||                                                              
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(BILE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(URIN_CREAT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(VOLUME_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(COLL_PER_FUL, 9, 3)||' '      LINE_TEXT                                                      
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_US A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
NCI5319                        THERADEX                       T300     US                                               
C_LAB_OTH_US_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     US                                               
C_US                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(CREAT_CLR_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(HYDROGEN_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(SP_GRAVITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(WBCS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(RBCS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(GLUCOSE_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(PROTEIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(KETONES_FUL, 9, 3)||' '||                                                              
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(BILE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(URIN_CREAT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(VOLUME_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(COLL_PER_FUL, 9, 3)||' '       LINE_TEXT                                                     
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.CREAT_CLR_FUL                                                                                                       
 ,A.HYDROGEN_FUL                                                                                                        
 ,A.SP_GRAVITY_FUL                                                                                                      
 ,A.WBCS_FUL                                                                                                            
 ,A.RBCS_FUL                                                                                                            
 ,A.GLUCOSE_FUL                                                                                                         
 ,A.PROTEIN_FUL                                                                                                         
 ,A.KETONES_FUL                                                                                                         
 ,A.BILE_FUL                                                                                                            
 ,A.URIN_CREAT_FUL                                                                                                      
 ,A.VOLUME_FUL                                                                                                          
 ,A.COLL_PER_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_US A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     US                                               
C_US_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_US_CM A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
END                                                                                                                     
                                                                                                                        
NCI5319                        THERADEX                       T300     US                                               
C_US_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_LAB_US_CM                                                                                      
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     US                                               
C_US_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_US                                                                                         
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     UX                                               
C_UX                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                 PATIENT                                                           
 ,EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)        KEY1                                                                   
 ,EXT_UTIL_PKG.F_FORMAT_TIME(FRST_TIME_FUL)      KEY2                                                                   
 ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)          KEY3                                                                   
 ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)         KEY4                                                                   
 ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL1)          KEY5                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_FORMAT_TIME(FRST_TIME_FUL)||                                                                         
    EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)||                                                                             

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
    EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)||                                                                            
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL2)||                                                                             
    EXT_UTIL_PKG.F_TO_CHAR(URINE_VOLUME_ML_FUL ,4, 0)||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(P_VOID_AMT_FUL, 8, 3)||                                                                      
    EXT_UTIL_PKG.F_VAR(P_VOID_AMT_UOM_FUL, 10)||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(P_DRUG_ASSAY_FUL1, 8, 3)||                                                                   
    EXT_UTIL_PKG.F_VAR(P_DRUG_ASSAY_UOM_FUL1, 10)||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(P_DRUG_ASSAY_FUL2, 8, 3)||                                                                   
    EXT_UTIL_PKG.F_VAR(P_DRUG_ASSAY_UOM_FUL2, 10)||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(P_VOID_AMT_FUL, 8, 3)||                                                                      
    EXT_UTIL_PKG.F_VAR(P_VOID_AMT_UOM_FUL, 10)||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(MTBLIT_ASSAY_FUL1, 8, 3)||                                                                   
    EXT_UTIL_PKG.F_VAR(MTBLIT_ASSAY_UOM_FUL1, 10)||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(MTBLIT_ASSAY_FUL2, 8, 3)||                                                                   
    EXT_UTIL_PKG.F_VAR(MTBLIT_ASSAY_UOM_FUL2, 10)||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(MTBLIT_MEAN_CONC_FUL, 8, 3)||                                                                
    EXT_UTIL_PKG.F_VAR(MTBLIT_MEAN_CONC_UOM_FUL, 10)||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(VOID_MTBLIT_AMT_FUL, 8, 3)||                                                                 
    EXT_UTIL_PKG.F_VAR(VOID_MTBLIT_AMT_UOM_FUL, 10)       LINE_TEXT                                                     
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.DOSE_DT_FUL)     COURSE_NUM   ----                           
 ,A.PATIENT_FUL                                                                                                         
 ,A.DOSE_DT_FUL                                                                                                         
 ,A.FRST_TIME_FUL                                                                                                       
 ,A.CTMS_AGENT_FUL                                                                                                      
 ,A.LAB_DT_FUL                                                                                                          
 ,A.START_TIME_FUL                                                                                                      
 ,A.END_TIME_FUL                                                                                                        
 ,A.TIME_FUL1                                                                                                           
 ,A.TIME_FUL2                                                                                                           
 ,A.URINE_VOLUME_ML_FUL                                                                                                 
 ,A.MTBLIT_ASSAY_FUL1                                                                                                   
 ,A.MTBLIT_ASSAY_UOM_FUL1                                                                                               
 ,A.MTBLIT_ASSAY_FUL2                                                                                                   
 ,A.MTBLIT_ASSAY_UOM_FUL2                                                                                               
 ,A.MTBLIT_MEAN_CONC_FUL                                                                                                
 ,A.MTBLIT_MEAN_CONC_UOM_FUL                                                                                            
 ,A.P_VOID_AMT_FUL                                                                                                      
 ,A.P_VOID_AMT_UOM_FUL                                                                                                  
 ,A.P_DRUG_ASSAY_FUL1                                                                                                   
 ,A.P_DRUG_ASSAY_UOM_FUL1                                                                                               
 ,A.P_DRUG_ASSAY_FUL2                                                                                                   
 ,A.P_DRUG_ASSAY_UOM_FUL2                                                                                               
 ,A.VOID_MTBLIT_AMT_FUL                                                                                                 
 ,A.VOID_MTBLIT_AMT_UOM_FUL                                                                                             
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_URINARY_EXCR A,                                                                                 
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     UX                                               
C_UX_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.TYP_CD_FUL                                                                                                          
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_URINARY_EXCR_CM A,                                                                              
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     UX                                               
C_UX_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_URINARY_EXCR_CM                                                                                
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     UX                                               
C_UX_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,DOSE_DT                                 KEY1                                                                          
 ,FRST_TIME                                         KEY2                                                                
 ,CTMS_AGENT                                          KEY3                                                              
 ,LAB_DT                                         KEY4                                                                   
 ,TIME1                                          KEY5                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||DOSE_DT||FRST_TIME||CTMS_AGENT||LAB_DT||TIME1          LINE_TEXT                                           
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 DOSE_DT, KEY2 FRST_TIME, KEY3 CTMS_AGENT, KEY4 LAB_DT, KEY5 TIME1               
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)        PATIENT                                                               
      ,EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)    KEY1                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_TIME(FRST_TIME_FUL)  KEY2                                                                  
      ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)      KEY3                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)     KEY4                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL1)      KEY5                                                                  
  FROM PP_EXT_OWNER.CTSC_URINARY_EXCR                                                                                   
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     XT                                               
C_XT                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0)       KEY1                                                               
 ,EXT_UTIL_PKG.F_FORMAT_DATE(EVAL_DT_FUL)            KEY2                                                               
 ,''                                    KEY3                                                                            
 ,''                                    KEY4                                                                            
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0)||                                                                      
    EXT_UTIL_PKG.F_FORMAT_DATE(EVAL_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(MEASUREMENT_MTHD_FUL, 12)||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(MEASUREMENT_X_FUL, 7, 2)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(MEASUREMENT_Y_FUL, 7, 2)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(MEASUREMENT_Z_FUL, 7, 2)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(EVAL_NUM_FUL, 2, 0)||                                                                        
    EXT_UTIL_PKG.F_VAR(EVAL_CD_FUL, 1)         LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.EVAL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.LESION_NUM_FUL                                                                                                      
 ,A.EVAL_DT_FUL                                                                                                         
 ,A.MEASUREMENT_MTHD_FUL                                                                                                
 ,A.MEASUREMENT_X_FUL                                                                                                   
 ,A.MEASUREMENT_Y_FUL                                                                                                   
 ,A.MEASUREMENT_Z_FUL                                                                                                   
 ,A.EVAL_NUM_FUL                                                                                                        
 ,A.EVAL_CD_FUL                                            ---------------                                              
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_EXT_OF_DISEASE A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
END                                                                                                                     
                                                                                                                        
NCI5319                        THERADEX                       T300     XT                                               
C_XT_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)||                                                                                 
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_EXT_OF_DISEASE_CM A,                                                                            
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
NCI5319                        THERADEX                       T300     XT                                               
C_XT_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                                 KEY1                                                                          
 ,:P_FILE_ID                          KEY2                                                                              
 ,''                                              KEY3                                                                  
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_EXT_OF_DISEASE_CM                                                                              
)  )                                                                                                                    
                                                                                                                        
NCI5319                        THERADEX                       T300     XT                                               
C_XT_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,LESION_NUM                          KEY1                                                                              
 ,EVAL_DT                             KEY2                                                                              
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LESION_NUM||EVAL_DT       LINE_TEXT                                                                        
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LESION_NUM, KEY2 EVAL_DT                                                        
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)           PATIENT                                                            
      ,EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0)  KEY1                                                               
      ,EXT_UTIL_PKG.F_FORMAT_DATE(EVAL_DT_FUL)       KEY2                                                               
  FROM PP_EXT_OWNER.CTSC_EXT_OF_DISEASE                                                                                 
)  )                                                                                                                    
END                                                                                                                     
                                                                                                                        
THER_STD                       CDUS                           C300     ADVERSE_EVENTS                                   
C_ADVERSE_EVENTS                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                    FILE_ID                                                                 
 ,:P_VERSION                                    VERSION                                                                 
 ,:P_CURRENT_EXT_DATE                           EXTRACTED                                                               
 ,DECODE('1', NULL, 0)                          RECEIVED_DCM_ID                                                         
 ,DECODE('1', NULL, SYSDATE)                    RECEIVED_DCM_ENTRY_TS                                                   
 ,DOCNUM                                        DOCNUM                                                                  
 ,''                                            DEL_FLAG                                                                
 ,STUDY                                         PROTOCOL                                                                
 ,PT                                            PT                                                                      
 ,PATIENT_FUL                                   PATIENT                                                                 
 ,NULL    KEY1                                                                                                          
 ,NULL    KEY2                                                                                                          
 ,NULL    KEY3                                                                                                          
 ,NULL    KEY4                                                                                                          
 ,NULL    KEY5                                                                                                          
 ,'"'||:P_FILE_ID||'",'||                                                                                               
    '"'||SUBSTR(STUDY, 1, 35)||'",'||                                                                                   
    '"'||SUBSTR(PATIENT_FUL, 1, 20)||'",'||                                                                             
    EXT_UTIL_PKG.F_TO_CHAR_CDUS(CI_COURS_NUM, 6, 0)||','||                                                              
    EXT_UTIL_PKG.F_TO_CHAR_CDUS(CDUS_CTC_CD_FUL, 10, 0)||','||                                                          
    EXT_UTIL_PKG.F_TO_CHAR_CDUS(SUBSTR(CTC_GRADE_FUL, 1, 1), 1, 0)||','||                                               
    '"'||SUBSTR(AE_DESCR_FUL, 1, 100)||'",'||                                                                           
    EXT_UTIL_PKG.F_TO_CHAR_CDUS(SUBSTR(ATTRIBN_FUL, 1, 1), 1, 0)||','||                                                 
    '"'||SUBSTR(AER_IND_FUL, 1, 1)||'"'       LINE_TEXT                                                                 
FROM (                                                                                                                  
SELECT A.*                                                                                                              
      ,B.COURS_NUM CI_COURS_NUM                                                                                         
  FROM PP_EXT_OWNER.CTSC_ADVERSE_EVENTS A,                                                                              
       PP_EXT_OWNER.CTSC_CINI B                                                                                         
 WHERE B.STUDY = A.STUDY                                                                                                
   AND B.PT = A.PT                                                                                                      
   AND B.START_DT >= NVL(EXT_UTIL_PKG.F_LAST_COURSE_START_DT(B.STUDY, B.PT, A.ONSET_DT, 'PP_EXT_OWNER'), '19000101')    
   AND B.START_DT < NVL(RPAD(A.RESOLV_DT, 8, '0'), TO_CHAR(SYSDATE, 'RRRRMMDD'))                                        
)                                                                                                                       
                                                                                                                        
THER_STD                       CDUS                           C300     BASELINE_ABNORMALITIES                           
C_BASELINE_ABNORMALITIES                                                                                                
select                                                                                                                  
  :P_FILE_ID                                    FILE_ID                                                                 
 ,:P_VERSION                                    VERSION                                                                 
 ,:P_CURRENT_EXT_DATE                           EXTRACTED                                                               
 ,DECODE('1', NULL, 0)                          RECEIVED_DCM_ID                                                         
 ,DECODE('1', NULL, SYSDATE)                    RECEIVED_DCM_ENTRY_TS                                                   
 ,DOCNUM                                        DOCNUM                                                                  
 ,''                                            DEL_FLAG                                                                
 ,STUDY                                         PROTOCOL                                                                
 ,PT                                            PT                                                                      
 ,PATIENT_FUL                                   PATIENT                                                                 
 ,NULL    KEY1                                                                                                          
 ,NULL    KEY2                                                                                                          
 ,NULL    KEY3                                                                                                          
 ,NULL    KEY4                                                                                                          
 ,NULL    KEY5                                                                                                          
 ,'"'||:P_FILE_ID||'",'||                                                                                               
    '"'||SUBSTR(STUDY, 1, 35)||'",'||                                                                                   
    '"'||SUBSTR(PATIENT_FUL, 1, 20)||'",'||                                                                             
    EXT_UTIL_PKG.F_TO_CHAR_CDUS(CDUS_CTC_CD_FUL, 10, 0)||','||                                                          
    EXT_UTIL_PKG.F_TO_CHAR_CDUS(SUBSTR(CTC_GRADE_FUL, 1, 1), 1, 0)||','||                                               
    '"'||SUBSTR(AE_DESCR_FUL, 1, 100)||'"'       LINE_TEXT                                                              
FROM PP_EXT_OWNER.CTSC_BASE_SYMP                                                                                        
                                                                                                                        
THER_STD                       CDUS                           C300     COURSE_AGENTS                                    
C_COURSE_AGENTS                                                                                                         
select                                                                                                                  
  :P_FILE_ID                                    FILE_ID                                                                 
 ,:P_VERSION                                    VERSION                                                                 
 ,:P_CURRENT_EXT_DATE                           EXTRACTED                                                               
 ,DECODE('1', NULL, 0)                          RECEIVED_DCM_ID                                                         
 ,DECODE('1', NULL, SYSDATE)                    RECEIVED_DCM_ENTRY_TS                                                   
 ,DOCNUM                                        DOCNUM                                                                  
 ,''                                            DEL_FLAG                                                                
 ,STUDY                                         PROTOCOL                                                                
 ,PT                                            PT                                                                      
 ,PATIENT_FUL                                   PATIENT                                                                 
 ,NULL    KEY1                                                                                                          
 ,NULL    KEY2                                                                                                          
 ,NULL    KEY3                                                                                                          
 ,NULL    KEY4                                                                                                          
 ,NULL    KEY5                                                                                                          
 ,'"'||:P_FILE_ID||'",'||                                                                                               
    '"'||SUBSTR(STUDY, 1, 35)||'",'||                                                                                   
    '"'||SUBSTR(PATIENT_FUL, 1, 20)||'",'||                                                                             
    EXT_UTIL_PKG.F_TO_CHAR_CDUS(CI_COURS_NUM, 6, 0)||','||                                                              
    '"'||SUBSTR(CTMS_AGENT_FUL,1, 8)||'",'||                                                                            
    '"'||SUBSTR(PREV_DOSE_CHANGE_FUL, 1, 1)||'",'||                                                                     
    EXT_UTIL_PKG.F_VAR(ACTL_DOSE_FUL, 20)||','||                                                                        
    '"'||SUBSTR(ACTL_DOSE_UOM_FUL, 1, 12)||'"'       LINE_TEXT                                                          
FROM (                                                                                                                  
 SELECT A.*                                                                                                             
       ,B.PREV_DOSE_CHANGE_FUL                                                                                          
       ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, 'PP_EXT_OWNER', A.PT, A.START_DT) CI_COURS_NUM                               
   FROM PP_EXT_OWNER.CTSC_STUDY_DRUG_ADMIN A,                                                                           
        PP_EXT_OWNER.CTSC_COURSE_ASSESS B                                                                               
  WHERE A.STUDY   = B.STUDY (+)                                                                                         
    AND A.PT      = B.PT (+)                                                                                            
)                                                                                                                       
                                                                                                                        
THER_STD                       CDUS                           C300     PATIENTS                                         
C_PATIENTS                                                                                                              
select                                                                                                                  
  :P_FILE_ID                                    FILE_ID                                                                 
 ,:P_VERSION                                    VERSION                                                                 
 ,:P_CURRENT_EXT_DATE                           EXTRACTED                                                               
 ,DECODE('1', NULL, 0)                          RECEIVED_DCM_ID                                                         
 ,DECODE('1', NULL, SYSDATE)                    RECEIVED_DCM_ENTRY_TS                                                   
 ,DOCNUM                                        DOCNUM                                                                  
 ,''                                            DEL_FLAG                                                                
 ,STUDY                                         PROTOCOL                                                                
 ,PT                                            PT                                                                      
 ,PATIENT_FUL                                   PATIENT                                                                 
 ,NULL    KEY1                                                                                                          
 ,NULL    KEY2                                                                                                          
 ,NULL    KEY3                                                                                                          
 ,NULL    KEY4                                                                                                          
 ,NULL    KEY5                                                                                                          
 ,'"'||:P_FILE_ID||'",'||                                                                                               
    '"'||SUBSTR(STUDY, 1, 35)||'",'||                                                                                   
    '"'||SUBSTR(PATIENT_FUL, 1, 20)||'",'||                                                                             
    '"'||SUBSTR(PST_CD_FUL, 1, 10)||'",'||                                                                              
    '"'||SUBSTR(CNTRY_CD_FUL, 1, 2)||'",'||                                                                             
    '"'||EXT_UTIL_PKG.F_FORMAT_DATE(PT_DOB_FUL)||'",'||                                                                 
    '"'||SUBSTR(GENDER_CODE, 1, 1)||'",'||                                                                              
    '"'||SUBSTR(DR_ETHNIC_CATEGORIES_FUL, 1, 1)||'",'||                                                                 
    '"'||SUBSTR(PYMT_MTHD_FUL, 1, 2)||'",'||                                                                            
    '"'||EXT_UTIL_PKG.F_FORMAT_DATE(REG_DT_FUL)||'",'||                                                                 
    '"'||SUBSTR(REG_GRP_FUL, 1, 6)||'",'||                                                                              
    '"'||SUBSTR(REG_INST_FUL, 1, 6)||'",'||                                                                             
    '"'||SUBSTR(TX_ON_STUDY, 1, 1)||'",'||                                                                              
    '"'||SUBSTR(OFF_TX_REASON, 1, 2)||'",'||                                                                            
    '"'||EXT_UTIL_PKG.F_FORMAT_DATE(LAST_TX_DATE)||'",'||                                                               
    '"'||SUBSTR(OFF_STUDY_REASON, 1, 2)||'",'||                                                                         
    '"'||EXT_UTIL_PKG.F_FORMAT_DATE(OFF_FOLLOW_DT_FUL)||'",'||                                                          
    '"'||SUBSTR(PT_SUBGRP_FUL, 1, 10)||'",'||                                                                           
    '"'||SUBSTR(ELIG_WAIVER_REAS_FUL, 1, 1)||'",'||                                                                     
    '"'||SUBSTR(PERF_ZUBROD_FUL, 1, 1)||'",'||                                                                          
    EXT_UTIL_PKG.F_TO_CHAR_CDUS(RADTN_TYPE, 2, 0)||','||                                                                
    EXT_UTIL_PKG.F_TO_CHAR_CDUS(CDUS_DISEAS_CD_FUL, 10, 0)||','||                                                       
    '"'||''||'",'||                                                                                                     
    '"'||SUBSTR(BASELINE_ABNORMALITIES_FLAG, 1, 1)||'"'       LINE_TEXT                                                 
FROM (                                                                                                                  
 SELECT A.*                                                                                                             
       ,DECODE(A.PT_GENDER_FUL, 'MALE', '1', 'M', '1', 'FEMALE', '2', 'F', '2', 'UNKNOWN', '9','U', '9', NULL) GENDER_CO
DE                                                                                                                      
       ,DECODE(UPPER(A.ETHNIC_CATEGORIES_FUL),                                                                          
         'HISPANIC OR LATINO', '1', 'HISPANIC-OR-LATINO', '1',                                                          
         'NONHISPANIC', '2', 'NON-HISPANIC', '2',                                                                       
         'UNKNOWN', '9', NULL)        DR_ETHNIC_CATEGORIES_FUL                                                          
       ,DECODE(B.OFF_STDY_DT_FUL, NULL, '2', '1') TX_ON_STUDY                                                           
       ,DECODE(B.OFF_STDY_REAS_FUL,                                                                                     
                  'C','01','P','02','T','03','D','04','R','05',                                                         
                  'X','06','A','07','S','08','F','10','G','11','B','12','98') OFF_TX_REASON                             
       ,DECODE(B.OFF_STDY_REAS_FUL,                                                                                     
                  'H','01','L','02','W','03','M','04','E','05','09')   OFF_STUDY_REASON                                 
       ,B.OFF_FOLLOW_DT_FUL                                                                                             
       ,C.LAST_TX_DATE                                                                                                  
       ,DECODE(D.ELIG_WAIVER_REAS_FUL, NULL, '2', '1') ELIG_WAIVER_REAS_FUL                                             
       ,E.RADTN_TYPE                                                                                                    
       ,DECODE(NVL(F.BS_COUNT, 0), 0 , '0', '1')  BASELINE_ABNORMALITIES_FLAG                                           
   FROM PP_EXT_OWNER.CTSC_ENROLLMENT A,                                                                                 
        PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM B,                                                                             
        (SELECT STUDY, PT, MAX(START_DT_FUL) LAST_TX_DATE                                                               
           FROM PP_EXT_OWNER.CTS_STUDY_DRUG_ADMIN_VW                                                                    
          GROUP BY STUDY, PT) C,                                                                                        
        PP_EXT_OWNER.CTSC_ELIG_CHECK    D,                                                                              
        (SELECT STUDY, PT, COUNT(DISTINCT RADTN_TYPE)  RADTN_TYPE                                                       
           FROM PP_EXT_OWNER.CTSC_PRIOR_RAD_SUPP                                                                        
          WHERE RADTN_TYPE IS NOT NULL                                                                                  
          GROUP BY STUDY, PT) E,                                                                                        
        (SELECT STUDY, PT, COUNT(*) BS_COUNT                                                                            
           FROM PP_EXT_OWNER.CTSC_BASE_SYMP                                                                             
          GROUP BY STUDY, PT) F                                                                                         
  WHERE A.STUDY   = B.STUDY (+)                                                                                         
    AND A.PT      = B.PT (+)                                                                                            
    AND A.STUDY   = C.STUDY (+)                                                                                         
    AND A.PT      = C.PT (+)                                                                                            
    AND A.STUDY   = D.STUDY (+)                                                                                         
    AND A.PT      = D.PT (+)                                                                                            
    AND A.STUDY   = E.STUDY (+)                                                                                         
    AND A.PT      = E.PT (+)                                                                                            
    AND A.STUDY   = F.STUDY (+)                                                                                         
    AND A.PT      = F.PT (+)                                                                                            
)                                                                                                                       
                                                                                                                        
THER_STD                       CDUS                           C300     PATIENT_RACES                                    
C_PATIENT_RACES                                                                                                         
select                                                                                                                  
  :P_FILE_ID                                    FILE_ID                                                                 
 ,:P_VERSION                                    VERSION                                                                 
 ,:P_CURRENT_EXT_DATE                           EXTRACTED                                                               
 ,DECODE('1', NULL, 0)                          RECEIVED_DCM_ID                                                         
 ,DECODE('1', NULL, SYSDATE)                    RECEIVED_DCM_ENTRY_TS                                                   
 ,DOCNUM                                        DOCNUM                                                                  
 ,''                                            DEL_FLAG                                                                
 ,STUDY                                         PROTOCOL                                                                
 ,PT                                            PT                                                                      
 ,PATIENT_FUL                                   PATIENT                                                                 
 ,NULL    KEY1                                                                                                          
 ,NULL    KEY2                                                                                                          
 ,NULL    KEY3                                                                                                          
 ,NULL    KEY4                                                                                                          
 ,NULL    KEY5                                                                                                          
 ,'"'||:P_FILE_ID||'",'||                                                                                               
    '"'||SUBSTR(STUDY, 1, 35)||'",'||                                                                                   
    '"'||SUBSTR(PATIENT_FUL, 1, 20)||'",'||                                                                             
    '"'||SUBSTR(EACH_RACE_FUL, 1, 2)||'"'       LINE_TEXT                                                               
FROM (                                                                                                                  
  select A.* ,'01' EACH_RACE_FUL                                                                                        
    from PP_EXT_OWNER.CTSC_ENROLLMENT A                                                                                 
   where A.RACE_FUL1 = 'Y'                                                                                              
  union all (                                                                                                           
  select A.* ,'02' EACH_RACE_FUL                                                                                        
    from PP_EXT_OWNER.CTSC_ENROLLMENT A                                                                                 
   where A.RACE_FUL2 = 'Y'                                                                                              
  )                                                                                                                     
  union all (                                                                                                           
  select A.* ,'03' EACH_RACE_FUL                                                                                        
    from PP_EXT_OWNER.CTSC_ENROLLMENT A                                                                                 
   where A.RACE_FUL3 = 'Y'                                                                                              
  )                                                                                                                     
  union all (                                                                                                           
  select A.* ,'04' EACH_RACE_FUL                                                                                        
    from PP_EXT_OWNER.CTSC_ENROLLMENT A                                                                                 
   where A.RACE_FUL4 = 'Y'                                                                                              
  )                                                                                                                     
  union all (                                                                                                           
  select A.* ,'05' EACH_RACE_FUL                                                                                        
    from PP_EXT_OWNER.CTSC_ENROLLMENT A                                                                                 
   where A.RACE_FUL5 = 'Y'                                                                                              
  )                                                                                                                     
  union all (                                                                                                           
  select A.* ,'06' EACH_RACE_FUL                                                                                        
    from PP_EXT_OWNER.CTSC_ENROLLMENT A                                                                                 
   where A.RACE_FUL6 = 'Y'                                                                                              
  )                                                                                                                     
)                                                                                                                       
                                                                                                                        
THER_STD                       CDUS                           C300     PRIOR_THERAPIES                                  
C_PRIOR_THERAPIES                                                                                                       
select                                                                                                                  
  :P_FILE_ID                                    FILE_ID                                                                 
 ,:P_VERSION                                    VERSION                                                                 
 ,:P_CURRENT_EXT_DATE                           EXTRACTED                                                               
 ,DECODE('1', NULL, 0)                          RECEIVED_DCM_ID                                                         
 ,DECODE('1', NULL, SYSDATE)                    RECEIVED_DCM_ENTRY_TS                                                   
 ,DOCNUM                                        DOCNUM                                                                  
 ,''                                            DEL_FLAG                                                                
 ,STUDY                                         PROTOCOL                                                                
 ,PT                                            PT                                                                      
 ,PATIENT_FUL                                   PATIENT                                                                 
 ,NULL    KEY1                                                                                                          
 ,NULL    KEY2                                                                                                          
 ,NULL    KEY3                                                                                                          
 ,NULL    KEY4                                                                                                          
 ,NULL    KEY5                                                                                                          
 ,'"'||:P_FILE_ID||'",'||                                                                                               
    '"'||SUBSTR(STUDY, 1, 35)||'",'||                                                                                   
    '"'||SUBSTR(PATIENT_FUL, 1, 20)||'",'||                                                                             
    EXT_UTIL_PKG.F_TO_CHAR_CDUS(MEDDRA5_CD, 10, 0)       LINE_TEXT                                                      
FROM (SELECT A.*                                                                                                        
            ,B.MEDDRA5_CD                                                                                               
        FROM PP_EXT_OWNER.CTSC_PRIOR_TREAT_SUMM A,                                                                      
             THERAPY_TYPES B                                                                                            
       WHERE A.PRIOR_THRPY_IND_FUL = 'Y'                                                                                
         AND UPPER(A.THERAPY_TYPE) = UPPER(B.THERAPY_DESCRIPTION))                                                      
                                                                                                                        
THER_STD                       CDUS                           C300     TREATMENT_COURSES                                
C_TREATMENT_COURSES                                                                                                     
select                                                                                                                  
  :P_FILE_ID                                    FILE_ID                                                                 
 ,:P_VERSION                                    VERSION                                                                 
 ,:P_CURRENT_EXT_DATE                           EXTRACTED                                                               
 ,DECODE('1', NULL, 0)                          RECEIVED_DCM_ID                                                         
 ,DECODE('1', NULL, SYSDATE)                    RECEIVED_DCM_ENTRY_TS                                                   
 ,DOCNUM                                        DOCNUM                                                                  
 ,''                                            DEL_FLAG                                                                
 ,STUDY                                         PROTOCOL                                                                
 ,PT                                            PT                                                                      
 ,PATIENT_FUL                                   PATIENT                                                                 
 ,NULL    KEY1                                                                                                          
 ,NULL    KEY2                                                                                                          
 ,NULL    KEY3                                                                                                          
 ,NULL    KEY4                                                                                                          
 ,NULL    KEY5                                                                                                          
 ,'"'||:P_FILE_ID||'",'||                                                                                               
    '"'||SUBSTR(STUDY, 1, 35)||'",'||                                                                                   
    '"'||SUBSTR(PATIENT_FUL, 1, 20)||'",'||                                                                             
    EXT_UTIL_PKG.F_TO_CHAR_CDUS(COURS_NUM_FUL, 6, 0)||','||                                                             
    '"'||EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)||'",'||                                                               
    '"'||SUBSTR(CDUS_TX_ASSIG_CD_FUL, 1, 10)||'",'||                                                                    
    '"'||SUBSTR(CDUS_TX_INST_FUL, 1, 6)||'",'||                                                                         
    EXT_UTIL_PKG.F_TO_CHAR_CDUS(HEIGHT_CM_FUL, 6, 1)||','||                                                             
    EXT_UTIL_PKG.F_TO_CHAR_CDUS(WEIGHT_KG_FUL, 6, 1)||','||                                                             
    '"'||SUBSTR(AE_EXPERIENCED, 1, 1)||'"'       LINE_TEXT                                                              
FROM (                                                                                                                  
 SELECT A.*                                                                                                             
       ,B.HEIGHT_CM_FUL                                                                                                 
       ,B.WEIGHT_KG_FUL                                                                                                 
       ,DECODE(NVL(F.AE_COUNT, 0), 0 , '0', '1')  AE_EXPERIENCED                                                        
   FROM PP_EXT_OWNER.CTSC_COURSE_INIT A,                                                                                
        PP_EXT_OWNER.CTSC_VITAL_SIGNS B,                                                                                
        (SELECT STUDY, PT, COUNT(*) AE_COUNT                                                                            
           FROM PP_EXT_OWNER.CTSC_ADVERSE_EVENTS                                                                        
          GROUP BY STUDY, PT) F                                                                                         
  WHERE A.STUDY   = B.STUDY (+)                                                                                         
    AND A.PT      = B.PT (+)                                                                                            
    AND A.DOCNUM  = B.DOCNUM (+)                                                                                        
    AND A.STUDY   = F.STUDY (+)                                                                                         
    AND A.PT      = F.PT (+)                                                                                            
)                                                                                                                       
                                                                                                                        
THER_STD                       THERADEX                       T310     BC                                               
C_BC                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(BUN_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(CREATININE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(SODIUM_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(POTASSIUM_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(CHLORIDE_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(MAGNESIUM_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(BICARB_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(URIC_ACID_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(BILIRUBIN_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(ALK_PHOS_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(SGOT_AST_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(SGPT_ALT_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(SGGT_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(LDH_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(TOTAL_PROT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(ALBUMIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(GLOBULIN_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(INORG_PHOS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(GLUC_FAST_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(GLUC_NFAST_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(CHOLEST_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(AMYLASE_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(FIVE_NUCLEO_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR(CREAT_PHOS_FUL, 9, 3)||' '             LINE_TEXT                                             
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.BUN_FUL                                                                                                             
 ,A.CREATININE_FUL                                                                                                      
 ,A.SODIUM_FUL                                                                                                          
 ,A.POTASSIUM_FUL                                                                                                       
 ,A.CHLORIDE_FUL                                                                                                        
 ,A.MAGNESIUM_FUL                                                                                                       
 ,A.BICARB_FUL                                                                                                          
 ,A.URIC_ACID_FUL                                                                                                       
 ,A.BILIRUBIN_FUL                                                                                                       
 ,A.ALK_PHOS_FUL                                                                                                        
 ,A.SGOT_AST_FUL                                                                                                        
 ,A.SGPT_ALT_FUL                                                                                                        
 ,A.SGGT_FUL                                                                                                            
 ,A.LDH_FUL                                                                                                             
 ,A.TOTAL_PROT_FUL                                                                                                      
 ,A.ALBUMIN_FUL                                                                                                         
 ,A.GLOBULIN_FUL                                                                                                        
 ,A.CALCIUM_FUL                                                                                                         
 ,A.INORG_PHOS_FUL                                                                                                      
 ,A.GLUC_FAST_FUL                                                                                                       
 ,A.GLUC_NFAST_FUL                                                                                                      
 ,A.CHOLEST_FUL                                                                                                         
 ,A.AMYLASE_FUL                                                                                                         
 ,A.FIVE_NUCLEO_FUL                                                                                                     
 ,A.CREAT_PHOS_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_BC A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     BC                                               
C_BC_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_BC                                                                                         
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     BC                                               
C_LAB_OTH_BC                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
           EXT_UTIL_PKG.F_TO_CHAR(BUN_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(CREATININE_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(SODIUM_FUL, 9, 3)||' '||                                                              
           EXT_UTIL_PKG.F_TO_CHAR(POTASSIUM_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(CHLORIDE_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(MAGNESIUM_FUL, 9, 3)||' '||                                                           

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
           EXT_UTIL_PKG.F_TO_CHAR(BICARB_FUL, 9, 3)||' '||                                                              
           EXT_UTIL_PKG.F_TO_CHAR(URIC_ACID_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(BILIRUBIN_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(ALK_PHOS_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(SGOT_AST_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(SGPT_ALT_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(SGGT_FUL, 9, 3)||' '||                                                                
           EXT_UTIL_PKG.F_TO_CHAR(LDH_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(TOTAL_PROT_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(ALBUMIN_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(GLOBULIN_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(INORG_PHOS_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(GLUC_FAST_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(GLUC_NFAST_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(CHOLEST_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(AMYLASE_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(FIVE_NUCLEO_FUL, 9, 3)||' '||                                                         
           EXT_UTIL_PKG.F_TO_CHAR(CREAT_PHOS_FUL, 9, 3)||' '       LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_BC A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
THER_STD                       THERADEX                       T310     BC                                               
C_LAB_OTH_BC_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     BM                                               
C_BM                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(MYELOBLAST_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROMYELO_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(MYEL_NEUT_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(MYEL_EOS_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(MYEL_BASOS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(METAMYELO_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(POLY_NEUT_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(POLY_EOS_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(POLY_BASOS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PLASMA_CEL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MONOCYTES_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(RETIC_CELL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MEGAKARYO_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PRONORMO_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(NORMOBLAST_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(M_RATING_FUL, 9, 3)||' '          LINE_TEXT                                                  
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,A.MYELOBLAST_FUL                                                                                                      
 ,A.PROMYELO_FUL                                                                                                        
 ,A.MYEL_NEUT_FUL                                                                                                       
 ,A.MYEL_EOS_FUL                                                                                                        
 ,A.MYEL_BASOS_FUL                                                                                                      
 ,A.METAMYELO_FUL                                                                                                       
 ,A.POLY_NEUT_FUL                                                                                                       
 ,A.POLY_EOS_FUL                                                                                                        
 ,A.POLY_BASOS_FUL                                                                                                      
 ,A.LYMPHOCYTE_FUL                                                                                                      
 ,A.PLASMA_CEL_FUL                                                                                                      
 ,A.MONOCYTES_FUL                                                                                                       
 ,A.RETIC_CELL_FUL                                                                                                      
 ,A.MEGAKARYO_FUL                                                                                                       
 ,A.PRONORMO_FUL                                                                                                        
 ,A.NORMOBLAST_FUL                                                                                                      
 ,A.M_RATING_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_BONEMRW A,                                                                                  
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     BM                                               
C_BM_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_BONEMRW                                                                                    
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     BM                                               
C_LAB_OTH_BM                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
           EXT_UTIL_PKG.F_TO_CHAR(MYELOBLAST_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(PROMYELO_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(MYEL_NEUT_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(MYEL_EOS_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(MYEL_BASOS_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(METAMYELO_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(POLY_NEUT_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(POLY_EOS_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(POLY_BASOS_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(PLASMA_CEL_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(MONOCYTES_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(RETIC_CELL_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(MEGAKARYO_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(PRONORMO_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(NORMOBLAST_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(M_RATING_FUL, 9, 3)||' '      LINE_TEXT                                               
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_BM A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
THER_STD                       THERADEX                       T310     BM                                               
C_LAB_OTH_BM_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     BS                                               
C_BS                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)      KEY1                                                                    
 ,EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)          KEY2                                                                    
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)||                                                                              
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_CTC_CD_FUL, 10, 0)||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CTC_GRADE_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_VAR(DISEASE_RELAT_IND_FUL, 1)         LINE_TEXT                                                      
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'     COURSE_NUM   ----                                                                                           
 ,A.PATIENT_FUL                                                                                                         
 ,A.ONSET_DT_FUL                                                                                                        
 ,NVL(A.AE_DESCR_FUL, SUBSTR(A.CTC_TERM_FUL, 1, 33))       AE_DESCR_FUL                                                 
 ,A.CDUS_CTC_CD_FUL                                                                                                     
 ,SUBSTR(A.CTC_GRADE_FUL, 1, 1)    CTC_GRADE_FUL                                                                        
 ,A.DISEASE_RELAT_IND_FUL                                                                                               
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_BASE_SYMP A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     BS                                               
C_BS_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,ONSET_DT        KEY1                                                                                                  
 ,AE_DESCR            KEY2                                                                                              
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||ONSET_DT||AE_DESCR     LINE_TEXT                                                                           
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 ONSET_DT, KEY2 AE_DESCR                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                      PATIENT                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)         KEY1                                                            
      ,EXT_UTIL_PKG.F_VAR(NVL(AE_DESCR_FUL, SUBSTR(CTC_TERM_FUL, 1, 33)), 33) KEY2                                      
  FROM PP_EXT_OWNER.CTSC_BASE_SYMP                                                                                      
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     CA                                               
C_CA                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)  KEY1                                                                 
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)||                                                                   
    EXT_UTIL_PKG.F_VAR(RESPS_ASSMNT_FUL, 2)||                                                                           
    EXT_UTIL_PKG.F_FORMAT_DATE(RESPS_ONSET_DT_FUL)||                                                                    
    EXT_UTIL_PKG.F_FORMAT_DATE(PROGRES_ONSET_DT_FUL)||                                                                  
    EXT_UTIL_PKG.F_VAR(COURS_DISP_FUL, 4)||                                                                             
    EXT_UTIL_PKG.F_VAR(TOXICITY_IND_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(RESP_NOTE_FUL, 32)||                                                                             
    EXT_UTIL_PKG.F_TO_CHAR(PREV_DOSE_CHANGE_FUL, 2, 0)             LINE_TEXT                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.COURSE_START_DT_FUL)     COURSE_NUM   ----                   
 ,A.PATIENT_FUL                                                                                                         
 ,A.COURSE_START_DT_FUL                                                                                                 
 ,A.COURS_DISP_FUL                                                                                                      
 ,SUBSTR(A.PREV_DOSE_CHANGE_FUL, 1, 1)   PREV_DOSE_CHANGE_FUL                                                           
 ,A.PROGRES_ONSET_DT_FUL                                                                                                
 ,A.RESPS_ASSMNT_FUL                                                                                                    
 ,A.RESPS_ONSET_DT_FUL                                                                                                  
 ,A.RESP_NOTE_FUL                                                                                                       
 ,A.TOXICITY_IND_FUL                             ---------------                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_COURSE_ASSESS A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     CA                                               
C_CA_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                     PATIENT                                                                                   
 ,COURSE_START_DT      KEY1                                                                                             
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||COURSE_START_DT        LINE_TEXT                                                                           
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 COURSE_START_DT                                                                 
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                     
      ,EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)      KEY1                                                        
  FROM PP_EXT_OWNER.CTSC_COURSE_ASSESS                                                                                  
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     CI                                               
C_CI                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL), 8)   KEY1                                                
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    EXT_UTIL_PKG.F_VAR(COURSE_NUM, 3)||               ------------                                                      
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL), 8)||                                                   
    EXT_UTIL_PKG.F_VAR(ARM_FUL, 4)||                                                                                    
    EXT_UTIL_PKG.F_VAR(CDUS_TX_ASSIG_CD_FUL, 10)||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(WEIGHT_KG_FUL, 6, 2)||                                                                       
    EXT_UTIL_PKG.F_VAR(WEIGHT_UNITS_FUL, 4)||                                                                           
    EXT_UTIL_PKG.F_TO_CHAR(HEIGHT_CM_FUL, 6, 2)||                                                                       
    EXT_UTIL_PKG.F_VAR(HEIGHT_UNITS_FUL, 4)||                                                                           
    EXT_UTIL_PKG.F_TO_CHAR(BSA_FUL, 5, 2)||                                                                             
    EXT_UTIL_PKG.F_VAR(CDUS_TX_INST_FUL, 6)             LINE_TEXT                                                       
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,LPAD(A.COURS_NUM, 3, ' ')         COURSE_NUM    ----                                                                  
 ,A.PATIENT_FUL                                                                                                         
 ,A.START_DT_FUL                                                                                                        
 ,A.ARM_FUL                                                                                                             
 ,A.CDUS_TX_ASSIG_CD_FUL                                                                                                
 ,A.WEIGHT_KG_FUL                                                                                                       
 ,'kg'                     WEIGHT_UNITS_FUL                                                                             
 ,A.HEIGHT_CM_FUL                                                                                                       
 ,'cm'                     HEIGHT_UNITS_FUL                                                                             
 ,A.BSA_FUL                                                                                                             
 ,A.CDUS_TX_INST_FUL                                                                                                    
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM (SELECT E.*, V.HEIGHT_CM_FUL, V.WEIGHT_KG_FUL, V.BSA_FUL                                                          
         FROM PP_EXT_OWNER.CTSC_COURSE_INIT E,                                                                          
              PP_EXT_OWNER.CTSC_VITAL_SIGNS V                                                                           
        WHERE E.STUDY = V.STUDY (+)                                                                                     
          AND E.DOCNUM = V.DOCNUM (+) ) A,                                                                              
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     CI                                               
C_CI_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                     PATIENT                                                                                   
 ,START_DT   KEY1                                                                                                       
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||START_DT         LINE_TEXT                                                                                 
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 START_DT                                                                        
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                              PATIENT                                         
      ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL), 8)   KEY1                                           
  FROM PP_EXT_OWNER.CTSC_COURSE_INIT                                                                                    
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     CM                                               
C_CM                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)         KEY1                                                                 
 ,EXT_UTIL_PKG.F_VAR(PROC_FUL, 24)                 KEY2                                                                 
 ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)           KEY3                                                                 
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(PROC_FUL, 24)||                                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)||                                                                            
    EXT_UTIL_PKG.F_VAR(TOTL_DLY_DS_FUL, 8)||                                                                            
    EXT_UTIL_PKG.F_VAR(DOSE_UOM_FUL, 12)||                                                                              
    EXT_UTIL_PKG.F_VAR(MED_SCHED_FUL, 24)||                                                                             
    EXT_UTIL_PKG.F_VAR(REAS_FUL, 24)||                                                                                  
    EXT_UTIL_PKG.F_FORMAT_DATE(STOP_DT_FUL)        LINE_TEXT                                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.START_DT_FUL)     COURSE_NUM   ----                          
 ,A.PATIENT_FUL                                                                                                         
 ,A.START_DT_FUL                                                                                                        
 ,NVL(TRIM(A.AGT_NM_FUL), A.PROC_FUL) PROC_FUL                                                                          
 ,A.REPEATSN                                                                                                            
 ,A.TOTL_DLY_DS_FUL                                                                                                     
 ,A.DOSE_UOM_FUL                                                                                                        
 ,A.MED_SCHED_FUL                                                                                                       
 ,A.REAS_FUL                                                                                                            
 ,A.STOP_DT_FUL                                                                                                         
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_CONCOM_MEDS_MEAS A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     CM                                               
C_CM_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,START_DT             KEY1                                                                                             
 ,PROC                 KEY2                                                                                             
 ,REPEATSN             KEY3                                                                                             
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||START_DT||PROC||REPEATSN       LINE_TEXT                                                                   
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 START_DT, KEY2 PROC, KEY3 REPEATSN                                              
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                     
      ,EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)             KEY1                                                        
      ,EXT_UTIL_PKG.F_VAR(NVL(TRIM(AGT_NM_FUL), PROC_FUL), 24)  KEY2                                                    
      ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)               KEY3                                                        
  FROM PP_EXT_OWNER.CTSC_CONCOM_MEDS_MEAS                                                                               
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     DA                                               
C_DA                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)          KEY1                                                                
 ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)              KEY2                                                                
 ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)             KEY3                                                                
 ,''                                               KEY4                                                                 
 ,''                                               KEY5                                                                 
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)||                                                                          
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)||                                                                              
    EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)||                                                                             
    EXT_UTIL_PKG.F_VAR(LOT_NUM_FUL, 24)||                                                                               
    EXT_UTIL_PKG.F_DA_TO_CHAR(DECODE(E_DOSE_LEVEL_FUL, 0, DOSE_LEVEL_FUL,                                               
      DECODE(X_DOSE_LEVEL_FUL, 0, DOSE_LEVEL_FUL, SUBSTR(DOSE_LEVEL_FUL, 1, X_DOSE_LEVEL_FUL - 1))), 9, 3)||            
    EXT_UTIL_PKG.F_VAR(DECODE(E_DOSE_LEVEL_FUL, 0, NULL,                                                                
      DECODE(X_DOSE_LEVEL_FUL, 0, NULL, SUBSTR(DOSE_LEVEL_FUL, X_DOSE_LEVEL_FUL + 1)))||DOSE_UOM_FUL, 12)||             
    EXT_UTIL_PKG.F_VAR(MED_SCHED_FUL, 24)||                                                                             
    EXT_UTIL_PKG.F_DA_TO_CHAR(DECODE(E_ACTL_DOSE_FUL, 0, ACTL_DOSE_FUL,                                                 
      DECODE(X_ACTL_DOSE_FUL, 0, ACTL_DOSE_FUL, SUBSTR(ACTL_DOSE_FUL, 1, X_ACTL_DOSE_FUL - 1))), 9, 3)||                
    EXT_UTIL_PKG.F_VAR(DECODE(E_ACTL_DOSE_FUL, 0, NULL,                                                                 
      DECODE(X_ACTL_DOSE_FUL, 0, NULL, SUBSTR(ACTL_DOSE_FUL, X_ACTL_DOSE_FUL + 1)))||ACTL_DOSE_UOM_FUL, 12)||           
    EXT_UTIL_PKG.F_VAR(ROUTE_FUL, 8)||                                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(DURATN_FUL, 7, 2)||                                                                          
    EXT_UTIL_PKG.F_VAR(DURATN_UOM_FUL, 2)                LINE_TEXT                                                      
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.START_DT_FUL)     COURSE_NUM   ----                          
 ,A.PATIENT_FUL                                                                                                         
 ,A.START_DT_FUL                                                                                                        
 ,A.TIME_FUL                                                                                                            
 ,A.CTMS_AGENT_FUL                                                                                                      
 ,A.LOT_NUM_FUL                                                                                                         
 ,A.DOSE_LEVEL_FUL                                                                                                      
 ,NVL(INSTR(A.DOSE_LEVEL_FUL, 'E'), 0) E_DOSE_LEVEL_FUL                                                                 
 ,NVL(INSTR(A.DOSE_LEVEL_FUL, 'X'), 0) X_DOSE_LEVEL_FUL                                                                 
 ,A.DOSE_UOM_FUL                                                                                                        
 ,SUBSTR(A.DOSE_UOM_FUL, 1, INSTR(A.DOSE_UOM_FUL, 'X'))   X_DOSE_UOM_FUL                                                
 ,A.MED_SCHED_FUL                                                                                                       
 ,A.ACTL_DOSE_FUL                                                                                                       
 ,NVL(INSTR(A.ACTL_DOSE_FUL, 'E'), 0) E_ACTL_DOSE_FUL                                                                   
 ,NVL(INSTR(A.ACTL_DOSE_FUL, 'X'), 0) X_ACTL_DOSE_FUL                                                                   
 ,A.ACTL_DOSE_UOM_FUL                                                                                                   
 ,SUBSTR(A.ACTL_DOSE_UOM_FUL, 1, INSTR(A.ACTL_DOSE_UOM_FUL, 'X'))   X_ACTL_DOSE_UOM_FUL                                 
 ,A.ROUTE_FUL                                                                                                           
 ,A.DURATN_FUL                                                                                                          
 ,A.DURATN_UOM_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_STUDY_DRUG_ADMIN A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     DA                                               
C_DA_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,START_DT                                 KEY1                                                                         
 ,TIME                                     KEY2                                                                         
 ,CTMS_AGENT                               KEY3                                                                         
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||START_DT||TIME||CTMS_AGENT              LINE_TEXT                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 START_DT, KEY2 TIME, KEY3 CTMS_AGENT                                            
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)       PATIENT                                                                
      ,EXT_UTIL_PKG.F_FORMAT_DATE(START_DT_FUL)  KEY1                                                                   
      ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)      KEY2                                                                   
      ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)     KEY3                                                                   
  FROM PP_EXT_OWNER.CTSC_STUDY_DRUG_ADMIN                                                                               
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     DS                                               
C_DS                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,''                                 KEY1                                                                               
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(DEATH_DT_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(DEATH_CAUSE_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(DEATH_OTH_CAUSE_FUL, 24)||                                                                       
    EXT_UTIL_PKG.F_VAR(CTMS_AUTOPSY_IND_FUL, 1)||                                                                       
    EXT_UTIL_PKG.F_VAR(AUTOPSY_DEATH_CAUSE_FUL, 1)||                                                                    
    EXT_UTIL_PKG.F_VAR(ATPSY_OTH_DEATH_CAUS_FUL, 24)||                                                                  
    EXT_UTIL_PKG.F_VAR(SITE1_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE2_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE3_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE4_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE5_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE6_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE7_FUL, 18)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SITE8_FUL, 18)          LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'                                               COURSE_NUM   ----                                                 
 ,A.PATIENT_FUL                                                                                                         
 ,A.DEATH_DT_FUL                                                                                                        
 ,A.DEATH_CAUSE_FUL                                                                                                     
 ,A.DEATH_OTH_CAUSE_FUL                                                                                                 
 ,A.CTMS_AUTOPSY_IND_FUL                                                                                                
 ,A.AUTOPSY_DEATH_CAUSE_FUL                                                                                             
 ,A.ATPSY_OTH_DEATH_CAUS_FUL                                                                                            
 ,A.SITE1_FUL                                                                                                           
 ,A.SITE2_FUL                                                                                                           
 ,A.SITE3_FUL                                                                                                           
 ,A.SITE4_FUL                                                                                                           
 ,A.SITE5_FUL                                                                                                           
 ,A.SITE6_FUL                                                                                                           
 ,A.SITE7_FUL                                                                                                           
 ,A.SITE8_FUL                                                                                                           
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_DEATH_SUMMARY A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     DS                                               
C_DS_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,''                                 KEY1                                                                               
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT       LINE_TEXT                                                                                             
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT                                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12) PATIENT                                                                      
  FROM PP_EXT_OWNER.CTSC_DEATH_SUMMARY                                                                                  
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     DT                                               
C_DT                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT_FUL                                             PATIENT                                                       
 ,EXT_UTIL_PKG.F_VAR(PT_SUBGRP_FUL, 10)       KEY1                                                                      
 ,EXT_UTIL_PKG.F_VAR(TOXICITY_FUL, 33)        KEY2                                                                      
 ,''                                         KEY3                                                                       
 ,''                                         KEY4                                                                       
 ,''                                         KEY5                                                                       
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PT_SUBGRP_FUL, 10)||                                                                             
    EXT_UTIL_PKG.F_VAR(TOXICITY_FUL, 33)||                                                                              
    EXT_UTIL_PKG.F_VAR(CDUS_CTC_CD_FUL, 10)           LINE_TEXT                                                         
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'                   COURSE_NUM   ----                                                                             
 ,' '                                                  PATIENT_FUL                                                      
 ,A.PT_SUBGRP_FUL                                                                                                       
 ,NVL(A.AE_DESCR_FUL, SUBSTR(A.CTC_TERM_FUL, 1, 33)) TOXICITY_FUL                                                       
 ,A.CDUS_CTC_CD_FUL                                                                                                     
 ,A.DOCNUM                                                                                                              
 ,' '                          PT                                                                                       
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_DOS_LIMIT_TOX A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     DT                                               
C_DT_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,PT_SUBGRP                                 KEY1                                                                        
 ,TOXICITY                                  KEY2                                                                        
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PT_SUBGRP||TOXICITY         LINE_TEXT                                                                               
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 PT_SUBGRP, KEY2 TOXICITY                                                        
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, ' ' PT                                                                                            
      ,' '                                     PATIENT                                                                  
      ,EXT_UTIL_PKG.F_VAR(PT_SUBGRP_FUL, 10)    KEY1                                                                    
      ,EXT_UTIL_PKG.F_VAR(NVL(AE_DESCR_FUL, SUBSTR(CTC_TERM_FUL, 1, 33)), 33)  KEY2                                     
  FROM PP_EXT_OWNER.CTSC_DOS_LIMIT_TOX                                                                                  
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     EC                                               
C_EC                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,''                                 KEY1                                                                               
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_VAR(CHECKLIST_NUM_FUL, 2)||                                                                          
    EXT_UTIL_PKG.F_VAR_EC(Q1_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q2_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q3_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q4_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q5_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q6_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q7_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q8_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q9_FUL, 1)||                                                                                  
    EXT_UTIL_PKG.F_VAR_EC(Q10_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q11_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q12_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q13_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q14_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q15_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q16_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q17_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q18_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q19_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q20_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q21_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q22_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q23_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q24_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q25_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q26_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q27_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q28_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q29_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q30_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q31_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q32_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q33_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q34_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q35_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q36_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q37_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q38_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q39_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR_EC(Q40_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR(PT_ELIG_IND_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(ELIG_WAIVER_REAS_FUL, 64)||                                                                      
    EXT_UTIL_PKG.F_VAR(WAIVER_NUM_FUL, 12)           LINE_TEXT                                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'     COURSE_NUM   ----                                                                                           
 ,A.PATIENT_FUL                                                                                                         
 ,A.CHECKLIST_NUM_FUL                                                                                                   
 ,A.EFFCT_DT_FUL                                                                                                        
 ,A.Q1_FUL                                                                                                              
 ,A.Q2_FUL                                                                                                              
 ,A.Q3_FUL                                                                                                              
 ,A.Q4_FUL                                                                                                              
 ,A.Q5_FUL                                                                                                              
 ,A.Q6_FUL                                                                                                              
 ,A.Q7_FUL                                                                                                              
 ,A.Q8_FUL                                                                                                              
 ,A.Q9_FUL                                                                                                              
 ,A.Q10_FUL                                                                                                             
 ,A.Q11_FUL                                                                                                             
 ,A.Q12_FUL                                                                                                             
 ,A.Q13_FUL                                                                                                             
 ,A.Q14_FUL                                                                                                             
 ,A.Q15_FUL                                                                                                             
 ,A.Q16_FUL                                                                                                             
 ,A.Q17_FUL                                                                                                             
 ,A.Q18_FUL                                                                                                             
 ,A.Q19_FUL                                                                                                             
 ,A.Q20_FUL                                                                                                             
 ,A.Q21_FUL                                                                                                             
 ,A.Q22_FUL                                                                                                             
 ,A.Q23_FUL                                                                                                             
 ,A.Q24_FUL                                                                                                             
 ,A.Q25_FUL                                                                                                             
 ,A.Q26_FUL                                                                                                             
 ,A.Q27_FUL                                                                                                             
 ,A.Q28_FUL                                                                                                             
 ,A.Q29_FUL                                                                                                             
 ,A.Q30_FUL                                                                                                             
 ,A.Q31_FUL                                                                                                             
 ,A.Q32_FUL                                                                                                             
 ,A.Q33_FUL                                                                                                             
 ,A.Q34_FUL                                                                                                             
 ,A.Q35_FUL                                                                                                             
 ,A.Q36_FUL                                                                                                             
 ,A.Q37_FUL                                                                                                             
 ,A.Q38_FUL                                                                                                             
 ,A.Q39_FUL                                                                                                             
 ,A.Q40_FUL                                                                                                             
 ,A.PT_ELIG_IND_FUL                                                                                                     
 ,A.ELIG_WAIVER_REAS_FUL                                                                                                
 ,NVL(A.WAIVER_NUM_FUL, '*') WAIVER_NUM_FUL                                                                             
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_ELIG_CHECK A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     EC                                               
C_EC_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,''                                KEY1                                                                                
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT          LINE_TEXT                                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT                                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                                                                              
  FROM PP_EXT_OWNER.CTSC_ELIG_CHECK                                                                                     
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     EN                                               
C_EN                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,''                             KEY1                                                                                   
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_VAR(PT_GENDER_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_VAR(RACE_CODE_FUL, 20)||                                                                             
    EXT_UTIL_PKG.F_VAR(ETHNIC_CODE_FUL, 2)||                                                                            
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(PT_DOB_FUL), 8)||                                                     
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(REG_DT_FUL), 8)||                                                     
    EXT_UTIL_PKG.F_AGE_TO_CHAR(CTMS_AGE_FUL, 6, 2)||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(WEIGHT_KG_FUL, 6, 2)||                                                                       
    EXT_UTIL_PKG.F_VAR(WGT_UNIT_FUL, 4)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(HEIGHT_CM_FUL, 6, 2)||                                                                       
    EXT_UTIL_PKG.F_VAR(HT_UNIT_FUL, 4)||                                                                                
    EXT_UTIL_PKG.F_VAR(FILTER_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(BSA_FUL, 5, 2)||                                                                             
    EXT_UTIL_PKG.F_VAR(PT_SUBGRP_FUL, 10)||                                                                             
    EXT_UTIL_PKG.F_VAR(REG_GRP_FUL, 6)||                                                                                
    EXT_UTIL_PKG.F_VAR(REG_INST_FUL, 6)||                                                                               
    EXT_UTIL_PKG.F_VAR(PT_ID_FUL, 6)||                                                                                  
    EXT_UTIL_PKG.F_VAR(CNTRY_CD_FUL, 2)||                                                                               
    EXT_UTIL_PKG.F_VAR(PST_CD_FUL, 10)||                                                                                
    EXT_UTIL_PKG.F_VAR(PYMT_MTHD_FUL, 2)||                                                                              
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_DISEAS_CD_FUL, 10, 0)||                                                                 
    EXT_UTIL_PKG.F_VAR(PRIM_SITE_FUL, 20)||                                                                             
    EXT_UTIL_PKG.F_VAR(DISEAS_STG_FUL, 8)||                                                                             
    GRADE_FUL||                                                                                                         
    EXT_UTIL_PKG.F_TO_CHAR(PERF_ZUBROD_FUL, 3, 0)||                                                                     
    EXT_UTIL_PKG.F_VAR(HIST_CYTPATH_FUL, 40)||                                                                          
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(HIST_CONF_DT_FUL), 8)||                                               
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(DIAG_DT_FUL), 8)||                                                    
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(CONS_DT_FUL), 8)||                                                    
    EXT_UTIL_PKG.F_VAR(CONS_VERS_FUL, 12)||                                                                             
    EXT_UTIL_PKG.F_VAR(CDUS_TX_ASSIG_CD_FUL, 10)                                  LINE_TEXT                             
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'                                                COURSE_NUM   ----                                                
 ,A.PATIENT_FUL                                                                                                         
 ,DECODE(A.PT_GENDER_FUL, 'F', 'F', 'M', 'M', NULL)   PT_GENDER_FUL                                                     
 ,A.RACE_CODE_FUL                                                                                                       
 ,A.PT_DOB_FUL       PT_DOB_FUL                                                                                         
 ,A.REG_DT_FUL       REG_DT_FUL                                                                                         
 ,A.CTMS_AGE_FUL                                                                                                        
 ,A.WEIGHT_KG_FUL                                                                                                       
 ,'kg'    WGT_UNIT_FUL                                                                                                  
 ,A.HEIGHT_CM_FUL                                                                                                       
 ,'cm'    HT_UNIT_FUL                                                                                                   
 ,'0' FILTER_FUL                                                                                                        
 ,A.BSA_FUL                                                                                                             
 ,NVL(A.PT_SUBGRP_FUL, 'SUBGROUPA')   PT_SUBGRP_FUL                                                                     
 ,NVL(A.REG_GRP_FUL, '*')    REG_GRP_FUL                                                                                
 ,A.REG_INST_FUL                                                                                                        
 ,A.PT_ID_FUL                                                                                                           
 ,A.ETHNIC_CODE_FUL                                                                                                     
 ,A.CNTRY_CD_FUL                                                                                                        
 ,A.PST_CD_FUL                                                                                                          
 ,NVL(A.PYMT_MTHD_FUL, '98')  PYMT_MTHD_FUL                                                                             
 ,A.CDUS_DISEAS_CD_FUL                                                                                                  
 ,A.CDUS_TX_ASSIG_CD_FUL                                                                                                
 ,A.PRIM_SITE_FUL                                                                                                       
 ,A.DISEAS_STG_FUL                                                                                                      
 ,'    '              GRADE_FUL                                                                                         
 ,DECODE(NVL(INSTR(A.PERF_ZUBROD_FUL, '='), 0), 0, SUBSTR(A.PERF_ZUBROD_FUL, 1, 3),                                     
                         SUBSTR(A.PERF_ZUBROD_FUL, 1, INSTR(A.PERF_ZUBROD_FUL, '=') - 1)) PERF_ZUBROD_FUL               
 ,A.HIST_CYTPATH_FUL                                                                                                    
 ,A.HIST_CONF_DT_FUL                                                                                                    
 ,A.DIAG_DT_FUL                                                                                                         
 ,A.CONS_DT_FUL                                                                                                         
 ,A.CONS_VERS_FUL                                                                                                       
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM (SELECT E.*, V.HEIGHT_CM_FUL, V.WEIGHT_KG_FUL, V.BSA_FUL                                                          
         FROM PP_EXT_OWNER.CTSC_ENROLLMENT E,                                                                           
              PP_EXT_OWNER.CTSC_VITAL_SIGNS V                                                                           
        WHERE E.STUDY = V.STUDY (+)                                                                                     
          AND E.DOCNUM = V.DOCNUM (+) ) A,                                                                              
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     EN                                               
C_EN_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,''                           KEY1                                                                                     
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT        LINE_TEXT                                                                                            
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT                                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                                                                              
  FROM PP_EXT_OWNER.CTSC_ENROLLMENT                                                                                     
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     EX                                               
C_LAB_OTH_EX                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(PANEL, 2, 0)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_1_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_2_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_3_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_4_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_5_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_6_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_7_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_8_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_9_FUL, 9, 3)||' '||                                                           
              EXT_UTIL_PKG.F_TO_CHAR(TEST_10_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_11_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_12_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_13_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_14_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_15_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_16_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_17_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_18_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_19_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_20_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_21_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_22_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_23_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_24_FUL, 9, 3)||' '||                                                          
              EXT_UTIL_PKG.F_TO_CHAR(TEST_25_FUL, 9, 3)||' '     LINE_TEXT                                              
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_EX A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
THER_STD                       THERADEX                       T310     EX                                               
C_LAB_OTH_EX_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     FO                                               
C_FO                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,''                                 KEY1                                                                               
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(OFF_STDY_DT_FUL)||                                                                       
    EXT_UTIL_PKG.F_FORMAT_DATE(OFF_FOLLOW_DT_FUL)||                                                                     
    EXT_UTIL_PKG.F_VAR(OFF_STDY_REAS_FUL, 1)||                                                                          
    EXT_UTIL_PKG.F_VAR(OFF_STDY_OTH_REAS_FUL, 24)||                                                                     
    EXT_UTIL_PKG.F_VAR(RESPS_ASSMNT_FUL, 2)||                                                                           
    EXT_UTIL_PKG.F_FORMAT_DATE(BEST_RSPNS_ONSET_DT_FUL)||                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(PROG_DT_FUL)         LINE_TEXT                                                           
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'                               COURSE_NUM   ----                                                                 
 ,A.PATIENT_FUL                                                                                                         
 ,A.OFF_STDY_REAS_FUL                                                                                                   
 ,A.OFF_STDY_OTH_REAS_FUL                                                                                               
 ,A.RESPS_ASSMNT_FUL                                                                                                    
 ,A.BEST_RSPNS_ONSET_DT_FUL                                                                                             
 ,A.PROG_DT_FUL                                                                                                         
 ,A.OFF_FOLLOW_DT_FUL                                                                                                   
 ,A.OFF_STDY_DT_FUL                                                                                                     
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     FO                                               
C_FO_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,''                                 KEY1                                                                               
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT         LINE_TEXT                                                                                           
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT                                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)   PATIENT                                                                    
  FROM PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM                                                                                 
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     FP                                               
C_FP                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NVL(DEATH_DT_FUL, LAST_CONTACT_DT_FUL))   KEY1                                             
 ,''                                                                  KEY2                                              
 ,''                                                                  KEY3                                              
 ,''                                                                  KEY4                                              
 ,''                                                                  KEY5                                              
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NVL(DEATH_DT_FUL, LAST_CONTACT_DT_FUL))||                                                
    EXT_UTIL_PKG.F_VAR(PAT_STAT_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_VAR(PT_OTH_STAT_FUL, 24)          LINE_TEXT                                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'       COURSE_NUM   ----                                                                                         
 ,A.PATIENT_FUL                                                                                                         
 ,A.LAST_CONTACT_DT_FUL                                                                                                 
 ,A.DEATH_DT_FUL                                                                                                        
 ,A.PAT_STAT_FUL                                                                                                        
 ,A.PT_OTH_STAT_FUL                                                                                                     
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_FOLLOW_UP A,                                                                                    
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     FP                                               
C_FP_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,LAST_CONTACT_DT                                 KEY1                                                                  
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LAST_CONTACT_DT          LINE_TEXT                                                                         
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LAST_CONTACT_DT                                                                 
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)   PATIENT                                                                    
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NVL(DEATH_DT_FUL, LAST_CONTACT_DT_FUL))  KEY1                                         
  FROM PP_EXT_OWNER.CTSC_FOLLOW_UP                                                                                      
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     HM                                               
C_HM                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(HEMOGLOBIN_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(HEMATOCRIT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(WBC_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(NEUTROPHIL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(BASOPHILS_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(MONOCYTES_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(EOSINOPHIL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_BANDS(BANDS_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR(BLASTS_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(ATYP_LYMPH_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(OTHER_DIFF_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PLATELETS_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(ANC_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(RBC_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(RETICULO_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(ESR_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(PTIME_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(PTT_FUL, 9, 3)||' '                       LINE_TEXT                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.HEMOGLOBIN_FUL                                                                                                      
 ,A.HEMATOCRIT_FUL                                                                                                      
 ,A.WBC_FUL                                                                                                             
 ,A.NEUTROPHIL_FUL                                                                                                      
 ,A.LYMPHOCYTE_FUL                                                                                                      
 ,A.BASOPHILS_FUL                                                                                                       
 ,A.MONOCYTES_FUL                                                                                                       
 ,A.EOSINOPHIL_FUL                                                                                                      
 ,A.BANDS_FUL                                                                                                           
 ,A.BLASTS_FUL                                                                                                          
 ,A.ATYP_LYMPH_FUL                                                                                                      
 ,A.OTHER_DIFF_FUL                                                                                                      
 ,A.PLATELETS_FUL                                                                                                       
 ,A.ANC_FUL                                                                                                             
 ,A.RBC_FUL                                                                                                             
 ,A.RETICULO_FUL                                                                                                        
 ,A.ESR_FUL                                                                                                             
 ,A.PTIME_FUL                                                                                                           
 ,A.PTT_FUL                                                                                                             
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_HEMA A,                                                                                     
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     HM                                               
C_HM_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_HEMA                                                                                       
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     HM                                               
C_LAB_OTH_HM                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
           EXT_UTIL_PKG.F_TO_CHAR(HEMOGLOBIN_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(HEMATOCRIT_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(WBC_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(NEUTROPHIL_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(BASOPHILS_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(MONOCYTES_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(EOSINOPHIL_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR_BANDS(BANDS_FUL, 9, 3)||' '||                                                         
           EXT_UTIL_PKG.F_TO_CHAR(BLASTS_FUL, 9, 3)||' '||                                                              
           EXT_UTIL_PKG.F_TO_CHAR(ATYP_LYMPH_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(OTHER_DIFF_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(PLATELETS_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(ANC_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(RBC_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(RETICULO_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(ESR_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(PTIME_FUL, 9, 3)||' '||                                                               
           EXT_UTIL_PKG.F_TO_CHAR(PTT_FUL, 9, 3)||' '      LINE_TEXT                                                    
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_HM A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
THER_STD                       THERADEX                       T310     HM                                               
C_LAB_OTH_HM_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     IE                                               
C_IE                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)             KEY1                                                             
 ,EXT_UTIL_PKG.F_VAR(INFECT_TYP_FUL, 20)               KEY2                                                             
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(INFECT_TYP_FUL, 20)||                                                                            
    EXT_UTIL_PKG.F_VAR(PRIM_SITE_FUL, 20)||                                                                             
    EXT_UTIL_PKG.F_VAR(INFECT_AGNT_FUL, 24)||                                                                           
    EXT_UTIL_PKG.F_VAR(TX_FUL, 24)||                                                                                    
    EXT_UTIL_PKG.F_FORMAT_DATE(RESOLV_DT_FUL)||                                                                         
    EXT_UTIL_PKG.F_VAR(OUTCOME_FUL, 24)          LINE_TEXT                                                              
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.ONSET_DT_FUL)     COURSE_NUM   ----                          
 ,A.PATIENT_FUL                                                                                                         
 ,A.ONSET_DT_FUL                                                                                                        
 ,A.INFECT_TYP_FUL                                                                                                      
 ,A.PRIM_SITE_FUL                                                                                                       
 ,A.INFECT_AGNT_FUL                                                                                                     
 ,A.TX_FUL                                                                                                              
 ,A.RESOLV_DT_FUL                                                                                                       
 ,A.OUTCOME_FUL                                                                                                         
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_INFECTION_EP A,                                                                                 
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     IE                                               
C_IE_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,ONSET_DT                                 KEY1                                                                         
 ,INFECT_TYP                                      KEY2                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||ONSET_DT||INFECT_TYP          LINE_TEXT                                                                    
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 ONSET_DT, KEY2 INFECT_TYP                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)       PATIENT                                                                
      ,EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL)  KEY1                                                                   
      ,EXT_UTIL_PKG.F_VAR(INFECT_TYP_FUL, 20)    KEY2                                                                   
  FROM PP_EXT_OWNER.CTSC_INFECTION_EP                                                                                   
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     IP                                               
C_IP                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(B_CELL_LEV_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(T_CELL_TOT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(T_CELL_HLP_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(T_CELL_SUP_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(T_CELL_DTH_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(T_CELL_CTL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(NK_ACTIV_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(ADCC_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(CYTOTOX_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CYTOSTASIS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PEROX_GEN_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(INTERFERON_FUL, 9, 3)||' '          LINE_TEXT                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.LYMPHOCYTE_FUL                                                                                                      
 ,A.B_CELL_LEV_FUL                                                                                                      
 ,A.T_CELL_TOT_FUL                                                                                                      
 ,A.T_CELL_HLP_FUL                                                                                                      
 ,A.T_CELL_SUP_FUL                                                                                                      
 ,A.T_CELL_DTH_FUL                                                                                                      
 ,A.T_CELL_CTL_FUL                                                                                                      
 ,A.NK_ACTIV_FUL                                                                                                        
 ,A.ADCC_FUL                                                                                                            
 ,A.CYTOTOX_FUL                                                                                                         
 ,A.CYTOSTASIS_FUL                                                                                                      
 ,A.PEROX_GEN_FUL                                                                                                       
 ,A.INTERFERON_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_IP A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     IP                                               
C_IP_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_IP                                                                                         
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     IP                                               
C_LAB_OTH_IP                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
           EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(LYMPHOCYTE_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(B_CELL_LEV_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(T_CELL_TOT_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(T_CELL_HLP_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(T_CELL_SUP_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(T_CELL_DTH_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(T_CELL_CTL_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(NK_ACTIV_FUL, 9, 3)||' '||                                                            
           EXT_UTIL_PKG.F_TO_CHAR(ADCC_FUL, 9, 3)||' '||                                                                
           EXT_UTIL_PKG.F_TO_CHAR(CYTOTOX_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(CYTOSTASIS_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(PEROX_GEN_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(INTERFERON_FUL, 9, 3)||' '      LINE_TEXT                                             
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_IP A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
THER_STD                       THERADEX                       T310     IP                                               
C_LAB_OTH_IP_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     LA                                               
C_LA                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(OFF_STDY_DT_FUL)                KEY1                                                       
 ,EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)                           KEY2                                                   
 ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8) KEY3                                                  
 ,''                                    KEY4                                                                            
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(OFF_STDY_DT_FUL)||                                                                       
    EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)||                                                                              
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8)||                                                   
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_CTC_CD_FUL, 10, 0)||                                                                    
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(RESOLV_DT_FUL), 8)||                                                  
    EXT_UTIL_PKG.F_VAR(AER_IND_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(CTC_GRADE_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_VAR(ATTRIBN_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_VAR(DOSE_LIMT_TOX_IND_FUL, 1)||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(AE_SERIOUS_FUL, 2, 0)||                                                                      
    EXT_UTIL_PKG.F_VAR(AE_ACTION_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_VAR(AE_THRPY_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_VAR(AE_OUTCOME_FUL, 1)      LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.ONSET_DT_FUL)  COURSE_NUM   ----                             
 ,A.PATIENT_FUL                                                                                                         
 ,''                                 COURSE_START_DT_FUL                                                                
 ,NVL(A.AE_DESCR_FUL, SUBSTR(A.CTC_TERM_FUL, 1, 33))   AE_DESCR_FUL                                                     
 ,A.ONSET_DT_FUL                                                                                                        
 ,A.ONSET_DT                                                                                                            
 ,A.OFF_STDY_DT_FUL                                                                                                     
 ,A.CDUS_CTC_CD_FUL                                                                                                     
 ,A.RESOLV_DT_FUL                                                                                                       
 ,A.RESOLV_DT                                                                                                           
 ,A.AER_IND_FUL                                                                                                         
 ,SUBSTR(A.CTC_GRADE_FUL, 1, 1)      CTC_GRADE_FUL                                                                      
 ,A.ATTRIBN_FUL                                                                                                         
 ,A.DOSE_LIMT_TOX_IND_FUL                                                                                               
 ,SUBSTR(A.AE_SER_FUL, 1, 1)   AE_SERIOUS_FUL                                                                           
 ,A.AE_ACTION_FUL                                                                                                       
 ,A.AE_THRPY_FUL                                                                                                        
 ,A.AE_OUTCOME_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM ( SELECT E.*, O.OFF_STDY_DT_FUL                                                                                   
          FROM PP_EXT_OWNER.CTSC_ADVERSE_EVENTS E,                                                                      
               PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM O                                                                       
         WHERE E.STUDY = O.STUDY                                                                                        
           AND E.PT = O.PT                                                                                              
           AND RPAD(E.ONSET_DT, 8, '0') >= RPAD(O.OFF_STDY_DT, 8, '0') ) A,                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     LA                                               
C_LA_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,OFF_STDY_DT                            KEY1                                                                           
 ,TOXICITY                                   KEY2                                                                       
 ,ONSET_DT                                   KEY3                                                                       
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||OFF_STDY_DT||TOXICITY||ONSET_DT            LINE_TEXT                                                       
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 OFF_STDY_DT, KEY2 TOXICITY, KEY3 ONSET_DT                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'LA'                                                                                                   
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                            PATIENT                                           
      ,EXT_UTIL_PKG.F_FORMAT_DATE(OFF_STDY_DT_FUL)                    KEY1                                              
      ,EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)                           KEY2                                              
      ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8) KEY3                                             
  FROM ( SELECT E.*, O.OFF_STDY_DT_FUL                                                                                  
          FROM PP_EXT_OWNER.CTSC_ADVERSE_EVENTS E,                                                                      
               PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM O                                                                       
         WHERE E.STUDY = O.STUDY                                                                                        
           AND E.PT = O.PT                                                                                              
           AND RPAD(E.ONSET_DT, 8, '0') >= RPAD(O.OFF_STDY_DT, 8, '0')                                                  
 ) )  )                                                                                                                 
                                                                                                                        
THER_STD                       THERADEX                       T310     LL                                               
C_LL                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)           KEY1                                                                 
 ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)         KEY2                                                                     
 ,EXT_UTIL_PKG.F_VAR(TEST_NAME_FUL, 8)             KEY3                                                                 
 ,EXT_UTIL_PKG.F_VAR(BD_SITE_FUL, 8)               KEY4                                                                 
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)||                                                                            
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)||                                                                              
    EXT_UTIL_PKG.F_VAR(TEST_NAME_FUL, 8)||                                                                              
    EXT_UTIL_PKG.F_VAR(BD_SITE_FUL, 8)||                                                                                
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(NORM_ABNORM_IND_FUL, 1)||                                                                        
    EXT_UTIL_PKG.F_VAR(RSLT_FUL, 128)||' '         LINE_TEXT                                                            
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.LAB_DT_FUL)     COURSE_NUM   ----                            
 ,A.PATIENT_FUL                                                                                                         
 ,A.LAB_DT_FUL                                                                                                          
 ,A.TIME_FUL                                                                                                            
 ,'        '             LAB_GROUP                                                                                      
 ,'    '                 LAB_CODE                                                                                       
 ,A.BD_SITE_FUL                                                                                                         
 ,A.NORM_ABNORM_IND_FUL                                                                                                 
 ,A.RSLT_FUL                                                                                                            
 ,A.TEST_NAME_FUL                                                                                                       
 ,A.REG_INST_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_SPEC_LITERAL A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     LL                                               
C_LL_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,LAB_DT                                       KEY1                                                                     
 ,LAB_TIME                                     KEY2                                                                     
 ,TEST_NAME                                    KEY3                                                                     
 ,BD_SITE                                      KEY4                                                                     
 ,''                                           KEY5                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LAB_DT||LAB_TIME||TEST_NAME||BD_SITE        LINE_TEXT                                                      
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LAB_DT, KEY2 LAB_TIME, KEY3 TEST_NAME, KEY4 BD_SITE                             
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)       PATIENT                                                                
      ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)    KEY1                                                                   
      ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)  KEY2                                                                       
      ,EXT_UTIL_PKG.F_VAR(TEST_NAME_FUL, 8)      KEY3                                                                   
      ,EXT_UTIL_PKG.F_VAR(BD_SITE_FUL, 8)        KEY4                                                                   
  FROM PP_EXT_OWNER.CTSC_LAB_SPEC_LITERAL                                                                               
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     LS                                               
C_LS                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0)      KEY1                                                                
 ,''                                            KEY2                                                                    
 ,''                                            KEY3                                                                    
 ,''                                            KEY4                                                                    
 ,''                                            KEY5                                                                    
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0)||                                                                      
    EXT_UTIL_PKG.F_VAR(ORGAN_FUL, 8)||                                                                                  
    EXT_UTIL_PKG.F_VAR(LESION_DESCR_FUL, 32)||                                                                          
    EXT_UTIL_PKG.F_VAR(PREV_IRRAD_IND_FUL, 1)||                                                                         
    EXT_UTIL_PKG.F_VAR(MEASUR_IND_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_VAR(FOLLOW_RESPS_IND_FUL, 1)             LINE_TEXT                                                   
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'              COURSE_NUM   ----                                                                                  
 ,A.PATIENT_FUL                                                                                                         
 ,A.LESION_NUM_FUL                                                                                                      
 ,A.ORGAN_FUL                                                                                                           
 ,A.LESION_DESCR_FUL                                                                                                    
 ,A.PREV_IRRAD_IND_FUL                                                                                                  
 ,A.FOLLOW_RESPS_IND_FUL                                                                                                
 ,A.MEASUR_IND_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LESION_DESCRIPTION A,                                                                           
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     LS                                               
C_LS_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,LESION_NUM                                      KEY1                                                                  
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LESION_NUM          LINE_TEXT                                                                              
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LESION_NUM                                                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0) KEY1                                                                
  FROM PP_EXT_OWNER.CTSC_LESION_DESCRIPTION                                                                             
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     LX                                               
C_LAB_OTH_LX                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(PANEL, 2, 0)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
              EXT_UTIL_PKG.F_VAR(FIELD_1_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_2_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_3_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_4_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_5_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_6_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_7_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_8_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_9_FUL, 64)||' '||                                                                
              EXT_UTIL_PKG.F_VAR(FIELD_10_FUL, 64)||' '     LINE_TEXT                                                   
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_LX A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
THER_STD                       THERADEX                       T310     LX                                               
C_LAB_OTH_LX_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     MH                                               
C_MH                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL)            KEY1                                                               
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(HEENT_FUL, 128)||                                                                                
    EXT_UTIL_PKG.F_VAR(NECK_FUL, 128)||                                                                                 
    EXT_UTIL_PKG.F_VAR(RESPIRAT_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(CARDIO_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(GASTRO_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(MUSKULOSKEL_FUL, 128)||                                                                          
    EXT_UTIL_PKG.F_VAR(DERMAT_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(HEM_LYM_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(ENDO_MET_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(URINARY_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(GENITAL_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(BREASTS_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(PELVIS_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(ABDOMEN_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(NEUROLOG_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(PHYSCHOL_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(IMMUNE_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(OTHER_FUL, 128)         LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'    COURSE_NUM   ----                                                                                            
 ,A.PATIENT_FUL                                                                                                         
 ,A.EXAM_DT_FUL                                                                                                         
 ,A.HEENT_FUL                                                                                                           
 ,A.NECK_FUL                                                                                                            
 ,A.RESPIRAT_FUL                                                                                                        
 ,A.CARDIO_FUL                                                                                                          
 ,A.GASTRO_FUL                                                                                                          
 ,A.MUSKULOSKEL_FUL                                                                                                     
 ,A.DERMAT_FUL                                                                                                          
 ,A.HEM_LYM_FUL                                                                                                         
 ,A.ENDO_MET_FUL                                                                                                        
 ,A.URINARY_FUL                                                                                                         
 ,A.GENITAL_FUL                                                                                                         
 ,A.BREASTS_FUL                                                                                                         
 ,A.PELVIS_FUL                                                                                                          
 ,A.ABDOMEN_FUL                                                                                                         
 ,A.NEUROLOG_FUL                                                                                                        
 ,A.PHYSCHOL_FUL                                                                                                        
 ,A.IMMUNE_FUL                                                                                                          
 ,A.OTHER_FUL     ---------------                                                                                       
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_BASE_MED_HIST A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     MH                                               
C_MH_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,EXAM_DT                                 KEY1                                                                          
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||EXAM_DT         LINE_TEXT                                                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 EXAM_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)     PATIENT                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL) KEY1                                                                     
  FROM PP_EXT_OWNER.CTSC_BASE_MED_HIST                                                                                  
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     OU                                               
C_LAB_OTH_OU                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CHLORIDE_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(OSMOLALITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(OXALATE_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(POTASSIUM_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALBUM_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALPH1_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALPH2_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_BETA_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PROT_GAMMA_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(SODIUM_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(UREA_NITRO_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(URIC_ACID_FUL, 9, 3)||' '       LINE_TEXT                                                    
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_OU A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
THER_STD                       THERADEX                       T310     OU                                               
C_LAB_OTH_OU_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     OU                                               
C_OU                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CHLORIDE_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(OSMOLALITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(OXALATE_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(POTASSIUM_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALBUM_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALPH1_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_ALPH2_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PROT_BETA_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PROT_GAMMA_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(SODIUM_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(UREA_NITRO_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(URIC_ACID_FUL, 9, 3)||' '           LINE_TEXT                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.CALCIUM_FUL                                                                                                         
 ,A.CHLORIDE_FUL                                                                                                        
 ,A.OSMOLALITY_FUL                                                                                                      
 ,A.OXALATE_FUL                                                                                                         
 ,A.POTASSIUM_FUL                                                                                                       
 ,A.PROT_ALBUM_FUL                                                                                                      
 ,A.PROT_ALPH1_FUL                                                                                                      
 ,A.PROT_ALPH2_FUL                                                                                                      
 ,A.PROT_BETA_FUL                                                                                                       
 ,A.PROT_GAMMA_FUL                                                                                                      
 ,A.SODIUM_FUL                                                                                                          
 ,A.UREA_NITRO_FUL                                                                                                      
 ,A.URIC_ACID_FUL                                                                                                       
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OU A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     OU                                               
C_OU_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_OU                                                                                         
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     PE                                               
C_PE                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL)       KEY1                                                                    
 ,''                             KEY2                                                                                   
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(HEENT_FLAG_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_VAR(HEENT_FUL, 128)||                                                                                
    EXT_UTIL_PKG.F_VAR(NECK_FLAG_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_VAR(NECK_FUL, 128)||                                                                                 
    EXT_UTIL_PKG.F_VAR(RESPIRAT_FLAG_FUL, 1)||                                                                          
    EXT_UTIL_PKG.F_VAR(RESPIRAT_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(CARDIO_FLAG_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(CARDIO_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(GASTRO_FLAG_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(GASTRO_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(MUSKULOSKEL_FLAG_FUL, 1)||                                                                       
    EXT_UTIL_PKG.F_VAR(MUSKULOSKEL_FUL, 128)||                                                                          
    EXT_UTIL_PKG.F_VAR(DERMAT_FLAG_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(DERMAT_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(HEM_LYM_FLAG_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(HEM_LYM_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(ENDO_MET_FLAG_FUL, 1)||                                                                          
    EXT_UTIL_PKG.F_VAR(ENDO_MET_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(URINARY_FLAG_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(URINARY_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(GENITAL_FLAG_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(GENITAL_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(BREASTS_FLAG_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(BREASTS_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(PELVIS_FLAG_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_VAR(PELVIS_FUL, 128)||                                                                               
    EXT_UTIL_PKG.F_VAR(ABDOMEN_FLAG_FUL, 1)||                                                                           
    EXT_UTIL_PKG.F_VAR(ABDOMEN_FUL, 128)||                                                                              
    EXT_UTIL_PKG.F_VAR(NEUROLOG_FLAG_FUL, 1)||                                                                          
    EXT_UTIL_PKG.F_VAR(NEUROLOG_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(PHYSCHOL_FLAG_FUL, 1)||                                                                          
    EXT_UTIL_PKG.F_VAR(PHYSCHOL_FUL, 128)||                                                                             
    EXT_UTIL_PKG.F_VAR(OTHER_FLAG_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_VAR(OTHER_FUL, 128)               LINE_TEXT                                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.EXAM_DT_FUL)     COURSE_NUM   ----                           
 ,A.PATIENT_FUL                                                                                                         
 ,A.EXAM_DT_FUL                                                                                                         
 ,A.HEENT_FLAG_FUL                                                                                                      
 ,A.HEENT_FUL                                                                                                           
 ,A.NECK_FLAG_FUL                                                                                                       
 ,A.NECK_FUL                                                                                                            
 ,A.RESPIRAT_FLAG_FUL                                                                                                   
 ,A.RESPIRAT_FUL                                                                                                        
 ,A.CARDIO_FLAG_FUL                                                                                                     
 ,A.CARDIO_FUL                                                                                                          
 ,A.GASTRO_FLAG_FUL                                                                                                     
 ,A.GASTRO_FUL                                                                                                          
 ,A.MUSKULOSKEL_FLAG_FUL                                                                                                
 ,A.MUSKULOSKEL_FUL                                                                                                     
 ,A.DERMAT_FLAG_FUL                                                                                                     
 ,A.DERMAT_FUL                                                                                                          
 ,A.HEM_LYM_FLAG_FUL                                                                                                    
 ,A.HEM_LYM_FUL                                                                                                         
 ,A.ENDO_MET_FLAG_FUL                                                                                                   
 ,A.ENDO_MET_FUL                                                                                                        
 ,A.URINARY_FLAG_FUL                                                                                                    
 ,A.URINARY_FUL                                                                                                         
 ,A.GENITAL_FLAG_FUL                                                                                                    
 ,A.GENITAL_FUL                                                                                                         
 ,A.BREASTS_FLAG_FUL                                                                                                    
 ,A.BREASTS_FUL                                                                                                         
 ,A.PELVIS_FLAG_FUL                                                                                                     
 ,A.PELVIS_FUL                                                                                                          
 ,A.ABDOMEN_FLAG_FUL                                                                                                    
 ,A.ABDOMEN_FUL                                                                                                         
 ,A.NEUROLOG_FLAG_FUL                                                                                                   
 ,A.NEUROLOG_FUL                                                                                                        
 ,A.PHYSCHOL_FLAG_FUL                                                                                                   
 ,A.PHYSCHOL_FUL                                                                                                        
 ,A.OTHER_FLAG_FUL                                                                                                      
 ,A.OTHER_FUL                                                                                                           
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PHYSICAL_EXAM A,                                                                                
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     PE                                               
C_PE_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,EXAM_DT                                 KEY1                                                                          
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||EXAM_DT         LINE_TEXT                                                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 EXAM_DT                                                                         
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(EXAM_DT_FUL)  KEY1                                                                    
  FROM PP_EXT_OWNER.CTSC_PHYSICAL_EXAM                                                                                  
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     PH                                               
C_PH_CM                                                                                                                 
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,' '                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                      
 ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                         
 ,:P_FILE_ID                               KEY2                                                                         
 ,EXT_UTIL_PKG.F_VAR(TYP_CD, 3)            KEY3                                                                         
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(TYP_CD, 3)||                                                                                     
    EXT_UTIL_PKG.F_VAR(NOTE_FUL, 1024)                       LINE_TEXT                                                  
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                    INST_ID                                                                                     
 ,A.REG_INST_FUL                                    REG_INST_FUL                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.NOTE_DT_FUL)             COURSE_NUM   ----                   
 ,A.PATIENT_FUL  ---------                                                                                              
 ,A.NOTE_DT_FUL                                                                                                         
 ,DECODE(A.TYP_CD, 'TR', 'PL', A.TYP_CD)  TYP_CD                                                                        
 ,A.NOTE_FUL                                                                                                            
 ,A.DOCNUM       ------------                                                                                           
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_COMMENTS_CM A,                                                                                  
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.NOTE_FUL IS NOT NULL                                                                                            
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     PH                                               
C_PH_CM_DEL                                                                                                             
select                                                                                                                  
  'PH'                                                FILE_ID                                                           
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                             PATIENT                                                           
 ,NOTE_DT                            KEY1                                                                               
 ,:P_FILE_ID                          KEY2                                                                              
 ,TYP_CD                             KEY3                                                                               
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,'PH '||                                                                                                               
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 48, ' ')||                                                             
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||NOTE_DT||EXT_UTIL_PKG.F_VAR(:P_FILE_ID, 3)      LINE_TEXT                                                  
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 NOTE_DT, KEY3 TYP_CD                                                            
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = 'PH'                                                                                                   
   AND KEY2 = :P_FILE_ID                                                                                                
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)      PATIENT                                                                 
      ,EXT_UTIL_PKG.F_FORMAT_DATE(NOTE_DT_FUL)  KEY1                                                                    
      ,EXT_UTIL_PKG.F_VAR(DECODE(TYP_CD, 'TR', 'PL', TYP_CD), 3)            KEY3                                        
  FROM PP_EXT_OWNER.CTSC_COMMENTS_CM                                                                                    
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     PK                                               
C_PK                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)                KEY1                                                             
 ,EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)              KEY2                                                             
 ,EXT_UTIL_PKG.F_FORMAT_TIME(START_TIME_FUL)           KEY3                                                             
 ,EXT_UTIL_PKG.F_VAR(SAMPL_SPCMN_FUL, 8)               KEY4                                                             
 ,EXT_UTIL_PKG.F_TO_CHAR(INJECT_DURATN_FUL, 2, 0)      KEY5                                                             
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_FORMAT_TIME(START_TIME_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(SAMPL_SPCMN_FUL, 8)||                                                                            
    EXT_UTIL_PKG.F_TO_CHAR(INJECT_DURATN_FUL, 2, 0)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(PRNT_DRUG_ASSAY_FUL1, 8, 3)||                                                                
    EXT_UTIL_PKG.F_VAR(PRNT_DRUG_ASSAY_UOM_FUL1, 10)||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PRNT_DRUG_ASSAY_FUL2, 8, 3)||                                                                
    EXT_UTIL_PKG.F_VAR(PRNT_DRUG_ASSAY_UOM_FUL2, 10)||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(PRNT_DRUG_MEAN_CONC_FUL, 8, 3)||                                                             
    EXT_UTIL_PKG.F_VAR(PRNT_DRG_MN_CONC_UOM_FUL, 10)||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(METABOLITE_ASSAY_FUL1, 8, 3)||                                                               
    EXT_UTIL_PKG.F_VAR(METABOLITE_ASSAY_UOM_FUL1, 10)||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(METABOLITE_ASSAY_FUL2, 8, 3)||                                                               
    EXT_UTIL_PKG.F_VAR(METABOLITE_ASSAY_UOM_FUL2, 10)||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MTBLIT_MEAN_CONC_FUL, 8, 3)||                                                                
    EXT_UTIL_PKG.F_VAR(MTBLIT_MEAN_CONC_UOM_FUL, 10)             LINE_TEXT                                              
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.DOSE_DT_FUL)     COURSE_NUM   ----                           
 ,A.PATIENT_FUL                                                                                                         
 ,A.CTMS_AGENT_FUL                                                                                                      
 ,A.DOSE_DT_FUL                                                                                                         
 ,A.START_TIME_FUL                                                                                                      
 ,A.SAMPL_SPCMN_FUL                                                                                                     
 ,A.INJECT_DURATN_FUL                                                                                                   
 ,A.PRNT_DRUG_ASSAY_FUL1                                                                                                
 ,A.PRNT_DRUG_ASSAY_UOM_FUL1                                                                                            
 ,A.PRNT_DRUG_ASSAY_FUL2                                                                                                
 ,A.PRNT_DRUG_ASSAY_UOM_FUL2                                                                                            
 ,A.PRNT_DRUG_MEAN_CONC_FUL                                                                                             
 ,A.PRNT_DRG_MN_CONC_UOM_FUL                                                                                            
 ,A.METABOLITE_ASSAY_FUL1                                                                                               
 ,A.METABOLITE_ASSAY_UOM_FUL1                                                                                           
 ,A.METABOLITE_ASSAY_FUL2                                                                                               
 ,A.METABOLITE_ASSAY_UOM_FUL2                                                                                           
 ,A.MTBLIT_MEAN_CONC_FUL                                                                                                
 ,A.MTBLIT_MEAN_CONC_UOM_FUL                                                                                            
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PHARMACOKINETICS  A,                                                                            
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     PK                                               
C_PK_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,CTMS_AGENT                                 KEY1                                                                       
 ,DOSE_DT                                          KEY2                                                                 
 ,START_TIME                                       KEY3                                                                 
 ,SAMPL_SPCMN                                       KEY4                                                                
 ,INJECT_DURATN                                     KEY5                                                                
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||CTMS_AGENT||DOSE_DT||START_TIME||SAMPL_SPCMN||INJECT_DURATN        LINE_TEXT                               
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT,                                                                                      
       KEY1 CTMS_AGENT, KEY2 DOSE_DT, KEY3 START_TIME, KEY4 SAMPL_SPCMN, KEY5 INJECT_DURATN                             
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)              PATIENT                                                         
      ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)            KEY1                                                            
      ,EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)          KEY2                                                            
      ,EXT_UTIL_PKG.F_FORMAT_TIME(START_TIME_FUL)       KEY3                                                            
      ,EXT_UTIL_PKG.F_VAR(SAMPL_SPCMN_FUL, 8)           KEY4                                                            
      ,EXT_UTIL_PKG.F_TO_CHAR(INJECT_DURATN_FUL, 5, 0)  KEY5                                                            
  FROM PP_EXT_OWNER.CTSC_PHARMACOKINETICS                                                                               
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     PL                                               
C_PL_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
 ,LAB_DT                                     KEY1                                                                       
 ,TIME                                     KEY2                                                                         
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LAB_DT||TIME         LINE_TEXT                                                                             
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LAB_DT, KEY2 TIME                                                               
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)     PATIENT                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)  KEY1                                                                     
      ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)    KEY2                                                                     
  FROM PP_EXT_OWNER.CTSC_VITAL_SIGNS                                                                                    
UNION ALL (                                                                                                             
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)     PATIENT                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)  KEY1                                                                     
      ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)    KEY2                                                                     
  FROM PP_EXT_OWNER.CTSC_TRANSFUSION                                                                                    
)  )                                                                                                                    
)                                                                                                                       
                                                                                                                        
THER_STD                       THERADEX                       T310     PL                                               
C_PL_PLCD                                                                                                               
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)         KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)||                                                                              
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(' ', 130)||                                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(FRESH_BLOOD_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR(STORED_BLOOD_FUL, 9, 3)||' '||                                                               
    EXT_UTIL_PKG.F_TO_CHAR(FRESH_RED_CELLS_FUL, 9, 3)||' '               LINE_TEXT                                      
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.LAB_DT)     COURSE_NUM   ----                                
 ,A.PATIENT_FUL                                                                                                         
 ,A.LAB_DT             SMPL_DT                                                                                          
 ,A.LAB_TIME           SMPL_TM                                                                                          
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.FRESH_BLOOD_FUL                                                                                                     
 ,A.FRESH_RED_CELLS_FUL                                                                                                 
 ,A.PACKED_WHITE_CELLS_FUL                                                                                              
 ,A.PLATELETS_FUL                                                                                                       
 ,A.STORED_BLOOD_FUL                                                                                                    
 ,A.STORED_RED_CELLS_FUL                                                                                                
 ,A.REG_INST_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,A.TIME_FUL                                                                                                            
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_TRANSFUSION A,                                                                                  
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     PL                                               
C_PL_PLTR                                                                                                               
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)         KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)||                                                                              
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(' ', 80)||                                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(FRESH_BLOOD_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR(STORED_BLOOD_FUL, 9, 3)||' '||                                                               
    EXT_UTIL_PKG.F_TO_CHAR(FRESH_RED_CELLS_FUL, 9, 3)||' '||                                                            
    EXT_UTIL_PKG.F_TO_CHAR(STORED_RED_CELLS_FUL, 9, 3)||' '||                                                           
    EXT_UTIL_PKG.F_TO_CHAR(PACKED_WHITE_CELLS_FUL, 9, 3)||' '||                                                         
    EXT_UTIL_PKG.F_TO_CHAR(PLATELETS_FUL, 9, 3)||' '                 LINE_TEXT                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.LAB_DT)     COURSE_NUM   ----                                
 ,A.PATIENT_FUL                                                                                                         
 ,A.LAB_DT             SMPL_DT                                                                                          
 ,A.LAB_TIME           SMPL_TM                                                                                          
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.FRESH_BLOOD_FUL                                                                                                     
 ,A.FRESH_RED_CELLS_FUL                                                                                                 
 ,A.PACKED_WHITE_CELLS_FUL                                                                                              
 ,A.PLATELETS_FUL                                                                                                       
 ,A.STORED_BLOOD_FUL                                                                                                    
 ,A.STORED_RED_CELLS_FUL                                                                                                
 ,A.REG_INST_FUL                                                                                                        
 ,A.TIME_FUL                                                                                                            
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_TRANSFUSION A,                                                                                  
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     PL                                               
C_PL_PLVS                                                                                                               
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)         KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL)||                                                                              
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(PERF_ZUBROD_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR(HEIGHT_CM_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(WEIGHT_KG_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(TMP_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(PULSE_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(RESP_RATE_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(SYST_BP_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(DIAST_BP_FUL, 9, 3)||' '            LINE_TEXT                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.LAB_DT)     COURSE_NUM   ----                                
 ,A.PATIENT_FUL                                                                                                         
 ,A.LAB_DT_FUL             SMPL_DT                                                                                      
 ,A.TIME_FUL           SMPL_TM                                                                                          
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.BSA_FUL                                                                                                             
 ,A.HEIGHT_CM_FUL                                                                                                       
 ,A.NOTE_FUL                                                                                                            
 ,DECODE(NVL(INSTR(A.PERF_ZUBROD_FUL, '='), 0), 0, SUBSTR(A.PERF_ZUBROD_FUL, 1, 3),                                     
               SUBSTR(A.PERF_ZUBROD_FUL, 1, INSTR(A.PERF_ZUBROD_FUL, '=') - 1)) PERF_ZUBROD_FUL                         
 ,A.WEIGHT_KG_FUL                                                                                                       
 ,A.DIAST_BP_FUL                                                                                                        
 ,A.PULSE_FUL                                                                                                           
 ,A.RESP_RATE_FUL                                                                                                       
 ,A.SYST_BP_FUL                                                                                                         
 ,A.TMP_FUL                                                                                                             
 ,A.REG_INST_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,A.TIME_FUL                                                                                                            
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_VITAL_SIGNS A,                                                                                  
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     PR                                               
C_PR                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL)         KEY1                                                             
 ,EXT_UTIL_PKG.F_VAR(RADTN_TYPE_FUL, 24)               KEY2                                                             
 ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)               KEY3                                                             
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL)||                                                                      
    EXT_UTIL_PKG.F_VAR(RADTN_TYPE_FUL, 24)||                                                                            
    EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)||                                                                            
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_DOSE_DT_FUL)||                                                                      
    EXT_UTIL_PKG.F_VAR(RT_SITE_FUL, 24)||                                                                               
    EXT_UTIL_PKG.F_VAR(RT_SCHED_FUL, 24)||                                                                              
    EXT_UTIL_PKG.F_VAR(RT_DOSE_FUL, 8)||                                                                                
    EXT_UTIL_PKG.F_VAR(DOSE_UOM_FUL, 8)||                                                                               
    EXT_UTIL_PKG.F_VAR(BEST_RESPS_FUL, 2)||                                                                             
    EXT_UTIL_PKG.F_VAR(THERAPY_TYPE_CODE_FUL, 2)        LINE_TEXT                                                       
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'       COURSE_NUM   ----                                                                                         
 ,A.PATIENT_FUL                                                                                                         
 ,A.FRST_DOSE_DT_FUL                                                                                                    
 ,A.RADTN_TYPE_FUL                                                                                                      
 ,A.REPEATSN                                                                                                            
 ,A.LAST_DOSE_DT_FUL                                                                                                    
 ,NVL(A.RT_SITE_FUL, '*')     RT_SITE_FUL                                                                               
 ,NVL(A.RT_SCHED_FUL, '*')    RT_SCHED_FUL                                                                              
 ,NVL(A.RT_DOSE_FUL, '*')     RT_DOSE_FUL                                                                               
 ,NVL(A.DOSE_UOM_FUL, '*')    DOSE_UOM_FUL                                                                              
 ,NVL(A.BEST_RESPS_FUL, '*')  BEST_RESPS_FUL                                                                            
 ,A.THERAPY_TYPE_CODE_FUL                                                                                               
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_RAD_SUPP A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     PR                                               
C_PR_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,FRST_DOSE_DT                                 KEY1                                                                     
 ,RADTN_TYPE                                         KEY2                                                               
 ,REPEATSN                                            KEY3                                                              
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||FRST_DOSE_DT||RADTN_TYPE||REPEATSN        LINE_TEXT                                                        
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 FRST_DOSE_DT, KEY2 RADTN_TYPE, KEY3 REPEATSN                                    
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)           PATIENT                                                            
      ,EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL)  KEY1                                                               
      ,EXT_UTIL_PKG.F_VAR(RADTN_TYPE_FUL, 24)        KEY2                                                               
      ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)        KEY3                                                               
  FROM PP_EXT_OWNER.CTSC_PRIOR_RAD_SUPP                                                                                 
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     PS                                               
C_PS                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SURG_DT_FUL)                 KEY1                                                          
 ,EXT_UTIL_PKG.F_VAR(PROC_FUL||' - '||ANAT_SITE_FUL, 24)  KEY2                                                          
 ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)                  KEY3                                                          
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SURG_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(PROC_FUL||' - '||ANAT_SITE_FUL, 24)||                                                            
    EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)||                                                                            
    EXT_UTIL_PKG.F_VAR(FIND_FUL, 24)||                                                                                  
    EXT_UTIL_PKG.F_VAR(ESID_DIS_EXTENT_FUL, 24)||                                                                       
    EXT_UTIL_PKG.F_VAR(THERAPEUTIC_IND_FUL, 1)          LINE_TEXT                                                       
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'       COURSE_NUM   ----                                                                                         
 ,A.PATIENT_FUL                                                                                                         
 ,A.SURG_DT_FUL                                                                                                         
 ,A.PROC_FUL                                                                                                            
 ,A.ANAT_SITE_FUL                                                                                                       
 ,A.REPEATSN                                                                                                            
 ,NVL(A.FIND_FUL, '*')             FIND_FUL                                                                             
 ,NVL(A.RESID_DIS_EXTENT_FUL, '*')  ESID_DIS_EXTENT_FUL                                                                 
 ,THERAPEUTIC_IND_FUL                                                                                                   
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_SURG_SUPP A,                                                                              
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     PS                                               
C_PS_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SURG_DT               KEY1                                                                                            
 ,PROC                  KEY2                                                                                            
 ,REPEATSN              KEY3                                                                                            
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SURG_DT|| PROC||REPEATSN          LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SURG_DT, KEY2 PROC, KEY3 REPEATSN                                               
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                     PATIENT                                                  
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SURG_DT_FUL)                 KEY1                                                     
      ,EXT_UTIL_PKG.F_VAR(PROC_FUL||' - '||ANAT_SITE_FUL, 24)  KEY2                                                     
      ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)                  KEY3                                                     
  FROM PP_EXT_OWNER.CTSC_PRIOR_SURG_SUPP                                                                                
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     PT                                               
C_PT                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL)       KEY1                                                               
 ,EXT_UTIL_PKG.F_VAR(AGT_NM_FUL, 24)                 KEY2                                                               
 ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)             KEY3                                                               
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL)||                                                                      
    EXT_UTIL_PKG.F_VAR(AGT_NM_FUL, 24)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)||                                                                            
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_DOSE_DT_FUL)||                                                                      
    EXT_UTIL_PKG.F_VAR(MED_SCHED_FUL, 24)||                                                                             
    EXT_UTIL_PKG.F_VAR(TOT_DOSE_FUL, 8)||                                                                               
    EXT_UTIL_PKG.F_VAR(AGENT_UOM_FUL, 12)||                                                                             
    EXT_UTIL_PKG.F_VAR(BEST_RESPS_FUL, 2)||                                                                             
    EXT_UTIL_PKG.F_VAR(THERAPY_TYPE_CODE_FUL, 2)          LINE_TEXT                                                     
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'              COURSE_NUM   ----                                                                                  
 ,A.PATIENT_FUL                                                                                                         
 ,A.FRST_DOSE_DT_FUL                                                                                                    
 ,A.AGT_NM_FUL                                                                                                          
 ,A.REPEATSN                                                                                                            
 ,A.LAST_DOSE_DT_FUL                                                                                                    
 ,NVL(A.MED_SCHED_FUL, '*')   MED_SCHED_FUL                                                                             
 ,NVL(A.TOT_DOSE_FUL, '*')    TOT_DOSE_FUL                                                                              
 ,NVL(A.AGENT_UOM_FUL, '*')   AGENT_UOM_FUL                                                                             
 ,NVL(A.BEST_RESPS_FUL, '*')  BEST_RESPS_FUL                                                                            
 ,A.THERAPY_TYPE_CODE_FUL                                                                                               
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_THRPY_SUPP A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
END                                                                                                                     
                                                                                                                        
THER_STD                       THERADEX                       T310     PT                                               
C_PT_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,FRST_DOSE_DT                                 KEY1                                                                     
 ,AGT_NM                                             KEY2                                                               
 ,REPEATSN                                         KEY3                                                                 
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||FRST_DOSE_DT||AGT_NM||REPEATSN      LINE_TEXT                                                              
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 FRST_DOSE_DT, KEY2 AGT_NM, KEY3 REPEATSN                                        
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(FRST_DOSE_DT_FUL) KEY1                                                                
      ,EXT_UTIL_PKG.F_VAR(AGT_NM_FUL, 24)           KEY2                                                                
      ,EXT_UTIL_PKG.F_TO_CHAR(REPEATSN, 8, 0)       KEY3                                                                
  FROM PP_EXT_OWNER.CTSC_PRIOR_THRPY_SUPP                                                                               
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     RC                                               
C_LAB_OTH_RC                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
           EXT_UTIL_PKG.F_TO_CHAR(MCH_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(MCHC_FUL, 9, 3)||' '||                                                                
           EXT_UTIL_PKG.F_TO_CHAR(MCV_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(BLEED_TIME_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(CLOT_RETR_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(SEMI_QUANT_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(QUANT_FUL, 9, 3)||' '||                                                               
           EXT_UTIL_PKG.F_TO_CHAR(CLOT_TIME_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(FDP_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(FIBRINOGEN_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(THROMB_TIM_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(NUCL_RBCS_FUL, 9, 3)||' '||                                                           
           EXT_UTIL_PKG.F_TO_CHAR(COMPLEMENT_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(COOMBS_TST_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(ANF_FUL, 9, 3)||' '||                                                                 
           EXT_UTIL_PKG.F_TO_CHAR(TOT_SER_PR_FUL, 9, 3)||' '||                                                          
           EXT_UTIL_PKG.F_TO_CHAR(ALBUMIN_FUL, 9, 3)||' '||                                                             
           EXT_UTIL_PKG.F_TO_CHAR(ALPHA1_FUL, 9, 3)||' '||                                                              
           EXT_UTIL_PKG.F_TO_CHAR(ALPHA2_FUL, 9, 3)||' '||                                                              
           EXT_UTIL_PKG.F_TO_CHAR(BETA_FUL, 9, 3)||' '||                                                                
           EXT_UTIL_PKG.F_TO_CHAR(GAMMA_FUL, 9, 3)||' '         LINE_TEXT                                               
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_RC A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
THER_STD                       THERADEX                       T310     RC                                               
C_LAB_OTH_RC_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     RC                                               
C_RC                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(MCH_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(MCHC_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(MCV_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(BLEED_TIME_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(CLOT_RETR_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(SEMI_QUANT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(QUANT_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(CLOT_TIME_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(FDP_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(FIBRINOGEN_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(THROMB_TIM_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(NUCL_RBCS_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(COMPLEMENT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_POS_NEG(COOMBS_TST_FUL, 9, 3)||' '||                                                         
    EXT_UTIL_PKG.F_TO_CHAR(ANF_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(TOT_SER_PR_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(ALBUMIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(ALPHA1_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(ALPHA2_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BETA_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(GAMMA_FUL, 9, 3)||' '             LINE_TEXT                                                  
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.MCH_FUL                                                                                                             
 ,A.MCHC_FUL                                                                                                            
 ,A.MCV_FUL                                                                                                             
 ,A.BLEED_TIME_FUL                                                                                                      
 ,A.CLOT_RETR_FUL                                                                                                       
 ,A.SEMI_QUANT_FUL                                                                                                      
 ,A.QUANT_FUL                                                                                                           
 ,A.CLOT_TIME_FUL                                                                                                       
 ,A.FDP_FUL                                                                                                             
 ,A.FIBRINOGEN_FUL                                                                                                      
 ,A.THROMB_TIM_FUL                                                                                                      
 ,A.NUCL_RBCS_FUL                                                                                                       
 ,A.COMPLEMENT_FUL                                                                                                      
 ,A.COOMBS_TST_FUL                                                                                                      
 ,A.ANF_FUL                                                                                                             
 ,A.TOT_SER_PR_FUL                                                                                                      
 ,A.ALBUMIN_FUL                                                                                                         
 ,A.ALPHA1_FUL                                                                                                          
 ,A.ALPHA2_FUL                                                                                                          
 ,A.BETA_FUL                                                                                                            
 ,A.GAMMA_FUL                                                                                                           
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_RC A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     RC                                               
C_RC_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_RC                                                                                         
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     RF                                               
C_LAB_OTH_RF                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(ACIDITY_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(PART_CO2_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(PARTIAL_O2_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(BICARB_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BASE_EXC_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(BASE_DEF_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(OXYGEN_SAT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(CARB_MONOX_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(METHEMOGLO_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(VITAL_CAP_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(EXP_VOL_1_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(MAX_CAP_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(RESID_VOL_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(TIDAL_VOL_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(FUN_RES_CP_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PULM_COMPL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(DIFF_CAPAC_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MAX_EXP_FL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MID_EXP_FL_FUL, 9, 3)||' '       LINE_TEXT                                                   
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_RF A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
THER_STD                       THERADEX                       T310     RF                                               
C_LAB_OTH_RF_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     RF                                               
C_RF                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(ACIDITY_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(PART_CO2_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(PARTIAL_O2_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(BICARB_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BASE_EXC_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(BASE_DEF_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(OXYGEN_SAT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(CARB_MONOX_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(METHEMOGLO_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(VITAL_CAP_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(EXP_VOL_1_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(MAX_CAP_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(RESID_VOL_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(TIDAL_VOL_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(FUN_RES_CP_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(PULM_COMPL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(DIFF_CAPAC_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MAX_EXP_FL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(MID_EXP_FL_FUL, 9, 3)||' '         LINE_TEXT                                                 
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.ACIDITY_FUL                                                                                                         
 ,A.PART_CO2_FUL                                                                                                        
 ,A.PARTIAL_O2_FUL                                                                                                      
 ,A.BICARB_FUL                                                                                                          
 ,A.BASE_EXC_FUL                                                                                                        
 ,A.BASE_DEF_FUL                                                                                                        
 ,A.OXYGEN_SAT_FUL                                                                                                      
 ,A.CARB_MONOX_FUL                                                                                                      
 ,A.METHEMOGLO_FUL                                                                                                      
 ,A.VITAL_CAP_FUL                                                                                                       
 ,A.EXP_VOL_1_FUL                                                                                                       
 ,A.MAX_CAP_FUL                                                                                                         
 ,A.RESID_VOL_FUL                                                                                                       
 ,A.TIDAL_VOL_FUL                                                                                                       
 ,A.FUN_RES_CP_FUL                                                                                                      
 ,A.PULM_COMPL_FUL                                                                                                      
 ,A.DIFF_CAPAC_FUL                                                                                                      
 ,A.MAX_EXP_FL_FUL                                                                                                      
 ,A.MID_EXP_FL_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_RF A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     RF                                               
C_RF_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_RF                                                                                         
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     SC                                               
C_LAB_OTH_SC                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(ALDOLASE_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(AMMONIA_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(COPPER_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(FERRITIN_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(HDL_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(INSULIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(IRON_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IRON_BIND_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(IRON_SAT_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(LDL_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(LIPASE_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(OSMOLALITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(ACID_PHOS_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(TRANSFERRI_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(TRIGLYC_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(T3_FUL, 9, 3)||' '||                                                                         
    EXT_UTIL_PKG.F_TO_CHAR(T4_FUL, 9, 3)||' '||                                                                         
    EXT_UTIL_PKG.F_TO_CHAR(TSH_FUL, 9, 3)||' '         LINE_TEXT                                                        
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_SC A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
THER_STD                       THERADEX                       T310     SC                                               
C_LAB_OTH_SC_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     SC                                               
C_SC                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(ALDOLASE_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(AMMONIA_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(CALCIUM_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(COPPER_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(FERRITIN_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(HDL_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(INSULIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(IRON_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IRON_BIND_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(IRON_SAT_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(LDL_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(LIPASE_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(OSMOLALITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(ACID_PHOS_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(TRANSFERRI_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(TRIGLYC_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(T3_FUL, 9, 3)||' '||                                                                         
    EXT_UTIL_PKG.F_TO_CHAR(T4_FUL, 9, 3)||' '||                                                                         
    EXT_UTIL_PKG.F_TO_CHAR(TSH_FUL, 9, 3)||' '        LINE_TEXT                                                         
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.ALDOLASE_FUL                                                                                                        
 ,A.AMMONIA_FUL                                                                                                         
 ,A.CALCIUM_FUL                                                                                                         
 ,A.COPPER_FUL                                                                                                          
 ,A.FERRITIN_FUL                                                                                                        
 ,A.HDL_FUL                                                                                                             
 ,A.INSULIN_FUL                                                                                                         
 ,A.IRON_FUL                                                                                                            
 ,A.IRON_BIND_FUL                                                                                                       
 ,A.IRON_SAT_FUL                                                                                                        
 ,A.LDL_FUL                                                                                                             
 ,A.LIPASE_FUL                                                                                                          
 ,A.OSMOLALITY_FUL                                                                                                      
 ,A.ACID_PHOS_FUL                                                                                                       
 ,A.TRANSFERRI_FUL                                                                                                      
 ,A.TRIGLYC_FUL                                                                                                         
 ,A.T3_FUL                                                                                                              
 ,A.T4_FUL                                                                                                              
 ,A.TSH_FUL                                                                                                             
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_SC A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     SC                                               
C_SC_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_SC                                                                                         
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     SE                                               
C_LAB_OTH_SE                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(IG_A_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_D_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_E_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_G_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_M_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(MONOCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(POLYCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(KAPPA_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(LAMBDA_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BENCEJONES_FUL, 9, 3)||' '      LINE_TEXT                                                    
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_SE A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
THER_STD                       THERADEX                       T310     SE                                               
C_LAB_OTH_SE_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     SE                                               
C_SE                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(IG_A_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_D_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_E_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_G_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_M_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(MONOCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(POLYCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(KAPPA_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(LAMBDA_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BENCEJONES_FUL, 9, 3)||' '        LINE_TEXT                                                  
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.IG_A_FUL                                                                                                            
 ,A.IG_D_FUL                                                                                                            
 ,A.IG_E_FUL                                                                                                            
 ,A.IG_G_FUL                                                                                                            
 ,A.IG_M_FUL                                                                                                            
 ,A.MONOCLONAL_FUL                                                                                                      
 ,A.POLYCLONAL_FUL                                                                                                      
 ,A.KAPPA_FUL                                                                                                           
 ,A.LAMBDA_FUL                                                                                                          
 ,A.BENCEJONES_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_SE A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     SE                                               
C_SE_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_SE                                                                                         
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     SH                                               
C_SH                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)       KEY1                                                                
 ,''                                KEY2                                                                                
 ,''                                    KEY3                                                                            
 ,''                                    KEY4                                                                            
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_COLLCT_DT_FUL)||                                                                    
    EXT_UTIL_PKG.F_VAR(NCLD_NM_FUL1 , 8)||                                                                              
    EXT_UTIL_PKG.F_TO_CHAR(ALIQ_CNT_ML_FUL1, 8, 3)||                                                                    
    EXT_UTIL_PKG.F_VAR(AB_NM_FUL1 , 8)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(COR_ALIQ_CPM_FUL1, 9, 0)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(TOT_ADMIN_ML_FUL1, 8, 3)||                                                                   
    EXT_UTIL_PKG.F_VAR(NCLD_NM_FUL2 , 8)||                                                                              
    EXT_UTIL_PKG.F_TO_CHAR(ALIQ_CNT_ML_FUL2, 8, 3)||                                                                    
    EXT_UTIL_PKG.F_VAR(AB_NM_FUL2 , 8)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(COR_ALIQ_CPM_FUL2, 9, 0)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(TOT_ADMIN_ML_FUL2, 8, 3)        LINE_TEXT                                                    
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_COLLCT_DT_FUL)     COURSE_NUM   ----                    
 ,A.PATIENT_FUL                                                                                                         
 ,A.TRIAL_NUM_FUL                                                                                                       
 ,A.SMPL_COLLCT_DT_FUL                                                                                                  
 ,A.NCLD_NM_FUL1                                                                                                        
 ,A.ALIQ_CNT_ML_FUL1                                                                                                    
 ,A.AB_NM_FUL1                                                                                                          
 ,A.COR_ALIQ_CPM_FUL1                                                                                                   
 ,A.TOT_ADMIN_ML_FUL1                                                                                                   
 ,A.NCLD_NM_FUL2                                                                                                        
 ,A.ALIQ_CNT_ML_FUL2                                                                                                    
 ,A.AB_NM_FUL2                                                                                                          
 ,A.COR_ALIQ_CPM_FUL2                                                                                                   
 ,A.TOT_ADMIN_ML_FUL2                                                                                                   
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_SCINTIGRAPHY_HEADER A,                                                                          
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     SH                                               
C_SH_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,TRIAL_NUM                                 KEY1                                                                        
 ,''                                        KEY2                                                                        
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||TRIAL_NUM             LINE_TEXT                                                                            
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 TRIAL_NUM                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)  KEY1                                                                
  FROM PP_EXT_OWNER.CTSC_SCINTIGRAPHY_HEADER                                                                            
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     SR                                               
C_LAB_OTH_SR                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(PSA_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(CA125_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(CEA_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(CA19_9_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(CA15_3_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(CA27_29_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(AFP_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(HCG_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(HIV_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(HBS_AG_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(PREGNANT_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(STOOL_GUAIAC_FUL, 9, 3)||' '     LINE_TEXT                                                   
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_SR A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
THER_STD                       THERADEX                       T310     SR                                               
C_LAB_OTH_SR_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     SR                                               
C_SR                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(PSA_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(CA125_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(CEA_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(CA19_9_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(CA15_3_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(CA27_29_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(AFP_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(HCG_FUL, 9, 3)||' '||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR_POS_NEG(HIV_FUL, 9, 3)||' '||                                                                
    EXT_UTIL_PKG.F_TO_CHAR_POS_NEG(HBS_AG_FUL, 9, 3)||' '||                                                             
    EXT_UTIL_PKG.F_TO_CHAR_POS_NEG(PREGNANT_FUL, 9, 3)||' '||                                                           
    EXT_UTIL_PKG.F_TO_CHAR_POS_NEG(STOOL_GUAIAC_FUL, 9, 3)||' '        LINE_TEXT                                        
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.PSA_FUL                                                                                                             
 ,A.CA125_FUL                                                                                                           
 ,A.CEA_FUL                                                                                                             
 ,A.CA19_9_FUL                                                                                                          
 ,A.CA15_3_FUL                                                                                                          
 ,A.CA27_29_FUL                                                                                                         
 ,A.AFP_FUL                                                                                                             
 ,A.HCG_FUL                                                                                                             
 ,A.HIV_FUL                                                                                                             
 ,A.HBS_AG_FUL                                                                                                          
 ,A.PREGNANT_FUL                                                                                                        
 ,A.STOOL_GUAIAC_FUL                                                                                                    
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_SR A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     SR                                               
C_SR_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_SR                                                                                         
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     SS                                               
C_SS                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)        KEY1                                                               
 ,EXT_UTIL_PKG.F_TO_CHAR(SMPL_ID_NUM_FUL, 2, 0)      KEY2                                                               
 ,''                                    KEY3                                                                            
 ,''                                    KEY4                                                                            
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(SMPL_ID_NUM_FUL, 2, 0)||                                                                     
    EXT_UTIL_PKG.F_VAR(SRCE_ORG_FUL, 8)||                                                                               
    EXT_UTIL_PKG.F_VAR(SMPL_DESCR_FUL, 18)||                                                                            
    EXT_UTIL_PKG.F_VAR(TIS_CLAS_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_VAR(GAMMA_SCAN_POS_FUL, 1)||                                                                         
    EXT_UTIL_PKG.F_VAR(CT_POS_FUL, 1)||                                                                                 
    EXT_UTIL_PKG.F_VAR(SURG_BIOPSY_FUL, 1)||                                                                            
    EXT_UTIL_PKG.F_TO_CHAR(SMPL_WT_GRAM_FUL, 8, 3)||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(PCT_TUMOR_FUL, 8, 3)||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(CRCT_CPM_NUCLIDE_FUL1, 9, 0)||                                                               
    EXT_UTIL_PKG.F_TO_CHAR(CRCT_CPM_NUCLIDE_FUL2, 9, 0)          LINE_TEXT                                              
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_COLLCT_DT_FUL)     COURSE_NUM   ----                    
 ,A.PATIENT_FUL                                                                                                         
 ,A.TRIAL_NUM_FUL                                                                                                       
 ,A.SMPL_ID_NUM_FUL                                                                                                     
 ,A.SRCE_ORG_FUL                                                                                                        
 ,A.SMPL_DESCR_FUL                                                                                                      
 ,A.TIS_CLAS_FUL                                                                                                        
 ,A.GAMMA_SCAN_POS_FUL                                                                                                  
 ,A.CT_POS_FUL                                                                                                          
 ,A.SURG_BIOPSY_FUL                                                                                                     
 ,A.SMPL_WT_GRAM_FUL                                                                                                    
 ,A.PCT_TUMOR_FUL                                                                                                       
 ,A.CRCT_CPM_NUCLIDE_FUL1                                                                                               
 ,A.CRCT_CPM_NUCLIDE_FUL2                                                                                               
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_SCINTIGRAPHY A,                                                                                 
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     SS                                               
C_SS_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,TRIAL_NUM                                 KEY1                                                                        
 ,SMPL_ID_NUM                                       KEY2                                                                
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||TRIAL_NUM||SMPL_ID_NUM         LINE_TEXT                                                                   
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 TRIAL_NUM, KEY2 SMPL_ID_NUM                                                     
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)            PATIENT                                                           
      ,EXT_UTIL_PKG.F_TO_CHAR(TRIAL_NUM_FUL, 2, 0)    KEY1                                                              
      ,EXT_UTIL_PKG.F_TO_CHAR(SMPL_ID_NUM_FUL, 3, 0)  KEY2                                                              
  FROM PP_EXT_OWNER.CTSC_SCINTIGRAPHY                                                                                   
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     TF                                               
C_TF                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,''                                 KEY1                                                                               
 ,''                                    KEY2                                                                            
 ,''                                    KEY3                                                                            
 ,''                                    KEY4                                                                            
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_VAR(CHEMO_SING_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_CHEM_S_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(CHEMO_MULT_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_CHEM_M_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(CHEMO_UNKN_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_CHEM_U_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(HORMONAL_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_HORM_FUL)||                                                                         
    EXT_UTIL_PKG.F_VAR(SURGERY_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_SURG_FUL)||                                                                         
    EXT_UTIL_PKG.F_VAR(IMMUNOTHER_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_IMM_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(EXTENS_RAD_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_EX_RAD_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(LIM_RAD_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_LM_RAD_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(RAD_UNKN_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_UN_RAD_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(BONE_MARR_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_BMT_FUL)||                                                                          
    EXT_UTIL_PKG.F_VAR(GENE_THRPY_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_GENE_FUL)||                                                                         
    EXT_UTIL_PKG.F_VAR(OTH_THRPY_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_OTHER_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(NON_CYTO_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_NOCYT_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(ANTI_RTVIR_FUL, 1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_ANTRTV_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(ANTISENSE_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_ANTISNS_FUL)||                                                                       
    EXT_UTIL_PKG.F_VAR(ONCO_VIRO_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_FORMAT_DATE(LST_ONCVIR_FUL)||                                                                        
    EXT_UTIL_PKG.F_VAR(VACCINE_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_FORMAT_DATE(LAST_VAC_FUL)         LINE_TEXT                                                          
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'  0'                           COURSE_NUM   ----                                                                     
 ,A.PATIENT_FUL                                                                                                         
 ,A.CHEMO_SING_FUL                                                                                                      
 ,A.LST_CHEM_S_FUL                                                                                                      
 ,A.CHEMO_MULT_FUL                                                                                                      
 ,A.LST_CHEM_M_FUL                                                                                                      
 ,A.CHEMO_UNKN_FUL                                                                                                      
 ,A.LST_CHEM_U_FUL                                                                                                      
 ,A.HORMONAL_FUL                                                                                                        
 ,A.LAST_HORM_FUL                                                                                                       
 ,A.SURGERY_FUL                                                                                                         
 ,A.LAST_SURG_FUL                                                                                                       
 ,A.IMMUNOTHER_FUL                                                                                                      
 ,A.LAST_IMM_FUL                                                                                                        
 ,A.EXTENS_RAD_FUL                                                                                                      
 ,A.LST_EX_RAD_FUL                                                                                                      
 ,A.LIM_RAD_FUL                                                                                                         
 ,A.LST_LM_RAD_FUL                                                                                                      
 ,A.RAD_UNKN_FUL                                                                                                        
 ,A.LST_UN_RAD_FUL                                                                                                      
 ,A.BONE_MARR_FUL                                                                                                       
 ,A.LAST_BMT_FUL                                                                                                        
 ,A.GENE_THRPY_FUL                                                                                                      
 ,A.LAST_GENE_FUL                                                                                                       
 ,A.OTH_THRPY_FUL                                                                                                       
 ,A.LAST_OTHER_FUL                                                                                                      
 ,A.NON_CYTO_FUL                                                                                                        
 ,A.LAST_NOCYT_FUL                                                                                                      
 ,A.ANTI_RTVIR_FUL                                                                                                      
 ,A.LST_ANTRTV_FUL                                                                                                      
 ,A.ANTISENSE_FUL                                                                                                       
 ,A.LST_ANTISNS_FUL                                                                                                     
 ,A.ONCO_VIRO_FUL                                                                                                       
 ,A.LST_ONCVIR_FUL                                                                                                      
 ,A.VACCINE_FUL                                                                                                         
 ,A.LAST_VAC_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_PRIOR_TREAT_SUMM A,                                                                             
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     TF                                               
C_TF_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,''                                 KEY1                                                                               
 ,''                           KEY2                                                                                     
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT        LINE_TEXT                                                                                            
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT                                                                                       
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12) PATIENT                                                                      
  FROM PP_EXT_OWNER.CTSC_PRIOR_TREAT_SUMM                                                                               
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     TX                                               
C_TX                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)                KEY1                                                   
 ,EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)                           KEY2                                                   
 ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8) KEY3                                                  
 ,RESOLV_DT_FUL                                   KEY4                                                                  
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)||                                                                   
    EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)||                                                                              
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8)||                                                   
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_CTC_CD_FUL, 10, 0)||                                                                    
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(RESOLV_DT_FUL), 8)||                                                  
    EXT_UTIL_PKG.F_VAR(AER_IND_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(CTC_GRADE_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_VAR(ATTRIBN_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_VAR(DOSE_LIMT_TOX_IND_FUL, 1)||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(AE_SERIOUS_FUL, 2, 0)||                                                                      
    EXT_UTIL_PKG.F_VAR(AE_ACTION_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_VAR(AE_THRPY_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_VAR(AE_OUTCOME_FUL, 1)      LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'   '                       COURSE_NUM   ----                                                                         
 ,A.PATIENT_FUL                                                                                                         
 ,''                                 COURSE_START_DT_FUL                                                                
 ,NVL(A.AE_DESCR_FUL, SUBSTR(A.CTC_TERM_FUL, 1, 33))   AE_DESCR_FUL                                                     
 ,A.ONSET_DT_FUL                                                                                                        
 ,A.ONSET_DT                                                                                                            
 ,A.CDUS_CTC_CD_FUL                                                                                                     
 ,A.RESOLV_DT_FUL                                                                                                       
 ,A.RESOLV_DT                                                                                                           
 ,A.AER_IND_FUL                                                                                                         
 ,SUBSTR(A.CTC_GRADE_FUL, 1, 1)      CTC_GRADE_FUL                                                                      
 ,A.ATTRIBN_FUL                                                                                                         
 ,A.DOSE_LIMT_TOX_IND_FUL                                                                                               
 ,SUBSTR(A.AE_SER_FUL, 1, 1)   AE_SERIOUS_FUL                                                                           
 ,A.AE_ACTION_FUL                                                                                                       
 ,A.AE_THRPY_FUL                                                                                                        
 ,A.AE_OUTCOME_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM ( SELECT E.*                                                                                                      
          FROM PP_EXT_OWNER.CTSC_ADVERSE_EVENTS E                                                                       
         WHERE NOT EXISTS                                                                                               
                 (SELECT 1                                                                                              
                    FROM PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM O                                                             
                   WHERE E.STUDY = O.STUDY                                                                              
                     AND E.PT = O.PT                                                                                    
                     AND RPAD(E.ONSET_DT, 8, '0') >= RPAD(O.OFF_STDY_DT, 8, '0') ) ) A,                                 
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
ORDER BY PATIENT, AE_DESCR_FUL, COURSE_START_DT_FUL, ONSET_DT_FUL                                                       
                                                                                                                        
THER_STD                       THERADEX                       T310     TX                                               
C_TX_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,COURSE_START_DT                            KEY1                                                                       
 ,TOXICITY                                   KEY2                                                                       
 ,ONSET_DT                                   KEY3                                                                       
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||COURSE_START_DT||TOXICITY||ONSET_DT            LINE_TEXT                                                   
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 COURSE_START_DT, KEY2 TOXICITY, KEY3 ONSET_DT                                   
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 COURSE_START_DT, KEY2 TOXICITY, KEY3 ONSET_DT                          
  FROM CT_EXT_TEMP                                                                                                      
 WHERE PROTOCOL = :P_STUDY)  )                                                                                          
                                                                                                                        
THER_STD                       THERADEX                       T310     TX                                               
C_TX_TEMP                                                                                                               
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)                KEY1                                                   
 ,EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)                           KEY2                                                   
 ,EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8) KEY3                                                  
 ,RESOLV_DT_FUL                                  KEY4                                                                   
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(COURSE_START_DT_FUL)||                                                                   
    EXT_UTIL_PKG.F_VAR(AE_DESCR_FUL, 33)||                                                                              
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(ONSET_DT_FUL), 8)||                                                   
    EXT_UTIL_PKG.F_TO_CHAR(CDUS_CTC_CD_FUL, 10, 0)||                                                                    
    EXT_UTIL_PKG.F_VAR(EXT_UTIL_PKG.F_FORMAT_DATE(RESOLV_DT_FUL), 8)||                                                  
    EXT_UTIL_PKG.F_VAR(AER_IND_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_TO_CHAR(CTC_GRADE_FUL, 2, 0)||                                                                       
    EXT_UTIL_PKG.F_VAR(ATTRIBN_FUL, 1)||                                                                                
    EXT_UTIL_PKG.F_VAR(DOSE_LIMT_TOX_IND_FUL, 1)||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(AE_SERIOUS_FUL, 2, 0)||                                                                      
    EXT_UTIL_PKG.F_VAR(AE_ACTION_FUL, 1)||                                                                              
    EXT_UTIL_PKG.F_VAR(AE_THRPY_FUL, 1)||                                                                               
    EXT_UTIL_PKG.F_VAR(AE_OUTCOME_FUL, 1)      LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,'   '                       COURSE_NUM   ----                                                                         
 ,A.PATIENT_FUL                                                                                                         
 ,''                                 COURSE_START_DT_FUL                                                                
 ,NVL(A.AE_DESCR_FUL, SUBSTR(A.CTC_TERM_FUL, 1, 33))   AE_DESCR_FUL                                                     
 ,A.ONSET_DT_FUL                                                                                                        
 ,A.ONSET_DT                                                                                                            
 ,A.CDUS_CTC_CD_FUL                                                                                                     
 ,A.RESOLV_DT_FUL                                                                                                       
 ,A.RESOLV_DT                                                                                                           
 ,A.AER_IND_FUL                                                                                                         
 ,SUBSTR(A.CTC_GRADE_FUL, 1, 1)      CTC_GRADE_FUL                                                                      
 ,A.ATTRIBN_FUL                                                                                                         
 ,A.DOSE_LIMT_TOX_IND_FUL                                                                                               
 ,SUBSTR(A.AE_SER_FUL, 1, 1)   AE_SERIOUS_FUL                                                                           
 ,A.AE_ACTION_FUL                                                                                                       
 ,A.AE_THRPY_FUL                                                                                                        
 ,A.AE_OUTCOME_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM ( SELECT E.*                                                                                                      
          FROM PP_EXT_OWNER.CTSC_ADVERSE_EVENTS E                                                                       
         WHERE NOT EXISTS                                                                                               
                 (SELECT 1                                                                                              
                    FROM PP_EXT_OWNER.CTSC_OFF_STUDY_SUMM O                                                             
                   WHERE E.STUDY = O.STUDY                                                                              
                     AND E.PT = O.PT                                                                                    
                     AND RPAD(E.ONSET_DT, 8, '0') >= RPAD(O.OFF_STDY_DT, 8, '0') ) ) A,                                 
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
ORDER BY PATIENT, AE_DESCR_FUL, COURSE_START_DT_FUL, ONSET_DT_FUL                                                       
                                                                                                                        
THER_STD                       THERADEX                       T310     UE                                               
C_LAB_OTH_UE                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(IG_A_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_D_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_E_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_G_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_M_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(MONOCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(POLYCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(KAPPA_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(LAMBDA_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BENCEJONES_FUL, 9, 3)||' '       LINE_TEXT                                                   
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_UE A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
THER_STD                       THERADEX                       T310     UE                                               
C_LAB_OTH_UE_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     UE                                               
C_UE                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(IG_A_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_D_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_E_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_G_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(IG_M_FUL, 9, 3)||' '||                                                                       
    EXT_UTIL_PKG.F_TO_CHAR(MONOCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(POLYCLONAL_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(KAPPA_FUL, 9, 3)||' '||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(LAMBDA_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(BENCEJONES_FUL, 9, 3)||' '        LINE_TEXT                                                  
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.IG_A_FUL                                                                                                            
 ,A.IG_D_FUL                                                                                                            
 ,A.IG_E_FUL                                                                                                            
 ,A.IG_G_FUL                                                                                                            
 ,A.IG_M_FUL                                                                                                            
 ,A.MONOCLONAL_FUL                                                                                                      
 ,A.POLYCLONAL_FUL                                                                                                      
 ,A.KAPPA_FUL                                                                                                           
 ,A.LAMBDA_FUL                                                                                                          
 ,A.BENCEJONES_FUL                                                                                                      
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_UE A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     UE                                               
C_UE_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_UE                                                                                         
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     UL                                               
C_LAB_OTH_UL                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(DCMDATE)               KEY1                                                                
 ,EXT_UTIL_PKG.F_FORMAT_TIME(DCMTIME)               KEY2                                                                
 ,EXT_UTIL_PKG.F_VAR(LAB_TEST, 8)                   KEY3                                                                
 ,'        '                                       KEY4                                                                 
 ,''                                               KEY5                                                                 
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            

OC_STUDY                       REPORT_TO                      VERSION  FILE_ID                                          
------------------------------ ------------------------------ -------- ------------------------------                   
CRS_NAME                                                                                                                
------------------------------                                                                                          
TEXT                                                                                                                    
------------------------------------------------------------------------------------------------------------------------
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
           EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                     
           EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                        
           EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                        
           EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                       
           A_FILLER||                                                                                                   
           DEL_FLAG||                                                                                                   
           DEL_DATE||                                                                                                   
           EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                              
           EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                             
           ENTRY_PASS||                                                                                                 
           TOUCH_DATE||                                                                                                 
           TOUCH_TIMER||                                                                                                
           COURSE_NUM||               ------------                                                                      
           EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                        
           EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                        
           EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                        
           EXT_UTIL_PKG.F_VAR(LAB_TEST, 8)||                                                                            
           EXT_UTIL_PKG.F_VAR(BODY_SITE, 8)||                                                                           
           LAB_GROUP||                                                                                                  
           LAB_CODE||                                                                                                   
           EXT_UTIL_PKG.F_VAR_OTH_UL_NA(LAB_RANGE_IND, 1)||                                                             
           EXT_UTIL_PKG.F_OTH_UL_VAL_STR(LVALUE_FUL)||                                                                  
           EXT_UTIL_PKG.F_VAR(SIGNIFICANCE_FLAG_FUL, 1)          LINE_TEXT                                              
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             PROTOCOL                                                          
 ,S.NAME                                       INST_ID                                                                  
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.DCMDATE)     COURSE_NUM   ----                               
 ,A.DCMDATE             SMPL_DT                                                                                         
 ,A.DCMTIME             SMPL_TM                                                                                         
 ,'        '            LAB_GROUP                                                                                       
 ,'    '                LAB_CODE                                                                                        
 ,'        '            BODY_SITE                                                                                       
 ,A.LPARM_FUL           LAB_TEST                                                                                        
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_UL A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY))                                                          
                                                                                                                        
THER_STD                       THERADEX                       T310     UL                                               
C_LAB_OTH_UL_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                       PATIENT                                                                                 
 ,LAB_DT                        KEY1                                                                                    
 ,LAB_TIME                      KEY2                                                                                    
 ,LAB_TEST                      KEY3                                                                                    
 ,BD_SITE                       KEY4                                                                                    
 ,''                            KEY5                                                                                    
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT)||                                                                                
    EXT_UTIL_PKG.F_FORMAT_TIME(LAB_TIME)||                                                                              
    EXT_UTIL_PKG.F_VAR(LAB_TEST, 8)||                                                                                   
    EXT_UTIL_PKG.F_VAR(BD_SITE, 8)         LINE_TEXT                                                                    
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 LAB_DT, KEY2 LAB_TIME, KEY3 LAB_TEST, KEY4 BD_SITE                     
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 LAB_DT, KEY2 LAB_TIME, KEY3 LAB_TEST, KEY4 BD_SITE            
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     US                                               
C_LAB_OTH_US                                                                                                            
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                             KEY3                                                                                   
 ,''                             KEY4                                                                                   
 ,''                             KEY5                                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(CREAT_CLR_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(HYDROGEN_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(SP_GRAVITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(WBCS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(RBCS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(GLUCOSE_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(PROTEIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(KETONES_FUL, 9, 3)||' '||                                                              
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(BILE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(URIN_CREAT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(VOLUME_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(COLL_PER_FUL, 9, 3)||' '      LINE_TEXT                                                      
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,S.NAME                              INST_ID                                                                           
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.*                                                                                                                   
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_OTH_US A,                                                                                   
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND A.STUDY = :P_STUDY                                                                                                
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY) )                                                         
                                                                                                                        
THER_STD                       THERADEX                       T310     US                                               
C_LAB_OTH_US_DEL                                                                                                        
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,SMPL_DT                                     KEY1                                                                      
 ,SMPL_TM                                     KEY2                                                                      
 ,PANEL                                     KEY3                                                                        
 ,''                                              KEY4                                                                  
 ,''                                              KEY5                                                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    EXT_UTIL_PKG.F_VAR(PATIENT, 12)||                                                                                   
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)        LINE_TEXT                                                                
FROM (                                                                                                                  
SELECT FILE_ID, STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                                      
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND EXT_SOURCE = 'O'                                                                                                 
   AND STUDY = :P_STUDY                                                                                                 
MINUS (                                                                                                                 
SELECT FILE_ID, PROTOCOL STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM, KEY3 PANEL                             
  FROM CT_EXT_TEMP))                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     US                                               
C_US                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                     
 ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                     
 ,''                                                                              KEY3                                  
 ,''                                                                              KEY4                                  
 ,''                                                                              KEY5                                  
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    :P_VERSION||                                                                                                        
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)||                                                                               
    LAB_GROUP||                                                                                                         
    LAB_CODE||                                                                                                          
    EXT_UTIL_PKG.F_TO_CHAR(CREAT_CLR_FUL, 9, 3)||' '||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(HYDROGEN_FUL, 9, 3)||' '||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(SP_GRAVITY_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(WBCS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(RBCS_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(GLUCOSE_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR(PROTEIN_FUL, 9, 3)||' '||                                                                    
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(KETONES_FUL, 9, 3)||' '||                                                              
    EXT_UTIL_PKG.F_TO_CHAR_COUNT(BILE_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(URIN_CREAT_FUL, 9, 3)||' '||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(VOLUME_FUL, 9, 3)||' '||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(COLL_PER_FUL, 9, 3)||' '       LINE_TEXT                                                     
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.SMPL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.SMPL_DT                                                                                                             
 ,A.SMPL_TM                                                                                                             
 ,'        '                                          LAB_GROUP                                                         
 ,'    '                                              LAB_CODE                                                          
 ,A.CREAT_CLR_FUL                                                                                                       
 ,A.HYDROGEN_FUL                                                                                                        
 ,A.SP_GRAVITY_FUL                                                                                                      
 ,A.WBCS_FUL                                                                                                            
 ,A.RBCS_FUL                                                                                                            
 ,A.GLUCOSE_FUL                                                                                                         
 ,A.PROTEIN_FUL                                                                                                         
 ,A.KETONES_FUL                                                                                                         
 ,A.BILE_FUL                                                                                                            
 ,A.URIN_CREAT_FUL                                                                                                      
 ,A.VOLUME_FUL                                                                                                          
 ,A.COLL_PER_FUL                                                                                                        
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_LAB_US A,                                                                                       
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     US                                               
C_US_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                      PATIENT                                                                                  
 ,SMPL_DT         KEY1                                                                                                  
 ,SMPL_TM         KEY2                                                                                                  
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||SMPL_DT||SMPL_TM        LINE_TEXT                                                                          
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 SMPL_DT, KEY2 SMPL_TM                                                           
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)          PATIENT                                                             
      ,EXT_UTIL_PKG.F_FORMAT_DATE(SMPL_DT)          KEY1                                                                
      ,EXT_UTIL_PKG.F_FORMAT_TIME(SMPL_TM)          KEY2                                                                
  FROM PP_EXT_OWNER.CTSC_LAB_US                                                                                         
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     UX                                               
C_UX                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                 PATIENT                                                           
 ,EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)        KEY1                                                                   
 ,EXT_UTIL_PKG.F_FORMAT_TIME(FRST_TIME_FUL)      KEY2                                                                   
 ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)          KEY3                                                                   
 ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)         KEY4                                                                   
 ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL1)          KEY5                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_FORMAT_TIME(FRST_TIME_FUL)||                                                                         
    EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)||                                                                            
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL1)||                                                                             
    EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL2)||                                                                             
    EXT_UTIL_PKG.F_TO_CHAR(URINE_VOLUME_ML_FUL ,4, 0)||                                                                 
    EXT_UTIL_PKG.F_TO_CHAR(P_VOID_AMT_FUL, 8, 3)||                                                                      
    EXT_UTIL_PKG.F_VAR(P_VOID_AMT_UOM_FUL, 10)||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(P_DRUG_ASSAY_FUL1, 8, 3)||                                                                   
    EXT_UTIL_PKG.F_VAR(P_DRUG_ASSAY_UOM_FUL1, 10)||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(P_DRUG_ASSAY_FUL2, 8, 3)||                                                                   
    EXT_UTIL_PKG.F_VAR(P_DRUG_ASSAY_UOM_FUL2, 10)||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(P_VOID_AMT_FUL, 8, 3)||                                                                      
    EXT_UTIL_PKG.F_VAR(P_VOID_AMT_UOM_FUL, 10)||                                                                        
    EXT_UTIL_PKG.F_TO_CHAR(MTBLIT_ASSAY_FUL1, 8, 3)||                                                                   
    EXT_UTIL_PKG.F_VAR(MTBLIT_ASSAY_UOM_FUL1, 10)||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(MTBLIT_ASSAY_FUL2, 8, 3)||                                                                   
    EXT_UTIL_PKG.F_VAR(MTBLIT_ASSAY_UOM_FUL2, 10)||                                                                     
    EXT_UTIL_PKG.F_TO_CHAR(MTBLIT_MEAN_CONC_FUL, 8, 3)||                                                                
    EXT_UTIL_PKG.F_VAR(MTBLIT_MEAN_CONC_UOM_FUL, 10)||                                                                  
    EXT_UTIL_PKG.F_TO_CHAR(VOID_MTBLIT_AMT_FUL, 8, 3)||                                                                 
    EXT_UTIL_PKG.F_VAR(VOID_MTBLIT_AMT_UOM_FUL, 10)       LINE_TEXT                                                     
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.DOSE_DT_FUL)     COURSE_NUM   ----                           
 ,A.PATIENT_FUL                                                                                                         
 ,A.DOSE_DT_FUL                                                                                                         
 ,A.FRST_TIME_FUL                                                                                                       
 ,A.CTMS_AGENT_FUL                                                                                                      
 ,A.LAB_DT_FUL                                                                                                          
 ,A.START_TIME_FUL                                                                                                      
 ,A.END_TIME_FUL                                                                                                        
 ,A.TIME_FUL1                                                                                                           
 ,A.TIME_FUL2                                                                                                           
 ,A.URINE_VOLUME_ML_FUL                                                                                                 
 ,A.MTBLIT_ASSAY_FUL1                                                                                                   
 ,A.MTBLIT_ASSAY_UOM_FUL1                                                                                               
 ,A.MTBLIT_ASSAY_FUL2                                                                                                   
 ,A.MTBLIT_ASSAY_UOM_FUL2                                                                                               
 ,A.MTBLIT_MEAN_CONC_FUL                                                                                                
 ,A.MTBLIT_MEAN_CONC_UOM_FUL                                                                                            
 ,A.P_VOID_AMT_FUL                                                                                                      
 ,A.P_VOID_AMT_UOM_FUL                                                                                                  
 ,A.P_DRUG_ASSAY_FUL1                                                                                                   
 ,A.P_DRUG_ASSAY_UOM_FUL1                                                                                               
 ,A.P_DRUG_ASSAY_FUL2                                                                                                   
 ,A.P_DRUG_ASSAY_UOM_FUL2                                                                                               
 ,A.VOID_MTBLIT_AMT_FUL                                                                                                 
 ,A.VOID_MTBLIT_AMT_UOM_FUL                                                                                             
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_URINARY_EXCR A,                                                                                 
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
                                                                                                                        
THER_STD                       THERADEX                       T310     UX                                               
C_UX_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,DOSE_DT                                 KEY1                                                                          
 ,FRST_TIME                                         KEY2                                                                
 ,CTMS_AGENT                                          KEY3                                                              
 ,LAB_DT                                         KEY4                                                                   
 ,TIME1                                          KEY5                                                                   
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||DOSE_DT||FRST_TIME||CTMS_AGENT||LAB_DT||TIME1          LINE_TEXT                                           
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 DOSE_DT, KEY2 FRST_TIME, KEY3 CTMS_AGENT, KEY4 LAB_DT, KEY5 TIME1               
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)        PATIENT                                                               
      ,EXT_UTIL_PKG.F_FORMAT_DATE(DOSE_DT_FUL)    KEY1                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_TIME(FRST_TIME_FUL)  KEY2                                                                  
      ,EXT_UTIL_PKG.F_VAR(CTMS_AGENT_FUL, 8)      KEY3                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_DATE(LAB_DT_FUL)     KEY4                                                                  
      ,EXT_UTIL_PKG.F_FORMAT_TIME(TIME_FUL1)      KEY5                                                                  
  FROM PP_EXT_OWNER.CTSC_URINARY_EXCR                                                                                   
)  )                                                                                                                    
                                                                                                                        
THER_STD                       THERADEX                       T310     XT                                               
C_XT                                                                                                                    
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,DECODE('1', NULL, 0)                                RECEIVED_DCM_ID                                                   
 ,DECODE('1', NULL, SYSDATE)                          RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,DEL_FLAG                                            DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)                  PATIENT                                                          
 ,EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0)       KEY1                                                               
 ,EXT_UTIL_PKG.F_FORMAT_DATE(EVAL_DT_FUL)            KEY2                                                               
 ,''                                    KEY3                                                                            
 ,''                                    KEY4                                                                            
 ,''                                    KEY5                                                                            
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||                                                                                 
    TO_CHAR(:P_CURRENT_EXT_DATE, 'RRRRMMDD')||                                                                          
    EXT_UTIL_PKG.F_VAR(REPLACE(ENTERED_BY, 'OPS$', ''), 8)||                                                            
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CREATED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHANGED, 'RRRRMMDD'), 8)||                                                               
    EXT_UTIL_PKG.F_VAR(TO_CHAR(CHG_TIME, 'HH24MISS'), 6)||                                                              
    A_FILLER||                                                                                                          
    DEL_FLAG||                                                                                                          
    DEL_DATE||                                                                                                          
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    EXT_UTIL_PKG.F_VAR(INST_ID, 8)||                                                                                    
    ENTRY_PASS||                                                                                                        
    TOUCH_DATE||                                                                                                        
    TOUCH_TIMER||                                                                                                       
    COURSE_NUM||               ------------                                                                             
    EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)||                                                                               
    EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0)||                                                                      
    EXT_UTIL_PKG.F_FORMAT_DATE(EVAL_DT_FUL)||                                                                           
    EXT_UTIL_PKG.F_VAR(MEASUREMENT_MTHD_FUL, 12)||                                                                      
    EXT_UTIL_PKG.F_TO_CHAR(MEASUREMENT_X_FUL, 7, 2)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(MEASUREMENT_Y_FUL, 7, 2)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(MEASUREMENT_Z_FUL, 7, 2)||                                                                   
    EXT_UTIL_PKG.F_TO_CHAR(EVAL_NUM_FUL, 2, 0)||                                                                        
    EXT_UTIL_PKG.F_VAR(EVAL_CD_FUL, 1)         LINE_TEXT                                                                
FROM (                                                                                                                  
select                                                                                                                  
  C.ENTERED_BY                                        ENTERED_BY                                                        
 ,C.RECEIVED_DCM_ENTRY_TS                             CREATED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHANGED                                                           
 ,C.LAST_DATA_CHANGE_TS                               CHG_TIME                                                          
 ,' '                                                 A_FILLER                                                          
 ,' '                                                 DEL_FLAG                                                          
 ,'        '                                          DEL_DATE                                                          
 ,A.STUDY                                             STUDY                                                             
 ,A.INVSITE                                           INVSITE                                                           
 ,S.NAME                              INST_ID                                                                           
 ,A.REG_INST_FUL                                                                                                        
 ,DECODE(C.PASS_ONE_TS, NULL, '1',                                                                                      
    DECODE(C.PASS_TWO_TS, NULL, '1', '2'))            ENTRY_PASS                                                        
 ,'       '                                           TOUCH_TIMER                                                       
 ,'        '                                          TOUCH_DATE                                                        
 ,EXT_UTIL_PKG.F_COURSE_NUM(A.STUDY, :P_EXT_OWNER, A.PT, A.EVAL_DT)     COURSE_NUM   ----                               
 ,A.PATIENT_FUL                                                                                                         
 ,A.LESION_NUM_FUL                                                                                                      
 ,A.EVAL_DT_FUL                                                                                                         
 ,A.MEASUREMENT_MTHD_FUL                                                                                                
 ,A.MEASUREMENT_X_FUL                                                                                                   
 ,A.MEASUREMENT_Y_FUL                                                                                                   
 ,A.MEASUREMENT_Z_FUL                                                                                                   
 ,A.EVAL_NUM_FUL                                                                                                        
 ,A.EVAL_CD_FUL                                            ---------------                                              
 ,A.DOCNUM                                                                                                              
 ,A.PT                                                                                                                  
 ,C.MODIFICATION_TS                                                                                                     
 ,C.RECEIVED_DCM_ID                                                                                                     
 ,C.RECEIVED_DCM_ENTRY_TS                                                                                               
 ,C.LAST_DATA_CHANGE_TS                                                                                                 
 FROM PP_EXT_OWNER.CTSC_EXT_OF_DISEASE A,                                                                               
      PP_EXT_OWNER.CT_RECEIVED_DCMS C,                                                                                  
      PP_EXT_OWNER.CT_OCL_SITES S                                                                                       
WHERE A.DOCNUM = C.DOCUMENT_NUMBER                                                                                      
  AND A.DCMNAME = C.NAME                                                                                                
  AND A.INVSITE = S.SITE                                                                                                
  AND (C.MODIFICATION_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID) OR                                        
       C.LAST_DATA_CHANGE_TS > EXT_UTIL_PKG.F_LAST_EXT_DATE(:P_STUDY, :P_FILE_ID))                                      
  AND C.CLINICAL_STUDY_ID = EXT_UTIL_PKG.F_STUDY_ID(:P_STUDY)  )                                                        
END                                                                                                                     
                                                                                                                        
THER_STD                       THERADEX                       T310     XT                                               
C_XT_DEL                                                                                                                
select                                                                                                                  
  :P_FILE_ID                                           FILE_ID                                                          
 ,:P_VERSION                                           VERSION                                                          
 ,:P_CURRENT_EXT_DATE                                  EXTRACTED                                                        
 ,NULL                                                RECEIVED_DCM_ID                                                   
 ,NULL                                                RECEIVED_DCM_ENTRY_TS                                             
 ,DOCNUM                                              DOCNUM                                                            
 ,'D'                                                 DEL_FLAG                                                          
 ,STUDY                                               PROTOCOL                                                          
 ,PT                                                  PT                                                                
 ,PATIENT                                          PATIENT                                                              
 ,LESION_NUM                          KEY1                                                                              
 ,EVAL_DT                             KEY2                                                                              
 ,''                           KEY3                                                                                     
 ,''                           KEY4                                                                                     
 ,''                           KEY5                                                                                     
 ,RPAD(:P_FILE_ID, 3, ' ')||                                                                                            
    EXT_UTIL_PKG.F_VAR(:P_VERSION, 4)||RPAD(' ', 39, ' ')||'D'||RPAD(' ', 8, ' ')||                                     
    EXT_UTIL_PKG.F_VAR(STUDY, 12)||                                                                                     
    RPAD(' ', 27, ' ')||     ----------                                                                                 
    PATIENT||LESION_NUM||EVAL_DT       LINE_TEXT                                                                        
FROM (                                                                                                                  
SELECT STUDY, DOCNUM, PT, PATIENT, KEY1 LESION_NUM, KEY2 EVAL_DT                                                        
  FROM CTSP_ALL_FILE                                                                                                    
 WHERE FILE_ID = :P_FILE_ID                                                                                             
   AND STUDY = :P_STUDY                                                                                                 
   AND EXT_SOURCE = 'N'                                                                                                 
MINUS (                                                                                                                 
SELECT STUDY, DOCNUM, PT                                                                                                
      ,EXT_UTIL_PKG.F_VAR(PATIENT_FUL, 12)           PATIENT                                                            
      ,EXT_UTIL_PKG.F_TO_CHAR(LESION_NUM_FUL, 2, 0)  KEY1                                                               
      ,EXT_UTIL_PKG.F_FORMAT_DATE(EVAL_DT_FUL)       KEY2                                                               
  FROM PP_EXT_OWNER.CTSC_EXT_OF_DISEASE                                                                                 
)  )                                                                                                                    
END                                                                                                                     
                                                                                                                        

422 rows selected.

SQL> spool off
